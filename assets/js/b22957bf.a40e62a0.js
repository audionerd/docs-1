"use strict";(self.webpackChunkstately_docs=self.webpackChunkstately_docs||[]).push([[55068],{3905:(e,t,n)=>{n.r(t),n.d(t,{MDXContext:()=>d,MDXProvider:()=>c,mdx:()=>h,useMDXComponents:()=>p,withMDXComponents:()=>m});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r.apply(this,arguments)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var d=a.createContext({}),m=function(e){return function(t){var n=p(t.components);return a.createElement(e,r({},t,{components:n}))}},p=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(d.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},y=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),m=p(n),c=i,y=m["".concat(l,".").concat(c)]||m[c]||u[c]||r;return n?a.createElement(y,o(o({ref:t},d),{},{components:n})):a.createElement(y,o({ref:t},d))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=y;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var d=2;d<r;d++)l[d]=n[d];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}y.displayName="MDXCreateElement"},20258:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var a=n(87462),i=(n(67294),n(3905));const r={title:"Delayed (after) transitions"},l=void 0,o={unversionedId:"delayed-transitions",id:"delayed-transitions",title:"Delayed (after) transitions",description:"Delayed transitions\xa0are transitions that only happen after a set amount of time. Delayed transitions are handy for building timeouts and intervals into your application logic. If another event occurs before the end of the timer, the transition doesn\u2019t complete.",source:"@site/docs/delayed-transitions.mdx",sourceDirName:".",slug:"/delayed-transitions",permalink:"/statelyai-docs/docs/delayed-transitions",draft:!1,editUrl:"https://github.com/statelyai/docs/tree/main/docs/delayed-transitions.mdx",tags:[],version:"current",frontMatter:{title:"Delayed (after) transitions"},sidebar:"docs",previous:{title:"Eventless (always) transitions",permalink:"/statelyai-docs/docs/eventless-transitions"},next:{title:"Actions",permalink:"/statelyai-docs/docs/actions"}},s={},d=[{value:"Using delayed transitions in Stately Studio",id:"using-delayed-transitions-in-stately-studio",level:2},{value:"Make an event into a delayed transition",id:"make-an-event-into-a-delayed-transition",level:3},{value:"On the canvas",id:"on-the-canvas",level:4},{value:"Using the transition Details panel",id:"using-the-transition-details-panel",level:4},{value:"Specify delay time",id:"specify-delay-time",level:4},{value:"Delays",id:"delays",level:2},{value:"Inlined delays",id:"inlined-delays",level:3},{value:"Referenced delays",id:"referenced-delays",level:3},{value:"Delay expressions",id:"delay-expressions",level:3},{value:"Lifecycle",id:"lifecycle",level:2},{value:"Testing",id:"testing",level:2},{value:"TypeScript",id:"typescript",level:2},{value:"Cheatsheet",id:"cheatsheet",level:2}],m=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.mdx)("div",t)},p=m("SkipDownLink"),c=m("EmbedMachine"),u=m("Info"),y={toc:d};function h(e){let{components:t,...n}=e;return(0,i.mdx)("wrapper",(0,a.Z)({},y,n,{components:t,mdxType:"MDXLayout"}),(0,i.mdx)("p",null,(0,i.mdx)("strong",{parentName:"p"},"Delayed transitions"),"\xa0are transitions that only happen after a set amount of time. Delayed transitions are handy for building timeouts and intervals into your application logic. If another event occurs before the end of the timer, the transition doesn\u2019t complete."),(0,i.mdx)("p",null,"Delayed transitions are defined on the ",(0,i.mdx)("inlineCode",{parentName:"p"},"after")," property in milliseconds. They are often referred to as \u201cafter\u201d transitions."),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-ts"},"import { createMachine } from 'xstate';\n\nconst pushTheButtonGame = createMachine({\n  initial: 'waitingForButtonPush',\n  states: {\n    waitingForButtonPush: {\n      // highlight-start\n      after: {\n        5000: {\n          target: 'timedOut',\n          actions: 'logThatYouGotTimedOut',\n        },\n      },\n      // highlight-end\n      on: {\n        PUSH_BUTTON: {\n          actions: 'logSuccess',\n          target: 'success',\n        },\n      },\n    },\n    success: {},\n    timedOut: {},\n  },\n});\n")),(0,i.mdx)("admonition",{type:"tip"},(0,i.mdx)("p",{parentName:"admonition"},"Watch our ",(0,i.mdx)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=5RE_eazRhrw&list=PLvWgkXBB3dd4I_l-djWVU2UGPyBgKfnTQ&index=12"},"\u201cDelayed (after) transitions\u201d video on YouTube")," (1m17s).")),(0,i.mdx)(p,{text:"Jump to learning more about delays in XState",link:"#delays",mdxType:"SkipDownLink"}),(0,i.mdx)(c,{name:"Delayed (after) transitions",embedURL:"https://stately.ai/registry/editor/embed/1c962847-2829-45e2-b6fc-5f42fa3f8b6b?machineId=5671366b-05cf-43f5-a09a-b88373ea27c1",mdxType:"EmbedMachine"}),(0,i.mdx)("p",null,(0,i.mdx)("a",{parentName:"p",href:"https://stately.ai/registry/editor/e13bef2b-bb13-4465-96ac-0bc25340688e?machineId=5671366b-05cf-43f5-a09a-b88373ea27c1"},"View this machine in Stately Studio"),"."),(0,i.mdx)("p",null,"In a video player, want the video to be\xa0",(0,i.mdx)("em",{parentName:"p"},"Closed"),"\xa0out of fullscreen mode a few seconds after the video has\xa0",(0,i.mdx)("em",{parentName:"p"},"Stopped"),", instead of closing the fullscreen mode suddenly as soon as the video is stopped. The eventless transition above transitions from the\xa0",(0,i.mdx)("em",{parentName:"p"},"Stopped"),"\xa0state to the\xa0",(0,i.mdx)("em",{parentName:"p"},"Closed"),"\xa0state after 5 seconds."),(0,i.mdx)("h2",{id:"using-delayed-transitions-in-stately-studio"},"Using delayed transitions in Stately Studio"),(0,i.mdx)("p",null,"In Stately Studio, delayed transitions are labeled \u201cafter.\u201d"),(0,i.mdx)("h3",{id:"make-an-event-into-a-delayed-transition"},"Make an event into a delayed transition"),(0,i.mdx)("p",null,"Delayed transitions have a default time interval of 500ms (0.5 seconds)."),(0,i.mdx)("h4",{id:"on-the-canvas"},"On the canvas"),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},"Select the event you want to replace with a delayed transition."),(0,i.mdx)("li",{parentName:"ol"},"Right-click the event to open the edit menu."),(0,i.mdx)("li",{parentName:"ol"},"From the ",(0,i.mdx)("strong",{parentName:"li"},"Event type")," options, choose ",(0,i.mdx)("strong",{parentName:"li"},"After")," to turn the event into a delayed transition.")),(0,i.mdx)("h4",{id:"using-the-transition-details-panel"},"Using the transition Details panel"),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},"Open the transition ",(0,i.mdx)(u,{size:18,mdxType:"Info"})," ",(0,i.mdx)("strong",{parentName:"li"},"Details")," panel from the right tool menu."),(0,i.mdx)("li",{parentName:"ol"},"From the ",(0,i.mdx)("strong",{parentName:"li"},"Event type")," dropdown menu, choose ",(0,i.mdx)("strong",{parentName:"li"},"After")," to turn the event into a delayed transition.")),(0,i.mdx)("h4",{id:"specify-delay-time"},"Specify delay time"),(0,i.mdx)("p",null,"Your delay time interval will be displayed in a human-readable format on hover. For example, 15000ms will be displayed as 15 seconds."),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},"Select the delayed transition."),(0,i.mdx)("li",{parentName:"ol"},"Open the transition ",(0,i.mdx)(u,{size:18,mdxType:"Info"})," ",(0,i.mdx)("strong",{parentName:"li"},"Details")," panel from the right tool menu."),(0,i.mdx)("li",{parentName:"ol"},"Use the ",(0,i.mdx)("strong",{parentName:"li"},"Delay")," text input to specify the interval in milliseconds.")),(0,i.mdx)("hr",null),(0,i.mdx)("h2",{id:"delays"},"Delays"),(0,i.mdx)("p",null,"You can define delays in a few ways: ",(0,i.mdx)("a",{parentName:"p",href:"#inlined-delays"},"inlined"),", ",(0,i.mdx)("a",{parentName:"p",href:"#referenced-delays"},"referenced"),", and ",(0,i.mdx)("a",{parentName:"p",href:"#delay-expressions"},"as an expression"),"."),(0,i.mdx)("h3",{id:"inlined-delays"},"Inlined delays"),(0,i.mdx)("p",null,"You can define an inlined delay by specifying the delay time (in milliseconds) directly:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-ts"},"const machine = createMachine({\n  initial: 'idle',\n  states: {\n    idle: {\n      after: {\n        1000: { target: 'nextState' },\n      },\n    },\n    nextState: {},\n  },\n});\n")),(0,i.mdx)("p",null,"This will transition to the ",(0,i.mdx)("inlineCode",{parentName:"p"},"nextState")," state after 1000ms."),(0,i.mdx)("h3",{id:"referenced-delays"},"Referenced delays"),(0,i.mdx)("p",null,"You can also define referenced delays by specifying a string delay key, and providing the actual delay time separately."),(0,i.mdx)("p",null,"For example:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-ts"},"const machine = createMachine(\n  {\n    initial: 'idle',\n    states: {\n      idle: {\n        after: {\n          timeout: { target: 'nextState' },\n        },\n      },\n      nextState: {},\n    },\n  },\n  {\n    // highlight-start\n    delays: {\n      timeout: 1000,\n    },\n    // highlight-end\n  },\n);\n")),(0,i.mdx)("h3",{id:"delay-expressions"},"Delay expressions"),(0,i.mdx)("p",null,"The delay option can be evaluated as a delay expression. The delay expression function takes in an object that contains ",(0,i.mdx)("inlineCode",{parentName:"p"},"context")," and ",(0,i.mdx)("inlineCode",{parentName:"p"},"event")," properties and returns the resolved ",(0,i.mdx)("inlineCode",{parentName:"p"},"delay")," (in milliseconds)."),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-ts"},"`after: [{ delay: () => 1000, target: ... }]`;\n")),(0,i.mdx)("h2",{id:"lifecycle"},"Lifecycle"),(0,i.mdx)("p",null,"Delayed transition timers are canceled when the state is exited."),(0,i.mdx)("h2",{id:"testing"},"Testing"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Simulated clock")),(0,i.mdx)("h2",{id:"typescript"},"TypeScript"),(0,i.mdx)("p",null,"You can strongly type the ",(0,i.mdx)("inlineCode",{parentName:"p"},"delays")," of your machine in the ",(0,i.mdx)("inlineCode",{parentName:"p"},"types.delays")," property of the machine config."),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-ts"},"const machine = createMachine({\n  types: {} as {\n    // highlight-start\n    delays: 'shortTimeout' | 'longTimeout' | 'eventually';\n    // highlight-end\n    // ...\n  },\n  // ...\n  after: {\n    // Autocompleted\n    shortTimeout: {\n      /* ... */\n    },\n  },\n  on: {\n    someEvent: {\n      actions: raise(\n        { type: 'anotherEvent' },\n        {\n          // Autocompleted\n          delay: 'eventually',\n        },\n      ),\n    },\n  },\n});\n")),(0,i.mdx)("h2",{id:"cheatsheet"},"Cheatsheet"),(0,i.mdx)("p",null,"Use our XState delayed transitions cheatsheet below to get started quickly."),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-ts"},"createMachine({\n  after: {\n    DELAY: {\n      /* ... */\n    },\n  },\n}).provide({\n  delays: {\n    DELAY: 1000, // or expression\n  },\n});\n")))}h.isMDXComponent=!0}}]);