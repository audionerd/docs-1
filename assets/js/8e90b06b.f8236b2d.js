"use strict";(self.webpackChunkstately_docs=self.webpackChunkstately_docs||[]).push([[48175],{3905:(e,n,t)=>{t.r(n),t.d(n,{MDXContext:()=>l,MDXProvider:()=>d,mdx:()=>b,useMDXComponents:()=>m,withMDXComponents:()=>p});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(){return o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},o.apply(this,arguments)}function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=a.createContext({}),p=function(e){return function(n){var t=m(n.components);return a.createElement(e,o({},n,{components:t}))}},m=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},d=function(e){var n=m(e.components);return a.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},v=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),p=m(t),d=r,v=p["".concat(c,".").concat(d)]||p[d]||u[d]||o;return t?a.createElement(v,i(i({ref:n},l),{},{components:t})):a.createElement(v,i({ref:n},l))}));function b(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,c=new Array(o);c[0]=v;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,c[1]=i;for(var l=2;l<o;l++)c[l]=t[l];return a.createElement.apply(null,c)}return a.createElement.apply(null,t)}v.displayName="MDXCreateElement"},63621:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var a=t(87462),r=(t(67294),t(3905));const o={title:"Callbacks",description:"Promise actors let you model promises, but not every actor will be a promise. Callback actors give you a flexible API for managing a long-running actor."},c=void 0,i={unversionedId:"xstate/actors/callbacks",id:"version-4/xstate/actors/callbacks",title:"Callbacks",description:"Promise actors let you model promises, but not every actor will be a promise. Callback actors give you a flexible API for managing a long-running actor.",source:"@site/versioned_docs/version-4/xstate/actors/callbacks.mdx",sourceDirName:"xstate/actors",slug:"/xstate/actors/callbacks",permalink:"/docs/xstate-v4/xstate/actors/callbacks",draft:!1,editUrl:"https://github.com/statelyai/docs/tree/main/versioned_docs/version-4/xstate/actors/callbacks.mdx",tags:[],version:"4",frontMatter:{title:"Callbacks",description:"Promise actors let you model promises, but not every actor will be a promise. Callback actors give you a flexible API for managing a long-running actor."},sidebar:"tutorialSidebar",previous:{title:"Actions vs. actors",permalink:"/docs/xstate-v4/xstate/actors/actions-vs-actors"},next:{title:"Machines",permalink:"/docs/xstate-v4/xstate/actors/machines"}},s={},l=[],p={toc:l};function m(e){let{components:n,...t}=e;return(0,r.mdx)("wrapper",(0,a.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,r.mdx)("p",null,"Promise actors let you model promises declaratively but not every actor will be a promise. ",(0,r.mdx)("strong",{parentName:"p"},"Callback actors")," give you a flexible API for managing a long-running actor that can do several things a promise can\u2019t, like:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"Send events back to its parent"),(0,r.mdx)("li",{parentName:"ul"},"Receive events from its parent and react to them"),(0,r.mdx)("li",{parentName:"ul"},"Start listeners/processes and clean them up when needed")),(0,r.mdx)("p",null,"Callback actors are declared using the ",(0,r.mdx)("inlineCode",{parentName:"p"},"() => () => {}")," syntax, which is how XState distinguishes them from promise actors, which are declared as: ",(0,r.mdx)("inlineCode",{parentName:"p"},"() => {}"),"."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-ts"},"import { createMachine } from 'xstate';\n\ncreateMachine(\n  {\n    invoke: {\n      src: 'callbackActor',\n    },\n  },\n  {\n    // `actors` in v5\n    services: {\n      callbackActor: (context, event) => (sendBack, onReceive) => {\n        // Run any code you want inside here\n\n        return () => {\n          // Any code inside here will be called when\n          // you leave this state, or the machine is stopped\n        };\n      },\n    },\n  }\n);\n")),(0,r.mdx)("admonition",{type:"warningxstate"},(0,r.mdx)("p",{parentName:"admonition"},"XState v5 is in beta. ",(0,r.mdx)("a",{parentName:"p",href:"https://www.npmjs.com/package/xstate/v/5.0.0-beta.13"},"Check out XState v5 Beta on NPM"),".")),(0,r.mdx)("p",null,"Callbacks are called with:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"context"),", the state of the context at the moment the actor started."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"event"),", the last event sent to the machine.")),(0,r.mdx)("p",null,"Callbacks also receive a ",(0,r.mdx)("inlineCode",{parentName:"p"},"sendBack")," function, which you can use to send events back to its parent machine."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-ts"},"import { createMachine } from 'xstate';\n\ncreateMachine(\n  {\n    initial: 'counting',\n    states: {\n      counting: {\n        invoke: {\n          src: 'callbackActor',\n        },\n        on: {\n          ONE_SECOND_PASSED: {\n            actions: 'logToConsole',\n          },\n          STOP_COUNTING: {\n            target: 'stopped',\n          },\n        },\n      },\n      stopped: {\n        type: 'final',\n      },\n    },\n  },\n  {\n    actions: {\n      logToConsole: () => {\n        console.log('One second passed!');\n      },\n    },\n    // `actors` in v5\n    services: {\n      callbackActor: (context, event) => (sendBack, onReceive) => {\n        const interval = setInterval(() => {\n          sendBack({\n            type: 'ONE_SECOND_PASSED',\n          });\n        }, 1000);\n\n        return () => {\n          clearInterval(interval);\n        };\n      },\n    },\n  }\n);\n")),(0,r.mdx)("p",null,"In the example above, we use ",(0,r.mdx)("inlineCode",{parentName:"p"},"sendBack")," to send an event back to the parent machine every second."),(0,r.mdx)("p",null,"We can return a function from the callback actor to run any necessary \u201ccleanup.\u201d This cleanup function is run when the state containing the invoke is exited. In the example above, the interval is cleared when the ",(0,r.mdx)("inlineCode",{parentName:"p"},"counting")," state is exited."))}m.isMDXComponent=!0}}]);