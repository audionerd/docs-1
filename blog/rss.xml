<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Stately Blog</title>
        <link>https://audionerd.github.io/statelyai-docs/blog</link>
        <description>Stately Blog</description>
        <lastBuildDate>Thu, 05 Oct 2023 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[What is a state machine?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-10-05-what-is-a-state-machine</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-10-05-what-is-a-state-machine</guid>
            <pubDate>Thu, 05 Oct 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Learn what a state machine is, and how it can help you model and understand complex systems visually.]]></description>
            <content:encoded><![CDATA[<p>You might have heard of “state machine” or “finite-state machine” before. <a href="https://en.wikipedia.org/wiki/Finite-state_machine" target="_blank" rel="noopener noreferrer">If you look up <em>state machine</em> on Wikipedia</a>, you’ll read that a state machine is described as a “mathematical model of computation,” followed by a bunch of symbols and computer science jargon that doesn’t immediately seem to apply to your team’s work.</p><p>However, state machines are <em>really useful</em> for describing almost any kind of logic, feature, user story, sequence, process, workflow, specification, and more. <!-- -->They can greatly improve how your team collaborates on processes, flows, features, and any other kinds of application logic, and they’re much simpler to understand than you may think.</p><p>If you’ve worked with flowcharts or diagrammed a process on a whiteboard with boxes and arrows, you may already know how state machines work!</p><h1>What is a state machine?</h1><p>A state machine is a way of modeling how something works, using states and transitions to show how something changes over time in response to events.</p><img src="/blog/2023-10-02-what-is-a-state-machine/music-player-state-machine-light.png" alt="A state machine for a music player. The state machine starts in the Paused state, and on play, goes to the Playing state. On pause, it goes back to the Paused state. In any state, you can skip to the next track." class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/2023-10-02-what-is-a-state-machine/music-player-state-machine-dark.png" alt="A state machine for a music player. The state machine starts in the Paused state, and on play, goes to the Playing state. On pause, it goes back to the Paused state. In any state, you can skip to the next track." class="themedImage_ToTc themedImage--dark_i4oU"><p>Specifically, it formally models how a system transitions from one state to another based on specific events (e.g., triggers, signals, changes, etc.). Think of it as a useful tool for visualizing and designing the flow of user experiences, product features, or any process you’re working on.</p><p>Visually, state machine diagrams are similar to flowcharts. Both use shapes to represent states (e.g., steps in a flow) and arrows to indicate transitions between those states. The main difference is that state machines are more precise, formal, and powerful than flowcharts. They’re also more flexible since you can use them to model any kind of logic, not just processes.</p><img src="/blog/2023-10-02-what-is-a-state-machine/flight-booking-state-machine.png" alt="A booking state machine with an initial idle state. From idle you can transition to car booking, flight booking, and hotel booking states." class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/2023-10-02-what-is-a-state-machine/flight-booking-state-machine.png" alt="A booking state machine with an initial idle state. From idle you can transition to car booking, flight booking, and hotel booking states." class="themedImage_ToTc themedImage--dark_i4oU"><p>State machines are a concept deeply rooted in computer science; however, they have broad applications that extend to various business domains and design disciplines. From developing intuitive software interfaces to designing effective business processes, state machines provide a structured way to model and understand complex systems. Whether you’re a product owner, project manager, designer, developer, QA tester, business analyst, or any other role, understanding state machines can significantly improve your ability to design, manage, and refine features, processes, and products.</p><p>In short, a state machine lets us clearly understand how something reacts when an event occurs.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-parts-of-a-state-machine">The parts of a state machine<a href="#the-parts-of-a-state-machine" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Visually, state machines are just boxes and arrows. The building blocks of a state machine –&nbsp;<strong>states, events,</strong> and <strong>transitions,</strong> are quite straightforward (no pun intended), but together, they form a powerful tool for modeling and understanding systems.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="states">States<a href="#states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>A <a href="/statelyai-docs/docs/state-machines-and-statecharts#states">state</a> represents a particular situation, mode, or status that something can be in. For instance, an e-commerce site’s order can be in the <em>Pending</em>, <em>Shipped</em>, <em>Delivered</em>, or <em>Returned</em> states. Each of these is a finite state, contributing to the entire lifecycle of an order.</p><p><img src="/blog/2023-10-02-what-is-a-state-machine/order-states-light.png" alt="Pending and shipped states." class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/2023-10-02-what-is-a-state-machine/order-states-dark.png" alt="Pending and shipped states." class="themedImage_ToTc themedImage--dark_i4oU"></p><p>Finite states are <strong>deterministic</strong>, meaning that something can only be in exactly one finite state at a time. An order cannot be in both the <em>Pending</em> and <em>Delivered</em> states at the same time, just like you can’t be in both the <em>Asleep</em> and <em>Awake</em> states simultaneously.</p><p>State machines always start at an <strong><a href="/statelyai-docs/docs/state-machines-and-statecharts#initial-state">initial state</a></strong> and may end up in a <strong><a href="/statelyai-docs/docs/state-machines-and-statecharts#final-state">final state</a></strong>, indicating that the state machine is “done” and can no longer transition to any other state.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="events">Events<a href="#events" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Events are occurrences; they’re a record that something happened. Using the previous example, an event like <em>item shipped</em> might transition an order’s state from <em>Pending</em> to <em>Shipped</em>.</p><p><img src="/blog/2023-10-02-what-is-a-state-machine/order-event-light.png" alt="There is an initial Pending state. The machine transitions from Pending to the Shipped state with the item shipped event." class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/2023-10-02-what-is-a-state-machine/order-event-dark.png" alt="There is an initial Pending state. The machine transitions from Pending to the Shipped state with the item shipped event." class="themedImage_ToTc themedImage--dark_i4oU"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="transitions">Transitions<a href="#transitions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>A state <a href="/statelyai-docs/docs/transitions">transition</a> describes how a system “moves” from one state to another. These are the arrows between the states, labeled by the event that causes the transition to occur.</p><p>In state machines, transitions always happen immediately. For example, an order can be <em>Pending</em> for some time (almost frustratingly so), but when the <em>item shipped</em> event occurs, it immediately transitions to the <em>Shipped</em> state.</p><p><img src="/blog/2023-10-02-what-is-a-state-machine/order-transitions-light.png" alt="State machine for an order: the states are pending, shipped, delivered, and returned." class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/2023-10-02-what-is-a-state-machine/order-transitions-dark.png" alt="State machine for an order: the states are pending, shipped, delivered, and returned." class="themedImage_ToTc themedImage--dark_i4oU"></p><p><a href="https://stately.ai/registry/editor/092bf401-2d65-48ae-969c-99b4a7eeb87f?machineId=942c00ac-7922-4a5a-bf92-d2438847c62f&amp;mode=design" target="_blank" rel="noopener noreferrer">View this state machine in Stately</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-state-machine-example">A state machine example<a href="#a-state-machine-example" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Let’s say you wanted to create a flow for a travel booking app. This flow represents the logic of a user booking a flight, hotel, and rental car, and you can apply this logic to the frontend code (as a multi-step flow) and backend code (as a workflow that communicates with APIs to book everything). Let’s model this travel booking flow as a state machine.</p><p>First, think of all of the <strong>states</strong> of this flow. Each state represents something that is happening, such as the flight or hotel being booked:</p><ul><li>Booking flight</li><li>Booking hotel</li><li>Booking car</li><li>Confirmation</li><li>Error</li></ul><p>Tip: make sure to handle errors! In the real world, things don’t always go according to plan.</p><p>Then, think of all the <strong>events</strong> that can happen in the flow. There are the “happy-path” events:</p><ul><li>Flight booked</li><li>Hotel booked</li><li>Car booked</li></ul><p>But other events can happen:</p><ul><li>Flight booking failed</li><li>Hotel booking failed</li><li>Car booking failed</li><li>Timeout</li></ul><p>You can then combine these states and events to create a complete <strong>state machine diagram</strong> that represents all the possible user flows through the app:</p><iframe loading="lazy" src="https://stately.ai/registry/editor/embed/9fa24cc0-3026-41be-bb22-9afc3980fefc?machineId=5e614700-7fc3-4d22-adce-4dd6cf4f6de0&amp;mode=Design&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/9fa24cc0-3026-41be-bb22-9afc3980fefc?machineId=5e614700-7fc3-4d22-adce-4dd6cf4f6de0&amp;mode=Design">View the <em>booking machine</em> machine in Stately Studio</a>.</iframe><p>The state machine above uses parent and child states, a feature of <a href="/statelyai-docs/docs/state-machines-and-statecharts#what-is-a-statechart">statecharts</a>, to reduce complexity.</p><p>These state machines serve as a <strong>source of truth</strong> for your app logic since you can use them for:</p><ul><li><strong>Documentation</strong> that outlines the features and use cases represented in the flow</li><li><strong>Code</strong> you can generate from the state machine</li><li><strong>Diagrams</strong> as visual documentation</li><li><strong>Tests</strong> you can also generate for various flows</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="benefits-of-using-state-machines">Benefits of using state machines<a href="#benefits-of-using-state-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Understanding and managing anything that can happen in your applications is crucial for <a href="/statelyai-docs/blog/using-teams-in-stately-studio">efficient collaboration and innovation</a> –&nbsp;you want to ensure that your team can understand and iterate on app logic and features quickly, no matter how complex they get. State machines are a powerful visual approach for accomplishing that, and they’re much more than just a diagramming tool.</p><p>There are many key advantages of using state machines:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="visualized-documentation">Visualized documentation<a href="#visualized-documentation" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>With state machine diagrams, you can visually represent the states of a process, making it easier to grasp and communicate complex logic. These diagrams bridge the communication gap between technical and non-technical team members. They also provide a clear way to document and share app logic, which you could use for onboarding new team members. After all, following boxes and arrows (just like a flowchart) is much easier than parsing code, especially for someone unfamiliar with the codebase.</p><img src="/blog/2023-10-02-what-is-a-state-machine/mermaid-order-machine-light.png" alt="A mermaid diagram of our order state machine." class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/2023-10-02-what-is-a-state-machine/mermaid-order-machine-dark.png" alt="A mermaid diagram of our order state machine." class="themedImage_ToTc themedImage--dark_i4oU"><p><em>Our <a href="/statelyai-docs/docs/export-as-code#export-formats">export to Mermaid feature</a> enables you to embed your state machines in GitHub and GitLab pull requests and comments.</em></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="consistent-robust-application-logic">Consistent, robust application logic<a href="#consistent-robust-application-logic" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>By mapping out all states and transitions, state machines ensure you account for every possible scenario. This minimizes unexpected behaviors (such as undesired states/transitions) and system inconsistencies because it is <strong>mathematically impossible</strong> for a state machine to take a transition that does not exist. You can quickly identify a transition to a state that should not go to that state. This is especially useful for complex apps, where it’s easy to miss edge cases or unexpected scenarios.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modularity-and-scalability">Modularity and scalability<a href="#modularity-and-scalability" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>State machines allow for isolating logic, meaning you can make changes or additions to a specific segment without overhauling the entire system. Regardless of framework, programming language, or implementation, the core abstractions remain the same: states, events, and transitions. If you need to add, change, or remove a feature, the process is to add, change, or remove states and transitions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-path-generation">Test path generation<a href="#test-path-generation" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>State machines clearly define all possible states, events, and transitions, allowing testers to simulate specific events and verify if transitions to specific states occur as expected. Since state machines are directed graphs, they act like a “map” for your app logic. This map enables the automatic generation of many different “paths” through the state machine. Each path represents a potential use case, even those that may initially go unnoticed, such as edge cases. Exhaustive test path generation is also possible so that you can test every possible path through the state machine.</p><aside class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p><em>Our <a href="/statelyai-docs/docs/export-as-code#export-formats">export to Stories feature</a> enables you to generate the happy paths (stories) for your app:</em></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stories-for-ordermachine">Stories for <code>orderMachine</code><a href="#stories-for-ordermachine" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ordermachinepending">orderMachine.Pending<a href="#ordermachinepending" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><ol><li><p><em>Start</em></p><p>→ <strong>State</strong> <code>orderMachine.Pending</code></p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ordermachineshipped">orderMachine.Shipped<a href="#ordermachineshipped" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><ol><li><p><em>Start</em></p><p>→ <strong>State</strong> <code>orderMachine.Pending</code></p></li><li><p><strong>Event</strong> <code>item shipped</code></p><p>→ <strong>State</strong> <code>orderMachine.Shipped</code></p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ordermachinedelivered">orderMachine.Delivered<a href="#ordermachinedelivered" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><ol><li><p><em>Start</em></p><p>→ <strong>State</strong> <code>orderMachine.Pending</code></p></li><li><p><strong>Event</strong> <code>item shipped</code></p><p>→ <strong>State</strong> <code>orderMachine.Shipped</code></p></li><li><p><strong>Event</strong> <code>item delivered</code></p><p>→ <strong>State</strong> <code>orderMachine.Delivered</code></p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ordermachinereturned">orderMachine.Returned<a href="#ordermachinereturned" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><ol><li><p><em>Start</em></p><p>→ <strong>State</strong> <code>orderMachine.Pending</code></p></li><li><p><strong>Event</strong> <code>item shipped</code></p><p>→ <strong>State</strong> <code>orderMachine.Shipped</code></p></li><li><p><strong>Event</strong> <code>item delivered</code></p><p>→ <strong>State</strong> <code>orderMachine.Delivered</code></p></li><li><p><strong>Event</strong> <code>item returned</code></p><p>→ <strong>State</strong> <code>orderMachine.Returned</code></p></li></ol></div></aside><h2 class="anchor anchorWithStickyNavbar_LWe7" id="transition-to-state-machines">Transition to state machines<a href="#transition-to-state-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We love state machines at <a href="/statelyai-docs/">Stately</a> because we know how valuable they can be to development teams. State machines provide a visually clear way to understand, design, and manage flows and logic at any level of complexity. Integrating the principles of state machines can lead to more predictable outcomes, clearer communication, and enhanced efficiency for the entire team, from project managers to designers and developers. You can use them as a precise way of diagramming and documenting app logic and even use them in your codebase to power that same logic.</p><p>There are many ways to get started with state machines:</p><ul><li><a href="https://www.youtube.com/watch?v=EzYIerEutgk" target="_blank" rel="noopener noreferrer">Watch our video intro to Stately</a>.</li><li><a href="https://www.youtube.com/watch?v=wjZE39wCZXo" target="_blank" rel="noopener noreferrer">Learn about generating state machines from text descriptions</a> with our AI feature.</li><li><a href="/statelyai-docs/docs/xstate">Read more about using XState</a>, our open-source library for state machines anywhere JavaScript is supported.</li><li>Jump into creating your own machine in <a href="https://state.new" target="_blank" rel="noopener noreferrer">our drag-and-drop editor at state.new</a>.</li></ul>]]></content:encoded>
            <category>state machine</category>
            <category>statechart</category>
        </item>
        <item>
            <title><![CDATA[Persisting and restoring state in XState]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-10-02-persisting-state</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-10-02-persisting-state</guid>
            <pubDate>Mon, 02 Oct 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Learn how to persist and restore your state machine state in XState]]></description>
            <content:encoded><![CDATA[<p>State machines are great for modeling state in applications. However, we often need to persist and restore state across sessions - for example, when a user closes and reopens their browser. In this article, we’ll explore how to persist and restore state in XState so your frontend applications or backend workflows can pick up where it left off.</p><aside class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>The code in this article applies to <a href="/statelyai-docs/docs/migration">XState v5 beta</a>.</p></div></aside><h2 class="anchor anchorWithStickyNavbar_LWe7" id="quick-reference">Quick reference<a href="#quick-reference" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you’re already familiar with XState, here’s a quick reference for persisting and restoring state:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createActor </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'xstate'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> someMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'./someMachine'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Get the state from localStorage (if it exists)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> stateString </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> localStorage</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">getItem</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'some-state'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Create the state from the string (if it exists)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> restoredState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> stateString </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">JSON</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">parse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">stateString</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">undefined</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> actor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">someMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Restore the state (if it exists)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  state</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> restoredState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">actor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">subscribe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Persist the state to localStorage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> persistedState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> actor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">getPersistedState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  localStorage</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">setItem</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'some-state'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">JSON</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">stringify</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">persistedState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">actor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="persisting-and-restoring-state">Persisting and restoring state<a href="#persisting-and-restoring-state" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Let’s say we have a state machine that represents a user’s shopping cart:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> createActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> assign </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'xstate'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> checkoutMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'checkout'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'shopping'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    items</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    shopping</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token string-property property">'item.add'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">items</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">items</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">item</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        checkout</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'checkingOut'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    checkingOut</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> checkoutActor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><iframe loading="lazy" src="https://stately.ai/registry/editor/embed/092bf401-2d65-48ae-969c-99b4a7eeb87f?machineId=6777d80d-82d8-41dc-9cd3-c6951495ff0f&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/092bf401-2d65-48ae-969c-99b4a7eeb87f?machineId=6777d80d-82d8-41dc-9cd3-c6951495ff0f">View the <em>checkout</em> machine in Stately Studio</a>.</iframe><p>You may want to persist the state of this machine so that when the user comes back to the site, the items in their cart are still there, and the step in the checkout process is still the same. To do this, we need to remember to do two things:</p><ul><li><strong>Persist the state</strong> to some storage (e.g., localStorage, a database, etc.)</li><li><strong>Restore the state</strong> from the storage when creating the actor</li></ul><p>First, you should determine your <a href="#persistence-strategies">persistence strategy</a>. For this example, we’ll use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" target="_blank" rel="noopener noreferrer">the <code>localStorage</code> API</a>.</p><p>Actors created with <code>createActor</code> have a <code>.getPersistedState()</code> method that returns the state that can be persisted. This state is a plain object that can be serialized to JSON using <code>JSON.stringify(persistedState)</code>. Since the persisted state is a plain object, you can persist it to any storage that you want, as long as it can be restored as an object.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// Read the state to persist from the actor (sync)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> persistedState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> actor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">getPersistedState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Persist the state to localStorage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">localStorage</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">setItem</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'some-state-key'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">JSON</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">stringify</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">persistedState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Retrieve the persisted state from storage and restore it as an object when creating the actor:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// Read the persisted state from localStorage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> restoredState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> localStorage</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">getItem</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'some-state-key'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> actor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Restore the state (if it exists)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  state</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> restoredState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">actor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The actor will start at the <code>restoredState</code>, if it exists. If <code>restoredState</code> is <code>undefined</code>, the actor will start at the initial state of the actor logic provided to <code>createActor(logic)</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="persistence-strategies">Persistence strategies<a href="#persistence-strategies" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>For the browser, you can:</p><ul><li>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" target="_blank" rel="noopener noreferrer">localStorage</a></li><li>Use a client-side database like <a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API" target="_blank" rel="noopener noreferrer">IndexedDB</a></li><li>Use <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies" target="_blank" rel="noopener noreferrer">cookies</a></li><li>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage" target="_blank" rel="noopener noreferrer">sessionStorage</a></li><li>Store the state in runtime memory (e.g., a global variable or some other persistent store)</li></ul><p>For the server, you can:</p><ul><li>Use a database (e.g., <a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">MongoDB</a>, <a href="https://www.postgresql.org/" target="_blank" rel="noopener noreferrer">PostgreSQL</a>, etc.)</li><li>Use a cache (e.g., <a href="https://redis.io/" target="_blank" rel="noopener noreferrer">Redis</a>)</li><li>Use cookies or session storage</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>There are <a href="https://github.com/statelyai/xstate/tree/next/examples" target="_blank" rel="noopener noreferrer">examples of persisting state that can be found in the XState git repository</a>:</p><ul><li><a href="https://github.com/statelyai/xstate/blob/next/examples/persisted-donut-maker" target="_blank" rel="noopener noreferrer">Persisting state to a writable <code>.json</code> file</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/mongodb-persisted-state" target="_blank" rel="noopener noreferrer">Persisting state to MongoDB</a></li></ul><p>Feel free to <a href="https://feedback.stately.ai/examples" target="_blank" rel="noopener noreferrer">suggest other examples at on our examples request board</a>, or <a href="https://github.com/statelyai/xstate/tree/next/examples" target="_blank" rel="noopener noreferrer">contribute your own examples</a>!</p>]]></content:encoded>
            <category>state machine</category>
            <category>statechart</category>
            <category>state</category>
            <category>persist</category>
            <category>restore</category>
            <category>business logic</category>
            <category>workflow</category>
            <category>xstate</category>
        </item>
        <item>
            <title><![CDATA[Context schema and export to CodeSandbox or StackBlitz]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-09-21-context-schema-and-export-to-external-editors</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-09-21-context-schema-and-export-to-external-editors</guid>
            <pubDate>Thu, 21 Sep 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[You can now open your machine in CodeSandbox or StackBlitz. These options show when you select either JavaScript or TypeScript export formats in the Code panel.]]></description>
            <content:encoded><![CDATA[<p>You can now open your machine in CodeSandbox or StackBlitz. These options show when you select either JavaScript or TypeScript export formats in the <strong>Code</strong> panel. When you open your machine in these external editors, it will be deployed as a demo app so you can jump quickly into prototyping and get an example of how to integrate your machine into your codebase.</p><p><img loading="lazy" alt="Code panel where JavaScript is selected from the dropdown. There are toggles for XState V5 beta, Show descriptions, and Show meta. There are options to Copy code, Open in CodeSandbox, and Open in StackBlitz." src="/statelyai-docs/assets/images/export-to-external-editors-6cd4337e960d95584e4c00acd7a7bf50.png" width="1268" height="712" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="context-schema">Context schema<a href="#context-schema" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve now released the context schema in the editor. You can find the context schema above the event schemas in the machine <strong>Details</strong> panel. Here, you can add a new context property with its name, type (string, number, boolean, array and object), and an optional description. These will then be exported in your TypeScript code. When you import a machine, Stately will stub an empty schema for any context properties in your code. If you add a context property in the <strong>Context</strong> panel that’s missing from the context schema, a quick link will appear under that property to quickly add it to the schema.</p><p><img loading="lazy" alt="The Context schema section at the end of the Machine details panel. The schema contains properties for timers and volume." src="/statelyai-docs/assets/images/context-schema-a0a2739625338719925319f66b3c19b3.png" width="1244" height="698" class="img_ev3q"></p><p>You can edit any context properties in the modal that opens when you click the property in the schema list. To delete all schema properties, use the <strong>Delete all</strong> option under the <strong>...</strong> menu.
In the Context schema section of the Details panel, you can also search through the list of context properties in your machine by name.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improved-simulation-mode">Improved Simulation mode<a href="#improved-simulation-mode" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve made some improvements to Simulation mode. The log panel is now named the <strong>Simulation controls</strong> and not only shows a log of your simulated path but contains buttons to navigate through the currently available events easily.</p><p><img loading="lazy" alt="Controls panel in simulate mode showing event buttons for shipping_details_added and cancel. The log has the options for Back, Reset, and Show active state, and the log list is a numbered list of events and their target states." src="/statelyai-docs/assets/images/simulate-mode-65b960dd77288b78c0bd487921b18700.png" width="1644" height="924" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We had a brief bug with importing large machines from the import modal. If you experienced any errors with importing machines, please try again now! If you are still experiencing any bugs, please let us know at <a href="mailto:support@stately.ai" target="_blank" rel="noopener noreferrer">support@stately.ai</a>.</p><ul><li>Fixed a bug where Stately could enter a loop if metadata fails when attempting to load a particular version URL.</li><li>Fixed a bug where previous versions that contained actions could throw errors.</li><li>Fix a bug where transition lines were lost after restoring a version and then hitting Undo.</li><li>Inline actions have been removed from exported JSON code.</li><li>Machines featuring raise callbacks will now export correctly to TypeScript.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>You can now choose to display your state’s meta information on the canvas. Add your meta information in the <strong>State details</strong> panel, and enable or disable from the editor menu &gt; View &gt; <strong>Show/Hide meta on canvas</strong>.</li><li>You can now right-click on states and events in the tree view and <strong>Center to view</strong> to center that state or event in the canvas view.</li><li>We’ve improved the OpenAI integration, so generated flows are now more accurate.</li><li>The length of long expressions rendered on the canvas and in toolbox blocks are now truncated.</li><li>We’ve improved the performance around importing a machine from code, so importing your machines should now be much faster.</li><li>Context is now supported in imported machines.</li><li>We’ve added more information about the <a href="https://stately.ai/registry/billing" target="_blank" rel="noopener noreferrer">features available to our Enterprise customers</a>.</li><li>A medley of internal fixes and improvements.</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>new</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[Make the dream work! An overview of Stately Studio’s teams feature]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/using-teams-in-stately-studio</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/using-teams-in-stately-studio</guid>
            <pubDate>Tue, 19 Sep 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Getting the most out of Stately Studio’s teams feature]]></description>
            <content:encoded><![CDATA[<p>Our team knew early on that users needed the ability to share machines in the Studio and build on each other’s work.
We also needed the Studio to be an effective tool for teams to work together and share context.
But how do we do that safely, making sure the right eyes were on the right machines?
And how do we protect against accidental mishaps that have plagued devs since the dawn of the computer?
Being a distributed dev team ourselves, we’ve shared these same pain points and decided to build a solution directly in the Studio.
Enter <a href="https://stately.ai/docs/teams" target="_blank" rel="noopener noreferrer">Stately teams</a>, our way to provide privacy and safety while allowing effortless collaboration.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-would-i-need-a-team">Why would I need a team?<a href="#why-would-i-need-a-team" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Great question, and we’re glad you asked!
While we have the <a href="https://stately.ai/registry/discover" target="_blank" rel="noopener noreferrer">Discover</a> page, which showcases over 20 thousand(!) community-created machines, we know that statecharts can contain critical details about core algorithms or processes that give businesses a competitive edge.
Many users expressed interest in keeping these types of machines private, and we listened.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sharing-machine-visualizations-with-teammates">Sharing machine visualizations with teammates<a href="#sharing-machine-visualizations-with-teammates" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Developing software is collaborative by nature. To get any product launched, bug fixed, or feature shipped, teams need to work together under the same shared context.
As projects grow in scope and complexity, it gets easier for team members to lose track of the bigger picture.
Team members may get lost in the weeds of their own work while the rest of the project changes around them, or they may not have the full context of the project and make decisions that don’t align with the team’s goals.
This is where the Studio’s teams feature comes in.
Visualizing app logic as statecharts allows teams to see the entire project at a glance, and the ability to share these visualizations empowers each member to make well-informed decisions, regardless of discipline.
Every teammate may not be a dev, but we’re confident that every teammate can benefit from a well-thought-out flowchart!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="teams-101">Teams 101<a href="#teams-101" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Teams is an exclusive feature for <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer"><strong>Pro</strong> and <strong>Enterprise</strong> users</a> that allows them to collaborate on different projects without needing to make them publicly visible. Team owners can assign roles that map closely with their team members’ intended set of responsibilities.</p><p><img loading="lazy" alt="The Stately Studio Next team members tab. Under Owners/Admin, Kevin is labeled as Owner. David is an admin. Laura, Farzad and Gavin are listed under Editors. Anders, cirephe, and Mateusz are listed under Viewers." src="/statelyai-docs/assets/images/teamVNext-4af5d354fa8d2d2bca781ce717938efd.png" width="1734" height="1552" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-control">Access control<a href="#access-control" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>There are many times when a dev team needs to share their work context with others without granting them full rights to the projects.
For example, Lenny in accounting probably shouldn't have access to the company repo, but he could benefit from visually understanding the steps involved in processes and workflows.
Having different teams with different roles lets us keep parties informed without added risk.
Don't trust your PM's trigger finger? Make them a <a href="https://stately.ai/docs/teams#viewer-role" target="_blank" rel="noopener noreferrer">viewer</a>; we promise not to tell.
Taking a vacation before new members can be onboarded?
Make another teammate an <a href="https://stately.ai/docs/teams#admin-role" target="_blank" rel="noopener noreferrer">admin</a>.
<a href="https://stately.ai/docs/teams#team-roles" target="_blank" rel="noopener noreferrer">Check out all our roles and permissions in our docs</a>. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sharing-conveniently-and-safely">Sharing conveniently and safely<a href="#sharing-conveniently-and-safely" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>There are ways to share machine visualizations in the Studio without teams, but they’re not ideal for many users.
Users can make their projects and machines public, but that is a no-go for most businesses.
Alternatively, Pro users could keep their projects private and only share with people they trust by exporting and re-importing. However, that invites potentially different sources of truth, adds potential confusion, and lacks a truly shared context.
Inviting users to collaborate on the same private team allows them to share without the exporting and copy/paste gymnastics. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-source-of-what-now">A source of what, now?<a href="#a-source-of-what-now" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Simply put, a “source of truth” is a single place where all the information about a project is stored.
In our case, we wanted to make sure that teams have a single place to view and collaborate on machine visualizations, and that place is a team project in the Studio.
This prevents confusion and allows for a shared context between all team members. With a proper source of truth configured, we can avoid situations like this:</p><p><img loading="lazy" alt="Four files with the filenames: onboardMachine.json, onboardMachine-final.json, onboardMachine-final-final.json, onboardMachine-actual-final-for-real-this-time.json." src="/statelyai-docs/assets/images/2023-09-15-file-confusion-6f3769f8c027dcf37f120ce32907a7d4.png" width="1376" height="352" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="but-what-about-source-control-shouldnt-that-be-the-source-of-truth">But what about source control? Shouldn’t that be the source of truth?<a href="#but-what-about-source-control-shouldnt-that-be-the-source-of-truth" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Ideally, yes, the team’s repository is the single source of truth for all application logic, but not every team member is a developer, nor should they all have access to source code.
That said, we know teams need to ensure their machines in the Studio are always in lockstep with the rest of their source, so we added the ability to <a href="https://stately.ai/docs/import-from-github" target="_blank" rel="noopener noreferrer">import machines directly from GitHub</a>.
We’re also working on a fully-fledged GitHub Sync feature, allowing users to save machines as commits back to their source repos! <a href="https://www.youtube.com/watch?v=WelBycMg2eA&amp;t=1293s" target="_blank" rel="noopener noreferrer">Check out Anders’ demo previewing GitHub Sync in our recent office hours live stream</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="superpower-pro-features">Superpower Pro features<a href="#superpower-pro-features" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Having teams allows other features to shine. For example, we all know the value of collaboration, but more users naturally add more potential for mistakes to happen, even with proper roles assigned. To protect against mistakes, we’ve added the ability to <a href="https://stately.ai/docs/lock-machines" target="_blank" rel="noopener noreferrer">lock machines</a>, preventing teammates from accidentally overwriting or deleting machines.</p><p><img loading="lazy" alt="A machine with locked status in Stately. Hovering over the status shows the information that the machine was Locked by cirephe on September 8, 2023 at 07:48PM." src="/statelyai-docs/assets/images/lockedScreenshot-5e95e27f989f2cd2108a9c592dd3c23e.png" width="860" height="154" class="img_ev3q"></p><p>Team members often need to manage and track variants of the same machine, so we added the ability to create <a href="https://stately.ai/docs/versions" target="_blank" rel="noopener noreferrer">machine versions</a>. Members can edit and save specific checkpoints of their machines and can even see the last person to and save a specific version. Team roles come into play here again by allowing only owners and admins to actually delete versions.</p><p><img loading="lazy" alt="Machine versions panel in Stately. The current version is named Gavin’s ultimate joke machine. The previous version is a generated flow for a “A flow showing someone how to be funny.”" src="/statelyai-docs/assets/images/versionScreenshot-e7e397a48a61eb2e40c36a7a609a7896.png" width="2488" height="1348" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="faqs">FAQs<a href="#faqs" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="who-can-join-my-team">Who can join my team?<a href="#who-can-join-my-team" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Anyone with an email address can be invited to a team!
If they are not already members, they will have to <a href="https://stately.ai/registry/login?" target="_blank" rel="noopener noreferrer">sign up for a Stately account</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-many-users-can-be-on-a-team">How many users can be on a team?<a href="#how-many-users-can-be-on-a-team" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>A team can have as many members as there are seats in your Pro or Enterprise plan, except for viewers.
Viewers are free to add.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="does-inviting-a-user-take-up-a-seat-on-the-team">Does inviting a user take up a seat on the team?<a href="#does-inviting-a-user-take-up-a-seat-on-the-team" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The seat is only taken once a user accepts the invite and claims the seat.
If the invite was not accepted, the seat remains free.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="can-i-swap-member-roles-and-reclaim-seats">Can I swap member roles and reclaim seats?<a href="#can-i-swap-member-roles-and-reclaim-seats" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Yes, but only owners and admins have the ability to reassign roles.
Any role except the owner may choose to leave the team, however.
The owner can instead delete the team. </p><p>Yes, but only owners and admins can reassign roles.
Any role except the owner may choose to leave the team, however.
The owner can instead delete the team.</p><p>For more detailed information, visit our <a href="https://stately.ai/docs/teams#teams-members-and-pro-plan-seats" target="_blank" rel="noopener noreferrer">Stately teams page in the docs</a>!</p>]]></content:encoded>
            <category>stately studio</category>
            <category>xstate</category>
            <category>teams</category>
            <category>machine versions</category>
            <category>machine locking</category>
        </item>
        <item>
            <title><![CDATA[Event schemas, free Viewer roles for teams, and more!]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-09-15-event-schemas-viewer-role</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-09-15-event-schemas-viewer-role</guid>
            <pubDate>Fri, 15 Sep 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[The Stately team has had another busy week. The editor now has event schemas, and we’ve made many more improvements. Let’s dig in!]]></description>
            <content:encoded><![CDATA[<p>The Stately team has had another busy week. The editor now has event schemas, and we’ve made many more improvements. Let’s dig in!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="event-schemas">Event schemas<a href="#event-schemas" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Event schemas are now available in the editor. You can access the event schemas from the <strong>Machine details</strong> panel. The event schema enables you to define events for the current machine, including all of the events’ properties, including, but not limited to, the event description.</p><p><img loading="lazy" alt="The machine details panel showing a list of events in the current machine, including retry, filter, search, load_more, and remove_filter. There is an unused event called Event 1." src="/statelyai-docs/assets/images/events-schema-8259465ffa80a037555f5a3ca3278e9d.png" width="2290" height="1288" class="img_ev3q"></p><p>You can search for available events from the event schema panel, edit their details, and create new events. Any events you aren’t using in your machine have less opacity, and you can delete all unused events from the <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-more-horizontal"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg> button and choose <strong>Delete all unused</strong>.</p><p>You can also view the schema for any event by selecting that event on the canvas and opening the <strong>Event details</strong> panel.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="team-viewer-role-is-now-free">Team viewer role is now free<a href="#team-viewer-role-is-now-free" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The <strong>Viewer</strong> role in Stately Teams is now free and does not count towards your number of seats. You can now see how many available seats you have left on your team from the Team page and the Billing page.</p><p><img loading="lazy" alt="Stately Demos team Members page. Showing Anders being invited to the team with the Viewer role." src="/statelyai-docs/assets/images/free-viewer-role-343d5cf9ccb8a57a21cbd03c968f7546.png" width="2284" height="1284" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements-to-generating-flows">Improvements to generating flows<a href="#improvements-to-generating-flows" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve improved the interface for generating flows to make it easier and faster. You can now access the history of text descriptions you used for your current machine from the <strong>View history</strong> button in the <strong>Generate flow</strong> dialog. Use the <strong>Copy to prompt</strong> button to copy a preview prompt into the description field to try it again!</p><p><img loading="lazy" alt="Prompt history in Generate flows dialog which shows two text descriptions previously used to generate flows, with buttons to open flow and copy to prompt." src="/statelyai-docs/assets/images/prompt-history-189cd0397d3615315825a1706489837b.png" width="2060" height="1160" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements-to-the-machines-list">Improvements to the machines list<a href="#improvements-to-the-machines-list" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>Machines are now sorted alphabetically from A to Z in the machines list.</li><li>Locked machines now have a locked icon alongside their name in the machines list.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-improvements">More improvements<a href="#more-improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The machine’s root state now has a minimal borderless appearance by default, giving you more space to focus on your machine. If you change the root state’s color or add a description, action, or any other block type, the root state will revert to its classic bordered design and the same features as any other parent state.</p><ul><li>Annotations are now borderless, so they appear directly on the canvas.</li><li>Transition labels now have more definition to make them easier to read.</li><li>You can now jump directly to the Discover page from <strong>Discover</strong> in the Editor menu.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We fixed a bug where a machine name was not correctly updated when you renamed its root state.</p>]]></content:encoded>
            <category>changelog</category>
            <category>new</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[New experimental feature: generating flows]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-09-06-generating-flows</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-09-06-generating-flows</guid>
            <pubDate>Wed, 06 Sep 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Learn how to generate and modify flows from plain text using Stately's new intelligent features]]></description>
            <content:encoded><![CDATA[<p>As software architecture grows increasingly complex, developers and project managers often grapple with the challenge of visualizing and organizing application logic. This is where state machines and flows come into play. State machines are a powerful tool for modeling application logic, and flows are a great way to visualize and organize state machines. At Stately, we’re committed to making state machines and flows more accessible and easier to use.</p><p>But state machines, though powerful, have a learning curve that can be a bit intimidating. And then there’s the blank slate problem: where do you even start when modeling a flow? Furthermore, when flows get large, how can you apply broad changes in a more natural way while keeping the flow intact and logically correct? These are some of the challenges we set out to solve with our new experimental generative features.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-generative-features">New generative features<a href="#new-generative-features" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In response to these challenges, we are thrilled to introduce two experimental beta features:</p><ul><li>The ability to <strong>generate a flow</strong> from plain text</li><li>The ability to <strong>modify an existing flow</strong> from plain text</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="generating-a-flow">Generating a flow<a href="#generating-a-flow" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>To utilize this feature:</p><ol><li>Click on the <strong>Generate flow</strong> button located in the top bar.</li><li>Write a prompt for a flow you would like to generate; for instance, “A simple checkout process.”</li><li>Be descriptive; the more information you provide, the more detailed the resulting state machine flow will be.</li><li>Click the <strong>Generate flow</strong> button, wait a few seconds, and voilà!</li></ol><p><img src="/blog/2023-08-31-generating-flows/generate-flow.png" alt="Generate flow dialog: Experimental feature. With the flow description of “A simple checkout process”, with the submit button “Generating flow” in progress." class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/2023-08-31-generating-flows/generate-flow-dm.png" alt="Generate flow dialog: Experimental feature. With the flow description of “A simple checkout process”, with the submit button “Generating flow” in progress." class="themedImage_ToTc themedImage--dark_i4oU"></p><p>Stately leverages LLMs to craft a flow that matches your prompt. The result is a flow that is both understandable and consistent with your specifications, and can be further refined to suit your needs.</p><p><em>The following machine is the result of generating the flow described by “A checkout flow where you can edit basket, update basket, add shipping details, add billing details, calculate shipping costs, and take payment. Payment can succeed or fail. Succeed is the final state. On fail, payment can be tried again after update billing details.”</em></p><iframe loading="lazy" src="https://stately.ai/registry/editor/embed/8f7e6dc9-0ec0-425d-a20c-fef3849ee264?machineId=d8b78ea7-38a7-4f35-8329-0118a8aa307a&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/8f7e6dc9-0ec0-425d-a20c-fef3849ee264?machineId=d8b78ea7-38a7-4f35-8329-0118a8aa307a">View the <em>checkoutFlow</em> machine in Stately Studio</a>.</iframe><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modifying-a-flow">Modifying a flow<a href="#modifying-a-flow" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The process to modify an existing flow is similar:</p><ol><li>Click on the <strong>Generate flow</strong> button located in the top bar.</li><li>Write instructions for the modifications you would like to make to the flow; for instance, “Add a new state to the flow that handles a user cancelling their order.”</li><li>As before, the more information you provide, the more detailed the resulting state machine flow will be.</li><li>Toggle the <strong>Modify current flow</strong> switch.</li><li>Click the <strong>Modify current flow</strong> button, wait a few seconds, and voilà!</li></ol><p>Stately will use the existing flow as context to generate a new flow that incorporates your modifications. Keep in mind that this will send your flow to OpenAI, so only use this feature if you are comfortable with that.</p><p><em>The following machine is the result of modifying the previous flow with the description “Viewing basket is the initial state.”</em></p><iframe loading="lazy" src="https://stately.ai/registry/editor/embed/8f7e6dc9-0ec0-425d-a20c-fef3849ee264?machineId=d8b78ea7-38a7-4f35-8329-0118a8aa307a&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/8f7e6dc9-0ec0-425d-a20c-fef3849ee264?machineId=d8b78ea7-38a7-4f35-8329-0118a8aa307a">View the <em>checkoutFlow, modified</em> machine in Stately Studio</a>.</iframe><h2 class="anchor anchorWithStickyNavbar_LWe7" id="be-creative">Be creative<a href="#be-creative" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The potential is vast. Think about generating flows for domains like customer support, inventory management, or online voting systems. Imagine refining a flow to incorporate customer feedback, include multilingual support, or even a state to address system downtimes. The horizon is truly limitless.</p><p>All applications have state machine flows in them, whether they’re implicitly or explicitly defined, in the frontend or backend. There’s many possibilities for flows to generate and modify. Here’s some examples:</p><ul><li>A flow for a simple checkout process</li><li>A newsletter signup flow</li><li>A marketing automation flow</li><li>An authentication flow</li><li>Logic for a customer support chatbot</li><li>Game logic for complex multiplayer games</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privacy">Privacy<a href="#privacy" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>At Stately, we take privacy seriously. We are committed to protecting your data and ensuring that your creations remain yours. Rest assured that:</p><ul><li>No user-created flows are contributed to our training dataset.</li><li>Flows are provided as context to OpenAI only when you opt for modifying an existing flow with the experimental generative features.</li><li>We will never use your flows as training data without your explicit permission.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="our-generative-transition">Our generative transition<a href="#our-generative-transition" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Our vision goes beyond mere generation. Upcoming features include:</p><ul><li>Autogenerated detailed descriptions for states and transitions.</li><li>Code implementations for actions, invocations, guards, and more.</li><li>Intelligent suggestions for expanding, simplifying, and improving your flows, like <a href="https://github.com/features/copilot/" target="_blank" rel="noopener noreferrer">GitHub Copilot</a> for application logic.</li><li>Narratives and summaries of flows in natural language.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="and-much-much-more">And much, much more<a href="#and-much-much-more" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We want Stately to be the source of truth for your application logic, not just as a collection of flows, but as an intelligent tool for helping you and your team build better software.</p><p>Stately’s experimental generative features are available exclusively to our <a href="/statelyai-docs/docs/studio-pro-plan">Pro users</a> in beta. We’re offering a <a href="/statelyai-docs/pricing">one-month free trial</a>, so you can try it out and see for yourself. We’d love to hear your feedback and ideas, so please try out the new features and let us know what you think!</p>]]></content:encoded>
            <category>pro</category>
            <category>generate flows</category>
            <category>modeling</category>
        </item>
        <item>
            <title><![CDATA[Fixes and improvements]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-09-06-fixes-and-improvements</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-09-06-fixes-and-improvements</guid>
            <pubDate>Wed, 06 Sep 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[We’ve released many new features recently, but we’ve also made minor enhancements and bug fixes to improve your Stately experience.]]></description>
            <content:encoded><![CDATA[<p>We’ve released many new features recently, but we’ve also made minor enhancements and bug fixes to improve your Stately experience.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>The fork machine button is now hidden for empty projects.</li><li>The generate flow button is now shown on empty projects.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements-to-descriptions-and-annotations">Improvements to descriptions and annotations<a href="#improvements-to-descriptions-and-annotations" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Descriptions and annotations have had an upgrade. You can now add a description to states and events from the edit menu edit (right-click on the state or event) and edit descriptions by double-clicking them.</p><p>We also made the following improvements to both descriptions and annotations:</p><ul><li>URLs will be detected as links automatically.</li><li>Paste a URL onto selected text to turn it into a link.</li><li>Add task lists by using <code>[ ]</code> at the beginning of each line.</li><li>Add code fences using triple <code>```…```</code> backticks.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><ul><li>Action blocks are now multiline and show more information about the action.</li><li>Assign actions now show the keys and values that are being assigned.</li><li>Send to actions now show the event object when you hover over the event.</li><li>You can now drag an event or state when holding down on an image inside the description.</li><li>Extra parentheses are no longer added around XState V4 exported code. And it's now less sensitive toward whitespaces.</li><li>Assign actions now have a better color in light mode.</li><li>Auto-layout is now allowed when previewing machine versions.</li><li>You will now be redirected to your projects if you try to open an empty project you can't edit.</li><li>Users on the community plan can now see the Pro lock machine features and learn about them.</li><li>A medley of internal fixes and improvements.</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[Generate flow]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-09-01-generate-flow</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-09-01-generate-flow</guid>
            <pubDate>Fri, 01 Sep 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[As a Stately Pro user, you can now auto-create machines from text descriptions with our new experimental feature, Generate flow.]]></description>
            <content:encoded><![CDATA[<p>As a Stately Pro user, you can now auto-create machines from text descriptions with our new experimental feature, <strong>Generate flow</strong>. You can generate a flow for a new machine or use the flow description to describe how you want to modify your current flow.</p><p><img loading="lazy" src="https://canny.io/images/e42062421f9551d8849e998cc5ebb78f.png" alt="Generate flow dialog: Experimental feature. With the flow description of  “a debounce flow”, hovering over the button to Generate new flow. The generated flow is visible in the background." class="img_ev3q"></p><p>There are so many reasons you might want to generate your flows, including:</p><ul><li>You have a complex machine in mind and want to get started quickly</li><li>You want an example of a state machine for a particular flow</li><li>You’re new and want to get an idea of how you can model state machines</li></ul><p>With 1000 calls a month, and a <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">free 30-day Pro trial</a>, get ready to create state machines in no time!</p>]]></content:encoded>
            <category>changelog</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[Lock machines]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-09-01-lock-machines</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-09-01-lock-machines</guid>
            <pubDate>Fri, 01 Sep 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Yet another new Pro feature for you this week: you can now lock machines to prevent accidental edits.]]></description>
            <content:encoded><![CDATA[<p>Yet another new Pro feature for you this week: you can now lock machines to prevent accidental edits. Lock a machine using the lock icon button in the machine Details panel.</p><p><img loading="lazy" src="https://canny.io/images/bf32dce0740ed980ce0857de69b914b7.png" alt="Locking the machine from the lock icon button in the Machine Details panel." class="img_ev3q"></p><p>Locking a machine prevents you or anyone else on your team, from editing, deleting, or renaming a machine. It will also prevent anyone from importing code to replace the machine or restoring a past version of the machine.</p><p>Locked machines have a Locked status displayed in the editor’s top bar. If you hover over the Locked status, you’ll get a tooltip detailing who locked the machine and when.</p><p><img loading="lazy" src="https://canny.io/images/9da124b731543a326412296c5897872b.png" alt="Hovering over the Locked status to read that the machine was Locked by Laura Kalbag a few seconds ago." class="img_ev3q"></p><p>If somebody else is viewing or editing the machine when it is locked, their changes will not be saved, and they will be notified that the machine is now locked.</p><p><a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer"><strong>Try all our Pro features free on our 30 day trial</strong></a>.</p><p><a href="https://stately.ai/docs/lock-machines" target="_blank" rel="noopener noreferrer">Read more about locking machines in our docs</a>.</p>]]></content:encoded>
            <category>changelog</category>
            <category>pro</category>
            <category>beta</category>
            <category>new</category>
        </item>
        <item>
            <title><![CDATA[Fixes and improvements]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-08-23-fixes-and-improvements</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-08-23-fixes-and-improvements</guid>
            <pubDate>Wed, 23 Aug 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[This week, the Stately team has been hard at work with even more bug fixes and improvements.]]></description>
            <content:encoded><![CDATA[<p>This week, the Stately team has been hard at work with even more bug fixes and improvements.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>Default action implementations have now been fixed so that the correct default implementation is applied for both XState V4 and XState V5.</li><li>The Learn Stately video modal will no longer show in machine images.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>If you’re new to Stately, you’ll now get a notification with the option to view the Learn Stately videos instead of the modal opening immediately.</li><li>A plethora of internal fixes and improvements.</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>new</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[Export descriptions and meta fields, and even more improvements!]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-08-17-export-descriptions-and-meta-fields</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-08-17-export-descriptions-and-meta-fields</guid>
            <pubDate>Thu, 17 Aug 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[You can now choose to export state and event descriptions and meta fields with your exported code.]]></description>
            <content:encoded><![CDATA[<p>You can now choose to export state and event descriptions and meta fields with your exported code.</p><p><img loading="lazy" src="https://canny.io/images/a7da75d317d2f0faf17436442cae2051.png" alt="Stately code panel with show descriptions and show meta toggles enabled." class="img_ev3q"></p><p>Find the <strong>Show descriptions</strong> and <strong>Show meta</strong> toggles in the Code panel.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>Guarded eventless (always) transitions will now work as expected in Simulation mode.</li><li>We fixed a bug where the layout would sometimes shift in the Version History panel if there were many versions in the list and the user clicked to view one of those versions.</li><li>You are now able to copy the selected text inside the editor again.</li><li>Deleting meta values will no longer affect other meta entries.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>In read-only mode, selected states and events are now highlighted green rather than blue.</li><li>We changed the wording on the new version banner to reassure users their changes have been saved locally, and they’re safe to refresh the page.</li><li>A host of internal fixes and improvements working towards exciting future features!</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>pro</category>
            <category>new</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[The latest live streams from Stately]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-08-17-latest-live-streams-from-stately</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-08-17-latest-live-streams-from-stately</guid>
            <pubDate>Thu, 17 Aug 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[The Stately team has been doing a lot of live streams lately, covering the front-end, back-end, and everything new in the Stately editor.]]></description>
            <content:encoded><![CDATA[<p>The Stately team has been doing a lot of live streams lately, covering the front-end, back-end, and everything new in the Stately editor.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="making-workflows-serverless">Making workflows serverless<a href="#making-workflows-serverless" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In the recent live stream on making workflows serverless, Gavin and David discussed what it takes to make a serverless workflow in XState, and the advantages of using state machines for workflows.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="making-a-markdown-component">Making a markdown component<a href="#making-a-markdown-component" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you’ve been looking to start using state machines in your front end, check out the live stream with David and Farzad, where they made a simple markdown converter component using XState, React, and Stately.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="office-hours">Office hours<a href="#office-hours" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>During our latest office hours, we demoed many recently-released features and gave a sneak peek of GitHub Sync, which is coming soon!</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><p>Jump straight to the chapter:</p><ul><li>0:00 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=0s" target="_blank" rel="noopener noreferrer">Intro</a></li><li>0:26 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=26s" target="_blank" rel="noopener noreferrer">Team intros</a></li><li>1:28 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=88s" target="_blank" rel="noopener noreferrer">Learn Stately videos and tutorials (new!)</a></li><li>5:44 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=344s" target="_blank" rel="noopener noreferrer">Recent Stately live streams</a></li><li>7:41 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=461s" target="_blank" rel="noopener noreferrer">Markdown support in annotations (new!)</a></li><li>10:37 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=637s" target="_blank" rel="noopener noreferrer">Renaming projects from the breadcrumb (new!)</a></li><li>11:18 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=678s" target="_blank" rel="noopener noreferrer">Reordering guarded transitions UI (new!)</a></li><li>15:10 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=910s" target="_blank" rel="noopener noreferrer">Built-in actions using XState icon (new!)</a></li><li>17:11 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=1031s" target="_blank" rel="noopener noreferrer">Personal projects are now private by default for Pro users (new!)</a></li><li>17:50 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=1070s" target="_blank" rel="noopener noreferrer">No more warning in Safari!</a></li><li>18:50 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=1130s" target="_blank" rel="noopener noreferrer">Reparenting states</a></li><li>21:33 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=1293s" target="_blank" rel="noopener noreferrer">Coming soon: GitHub sync (demo)</a></li><li>30:04 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=1804s" target="_blank" rel="noopener noreferrer">Any news on displaying machines in pull requests?</a></li><li>32:09 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=1929s" target="_blank" rel="noopener noreferrer">David, Jenny, and Gavin at React Rally next week</a></li><li>34:30 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=2070s" target="_blank" rel="noopener noreferrer">Different highlight color on view-only machines (new!)</a></li><li>36:07 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=2167s" target="_blank" rel="noopener noreferrer">Performance improvements</a></li><li>37:20 <a href="https://youtube.com/watch?v=WelBycMg2eA&amp;t=2240s" target="_blank" rel="noopener noreferrer">Wrap up</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-streams-are-coming-soon">More streams are coming soon!<a href="#more-streams-are-coming-soon" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The best way to enjoy our live streams is to join us live. <a href="https://www.youtube.com/@Statelyai" target="_blank" rel="noopener noreferrer">Subscribe to us on YouTube</a>, and you’ll be notified first when we schedule new live streams. When you join us live, you can get your questions answered by the team and participate in the fun discussions in our comments.</p><p>Want to request an example or demo for one of our next live streams? Please share what you want to watch on <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">our Discord</a>.</p>]]></content:encoded>
            <category>stately</category>
            <category>live stream</category>
            <category>videos</category>
            <category>demo</category>
            <category>example</category>
            <category>office hours</category>
        </item>
        <item>
            <title><![CDATA[And all the other improvements this week!]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-08-10-all-the-other-improvements</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-08-10-all-the-other-improvements</guid>
            <pubDate>Thu, 10 Aug 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Our new Learn Stately guidance got its own changelog this week, but there’s more that’s new to Stately.]]></description>
            <content:encoded><![CDATA[<p>Our new Learn Stately guidance got its own changelog this week, but there’s more that’s new to Stately.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>Transition handles now always appear over warning and danger icons rather than being hidden behind them.</li><li>Annotations are no longer editable in view-only mode.</li><li>The icon used for keyboard shortcuts now renders better in light mode.</li><li>Multiline descriptions no longer break exporting to code.</li><li>We fixed a brief bug where saving new machines to existing projects would fail.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You can now reorder guarded transitions by moving them up or down in order.</p><p><img loading="lazy" src="https://canny.io/images/4436f90a13b55e44c899956abf375ec5.gif" alt="Right-clicking the second guarded transition and selecting reorder guard, then move up." class="img_ev3q"></p><p>And the options to add a guard and add a transition to an existing transition have been split into two distinct actions in the <strong>+</strong> menu.</p><p><img loading="lazy" src="https://canny.io/images/adf6f6690a553a720c7557f9584a6709.png" alt="The plus icon menu for a transition, showing the options to add a Guard, Transition, Action, or Description." class="img_ev3q"></p><ul><li>Personal projects are now private by default for our Pro subscribers.</li><li>We no longer show a warning to Safari users as the editor is working well in Safari!</li><li>A miscellany of internal fixes and improvements.</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>new</category>
        </item>
        <item>
            <title><![CDATA[Learn Stately with our new editor videos]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-08-10-new-editor-videos</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-08-10-new-editor-videos</guid>
            <pubDate>Thu, 10 Aug 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[We’ve created our Learn Stately guidance and accompanying tutorials to introduce the basic concepts of state machines.]]></description>
            <content:encoded><![CDATA[<p>We’ve just released a new way for new users to learn Stately. We know that the learning curve is one of the biggest challenges you face when adopting state machines in your teams. We’ve designed our Learn Stately guidance and accompanying tutorials to introduce the basic concepts of state machines, demonstrate how to build them, simulate them, export them to code, and implement them with the exported code.</p><p><img src="/blog/2023-08-10-new-editor-videos/onboarding.png" alt="Learn Stately modal in the editor, with a video of the editor in action." class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/2023-08-10-new-editor-videos/onboarding-dm.png" alt="Learn Stately modal in the editor, with a video of the editor in action." class="themedImage_ToTc themedImage--dark_i4oU"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="learn-stately-guidance">Learn Stately guidance<a href="#learn-stately-guidance" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The highlight of our Learn Stately guidance is two short videos (less than 8 minutes total!) that provide a step-by-step guide to using Stately and cover the basics of state machines. The videos demonstrate how to build state machines, and the practical examples show you how to use our key features.</p><p>The Learn Stately guidance is triggered automatically when a new user visits the Stately editor or if they haven’t viewed the guidance before. You can also relaunch the modal anytime from the Editor menu by selecting Help &gt; Learn Stately or from the Help drawer by selecting Learn Stately.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="updated-tutorials">Updated tutorials<a href="#updated-tutorials" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve also updated the tutorials in the Help drawer. We designed the tutorials as a refresher for the concepts learned in the videos and a quick start guide to Stately. They offer a brief overview of the features and functions of Stately, including how to create, edit, and simulate state machines.</p><p>You can always check out our <a href="https://stately.ai/docs" target="_blank" rel="noopener noreferrer">Stately and XState docs</a> if you need further tutorials and examples. The docs cover everything from the basics of state machines to advanced implementation with XState.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="wed-love-your-feedback">We’d love your feedback.<a href="#wed-love-your-feedback" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The new Learn Stately guidance and accompanying tutorials will hopefully make it easier than ever for new users to get started with state machines. We’d love your feedback about the videos and tutorials. Please let us know if they’ve helped and what other information you and your team need to get started with state machines. You can <a href="https://feedback.stately.ai" target="_blank" rel="noopener noreferrer">request features, docs, and examples on our feedback board</a>. Or let us know on our social channels below:</p><ul><li><a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">Discord</a></li><li><a href="https://www.linkedin.com/company/statelyai/" target="_blank" rel="noopener noreferrer">LinkedIn</a></li><li><a href="https://social.stately.ai/@stately" target="_blank" rel="noopener noreferrer">Mastodon</a></li><li><a href="https://twitter.com/statelyai" target="_blank" rel="noopener noreferrer">Twitter</a></li><li><a href="https://instagram.com/statelyai" target="_blank" rel="noopener noreferrer">Instagram</a></li></ul>]]></content:encoded>
            <category>stately</category>
            <category>editor</category>
            <category>videos</category>
            <category>docs</category>
            <category>tutorials</category>
            <category>changelog</category>
            <category>new</category>
        </item>
        <item>
            <title><![CDATA[Markdown in annotations, performance improvements, and more!]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-08-04-markdown-in-annotations</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-08-04-markdown-in-annotations</guid>
            <pubDate>Fri, 04 Aug 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[This week’s headlines are that annotations now support markdown, and we’ve made many performance improvements!]]></description>
            <content:encoded><![CDATA[<p>This week’s headlines are that annotations now support markdown, and we’ve made many performance improvements!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new">New<a href="#new" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Markdown is now supported in <a href="https://stately.ai/docs/annotations" target="_blank" rel="noopener noreferrer">annotations</a>! Previously you could only use plain text in your annotations; now, you can use markdown, like in <a href="https://stately.ai/docs/descriptions" target="_blank" rel="noopener noreferrer">descriptions</a>.</p><p><img loading="lazy" src="https://canny.io/images/6ac21f4c3304524750dc52485c1d59fb.png" alt="Markdown being entered into an annotation, and that same annotation with bold text, italic text, a link, and a cute goldfish image." class="img_ev3q"></p><p>Create an annotation by right-clicking anywhere on the canvas.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>Simulation mode has been fixed for embedded machines.</li><li>You now only need to press the back button once to return to the Projects list from the editor.</li><li>Share image URLs were quickly fixed after being broken by a previous release.</li><li>Renamed machines can now be filtered by their new names when filtered in the machines list.</li><li>Initial states are now correctly assigned when copying and pasting states.</li><li>The keyboard shortcuts button in the help drawer is now fixed.</li><li>The Give Feedback button in the help drawer is now easier to click.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>We have spent some time improving the performance of the canvas and UI, and your large machines should now be much smoother. Please <a href="mailto:support@stately.ai" target="_blank" rel="noopener noreferrer">let us know</a> if you have any machines which need more attention!</li><li>You can now rename your project by double-clicking its name in the editor’s breadcrumb.</li><li>Old context values with type array or object are now migrated correctly. Arrays and objects in the old machine context structure were stored as strings, and now when the user opens their machines, they’re correctly converted to JavaScript arrays and objects, respectively.</li><li>The starter machine description is now an annotation, making it easier to delete all the states and transitions inside a starter machine if you want a fresh start.</li><li>The left panel width is now persisted when you reload the page.</li><li>Custom actions are now correctly handled in <strong>Import Code</strong>; top-level action parameters are moved inside the <code>action.params</code> object, and <code>type</code> now appears before <code>params</code> in exported code.</li><li>The following machine options are no longer included in exported code: Do not include these in machine options in the exported code: actions with expression <code>type</code>, actors with expression <code>src</code>, guards with expression names, and delays with expression values.</li><li>A motley collection of internal fixes and improvements.</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[Stately Office Hours 68]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-07-26-office-hours-68</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-07-26-office-hours-68</guid>
            <pubDate>Wed, 26 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[We’ve recently launched a huge Stately release, and we covered it all (as well as some even newer features!) in our latest office hours live stream.]]></description>
            <content:encoded><![CDATA[<p>We’ve recently launched a huge Stately release, and we covered it all (as well as some even newer features!) in our latest office hours live stream.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><p>Watch the video to find out all the new features. Use the links below to jump straight to that chapter in the video:</p><ul><li>0:00 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=0s" target="_blank" rel="noopener noreferrer">Intro</a></li><li>0:30 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=30s" target="_blank" rel="noopener noreferrer">Team intros</a></li><li>01:14 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=74s" target="_blank" rel="noopener noreferrer">Everything in the new release!</a></li><li>1:59 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=119s" target="_blank" rel="noopener noreferrer">Colors (new!)</a></li><li>4:34 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=274s" target="_blank" rel="noopener noreferrer">Creating directly from the canvas (new!)</a></li><li>6:16 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=376s" target="_blank" rel="noopener noreferrer">Refined statechart design (new!)</a></li><li>6:41 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=401s" target="_blank" rel="noopener noreferrer">Built-in XState actions (new!)</a></li><li>7:08 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=428s" target="_blank" rel="noopener noreferrer">Transition routing and translucency (new!)</a></li><li>8:30 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=510s" target="_blank" rel="noopener noreferrer">Hide UI (new!)</a></li><li>9:44 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=584s" target="_blank" rel="noopener noreferrer">Export to XState V5 beta (new!)</a></li><li>11:33 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=693s" target="_blank" rel="noopener noreferrer">Request the features you want</a></li><li>12:14 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=734s" target="_blank" rel="noopener noreferrer">Filter machines by name (new!)</a></li><li>13:01 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=781s" target="_blank" rel="noopener noreferrer">Do colors appear in the state machine config too?</a></li><li>14:20 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=860s" target="_blank" rel="noopener noreferrer">Will the viz still be replaced by the new editor?</a></li><li>15:38 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=938s" target="_blank" rel="noopener noreferrer">Hiding the canvas grid</a></li><li>16:10 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=970s" target="_blank" rel="noopener noreferrer">When will these features be available in the XState VSCode extension?</a></li><li>17:30 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=1050s" target="_blank" rel="noopener noreferrer">How can you use XState on the back-end?</a></li><li>19:55 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=1195s" target="_blank" rel="noopener noreferrer">Will not(…) be coming to the guards UI?</a></li><li>21:08 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=1268s" target="_blank" rel="noopener noreferrer">Autosave for Pro users (new!)</a></li><li>25:03 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=1503s" target="_blank" rel="noopener noreferrer">Improved order when exporting states (new!)</a></li><li>28:34 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=1714s" target="_blank" rel="noopener noreferrer">Export to Mermaid (new!)</a></li><li>31:31 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=1891s" target="_blank" rel="noopener noreferrer">Will there be more keyboard shortcuts?</a></li><li>33:10 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=1990s" target="_blank" rel="noopener noreferrer">Enterprise plans</a></li><li>37:06 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=2226s" target="_blank" rel="noopener noreferrer">Stately code editor Vim mode?</a></li><li>37:46 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=2266s" target="_blank" rel="noopener noreferrer">Stately live streams</a></li><li>40:08 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=2408s" target="_blank" rel="noopener noreferrer">Wrap up</a></li><li>40:53 <a href="https://youtube.com/watch?v=AKAnjF3NKjo&amp;t=2453s" target="_blank" rel="noopener noreferrer">Will the new merch come in the palette colors?</a></li></ul><p>Do you want to vote on our upcoming features? <a href="https://feedback.stately.ai" target="_blank" rel="noopener noreferrer">Visit our roadmap to upvote feature suggestions and make your own feature requests</a>.</p>]]></content:encoded>
            <category>stately</category>
            <category>studio</category>
            <category>office hours</category>
            <category>colors</category>
            <category>actions</category>
            <category>canvas</category>
            <category>grid</category>
            <category>ui</category>
            <category>xstate</category>
            <category>xstate v5</category>
        </item>
        <item>
            <title><![CDATA[Stately minor improvements]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-07-26-stately-minor-improvements</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-07-26-stately-minor-improvements</guid>
            <pubDate>Wed, 26 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[The Stately team has released more this week, and we have even more fixes and improvements for you.]]></description>
            <content:encoded><![CDATA[<p>We have more fixes and improvements for you this week.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>The previously over-eager logged out toast will now only show after successfully signing out.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>We now use the XState logo for built-in actions to distinguish them from custom actions:
<img loading="lazy" src="https://canny.io/images/15c535b6fcbcfe8213cac46cbf38947c.png" alt="State with built-in XState entry actions, including assign, raise, log, send, and stop. These all have a corresponding XState X icon. The custom action has a lightning icon." class="img_ev3q"></li><li>We’ve labeled the <a href="https://feedback.stately.ai/changelog/export-to-mermaid" target="_blank" rel="noopener noreferrer">Export to Mermaid option</a> as “Beta” as we continuously improve this feature.</li><li>When a user shares a direct team link with another user who has been invited to the team but has yet to accept the invitation, we will now redirect that recipient to their team invitation page, where they can accept or decline the invitation.</li><li>After a user has created a new machine, the editor will always switch back to Design mode, even if the user was previously in Simulation mode.</li><li>We’ve improved the page titles so that browser tab text is easier to read and understand.</li><li>A melange of internal fixes and improvements.</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>beta</category>
            <category>new</category>
        </item>
        <item>
            <title><![CDATA[Improving your flows with color]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-07-24-improving-your-flows-with-color</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-07-24-improving-your-flows-with-color</guid>
            <pubDate>Mon, 24 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[As part of our recent colossal release, we’ve launched a new feature for pro users - colors.]]></description>
            <content:encoded><![CDATA[<p>As part of our recent colossal release, we’ve launched a new feature for pro users - <a href="/statelyai-docs/docs/colors">colors</a>. With this feature, you can add a layer of visual distinction to your statecharts, making them more organized, informative, and accessible for your team to understand.</p><p><img src="/blog/2023-07-24-improving-your-flows-with-color/choosing-colors.png" alt="State machine showing how to choose colors from the color palette, and the colors for default (grey in darkmode, white in lightmode), pink, purple, red, orange, yellow, green, and blue states and transitions." class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/2023-07-24-improving-your-flows-with-color/choosing-colors-dm.png" alt="State machine showing how to choose colors from the color palette, and the colors for default (grey in darkmode, white in lightmode), pink, purple, red, orange, yellow, green, and blue states and transitions." class="themedImage_ToTc themedImage--dark_i4oU"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-can-i-use-colors-in-stately">How can I use colors in Stately?<a href="#how-can-i-use-colors-in-stately" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You can assign colors from the palette menu to different states and transitions in your flows. You can choose from various color options, including pink, purple, red, orange, yellow, green, and blue. You can also reset a state or transition back to the default color; gray in dark mode and white in light mode.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-use-colors">Why use colors?<a href="#why-use-colors" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Many folks requested colors for their state machines, not just because colors make everything prettier! The bigger a machine gets, the more you want to distinguish or draw attention to particular states or transitions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="color-coding-groups-or-types-of-states-or-events">Color coding groups or types of states or events<a href="#color-coding-groups-or-types-of-states-or-events" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>One common use is to connect color to a meaning, such as making error states red and success states green. You could set transition colors to identify a common target, shared source, or group states and transitions meaningfully for your team.</p><iframe loading="lazy" src="https://stately.ai/registry/editor/embed/7b5d60dc-94b0-4a1e-9ade-ea644b8cc35f?machineId=8b2c257c-2060-45a5-bdb1-e91b7f5c9318&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/7b5d60dc-94b0-4a1e-9ade-ea644b8cc35f?machineId=8b2c257c-2060-45a5-bdb1-e91b7f5c9318">View the <em>Editor page machine</em> machine in Stately Studio</a>.</iframe><p>The machine above uses yellow for user events, purple for system events, and red for errors.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="organize-flows-into-regions-with-distinct-colors">Organize flows into regions with distinct colors<a href="#organize-flows-into-regions-with-distinct-colors" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Some other ways to use color are to use different colors to highlight different user personas or stories or mark popular paths through your app based on usage data.</p><iframe loading="lazy" src="https://stately.ai/registry/editor/embed/7b5d60dc-94b0-4a1e-9ade-ea644b8cc35f?machineId=35d9c021-9b00-4c6f-85c9-1f2fece5d0c5&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/7b5d60dc-94b0-4a1e-9ade-ea644b8cc35f?machineId=35d9c021-9b00-4c6f-85c9-1f2fece5d0c5">View the <em></em> machine in Stately Studio</a>.</iframe><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-color-for-fun">Use color for fun!<a href="#use-color-for-fun" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Or maybe you want to use color for fun. You can use color to decorate your flows to fit your brand or decorate your states and transitions.</p><iframe loading="lazy" src="https://stately.ai/registry/editor/embed/7b5d60dc-94b0-4a1e-9ade-ea644b8cc35f?machineId=e35f9079-722e-4812-8103-e63ada46456f&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/7b5d60dc-94b0-4a1e-9ade-ea644b8cc35f?machineId=e35f9079-722e-4812-8103-e63ada46456f">View the <em>Traffic light machine</em> machine in Stately Studio</a>.</iframe><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use-colors-in-your-flows">How to use colors in your flows<a href="#how-to-use-colors-in-your-flows" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Read more about <a href="/statelyai-docs/docs/colors">adding colors</a> and <a href="/statelyai-docs/docs/upgrade">upgrading to a Pro account</a> in our docs.</p><p>If you want to explain your color coding, we’ve had success using an annotation box as a key to help others understand the meaning behind each color.</p><p><img src="/blog/2023-07-24-improving-your-flows-with-color/color-key.png" alt="State machine with red, yellow, and purple transitions, and an annotation containing a key with yellow for user events, purple for system events and red for errors." class="themedImage_ToTc themedImage--light_HNdA"><img src="/blog/2023-07-24-improving-your-flows-with-color/color-key-dm.png" alt="State machine with red, yellow, and purple transitions, and an annotation containing a key with yellow for user events, purple for system events and red for errors." class="themedImage_ToTc themedImage--dark_i4oU"></p><p>When using colors to convey information, it is essential to keep accessibility in mind. Not everyone perceives color the same way, and as many as 8% of men and 0.5% of women are color blind. Ensure your statecharts are inclusive by using color to emphasize or decorate your machines, and <a href="https://www.w3.org/WAI/WCAG21/Understanding/use-of-color.html" target="_blank" rel="noopener noreferrer">do not use color as the only way to convey information</a>.</p><p>To make your colored machines more accessible, add the color or symbolic name as a tag on your states and transitions, or include them in their descriptions.</p><iframe loading="lazy" src="https://stately.ai/registry/editor/embed/7b5d60dc-94b0-4a1e-9ade-ea644b8cc35f?machineId=9a62b8b1-b5a3-4b15-a5ed-acfe5f65da80&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/7b5d60dc-94b0-4a1e-9ade-ea644b8cc35f?machineId=9a62b8b1-b5a3-4b15-a5ed-acfe5f65da80">View the <em>Expense machine</em> machine in Stately Studio</a>.</iframe><p>Colors are a powerful feature that helps you improve your statecharts' organization, clarity, and user-friendliness. To learn more about using Colors, check out our <a href="/statelyai-docs/docs/colors">documentation</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-pro-features">More Pro features<a href="#more-pro-features" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Colors is one of many Pro features we've recently added to Stately. Our current Pro features include:</p><ul><li><a href="/statelyai-docs/docs/teams">Teams and shared projects</a></li><li><a href="/statelyai-docs/docs/projects#change-a-projects-visibility">Private and unlisted projects</a></li><li><a href="/statelyai-docs/docs/versions">Version history</a></li><li><a href="/statelyai-docs/docs/import-from-github">Import from GitHub</a></li><li><a href="/statelyai-docs/docs/live-simulation">Live simulation mode</a></li><li><a href="/statelyai-docs/docs/colors">Color states and transitions</a></li><li><a href="/statelyai-docs/docs/studio-pro-plan#priority-support">Priority support</a></li><li>GitHub Sync (coming soon!)</li><li>Workflows (coming soon!)</li><li>Live collaboration (coming soon!)</li></ul><p>And we've got many more coming soon! Want to suggest a feature? Leave a feature request on our feedback board or upvote other features we should prioritize.</p><p>Want to try the Pro plan? You can get a 30-day free trial when you <a href="/statelyai-docs/pricing">join from our website</a> or <a href="/statelyai-docs/docs/upgrade">upgrade</a> from <a href="https://state.new" target="_blank" rel="noopener noreferrer">the editor</a>.</p>]]></content:encoded>
            <category>stately studio</category>
            <category>state machines</category>
            <category>color</category>
            <category>pro features</category>
        </item>
        <item>
            <title><![CDATA[Export to Mermaid]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-07-20-export-to-mermaid</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-07-20-export-to-mermaid</guid>
            <pubDate>Thu, 20 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[You can now export your state machines to Mermaid code and diagrams!]]></description>
            <content:encoded><![CDATA[<p>You can now export your state machines to Mermaid code and diagrams! <a href="https://mermaid.js.org" target="_blank" rel="noopener noreferrer">Mermaid</a> is a JavaScript-based diagramming and charting tool that renders Markdown-inspired text definitions.</p><p><img loading="lazy" src="https://canny.io/images/6439446ea46c01d1ad1e8a65e6d922d4.png" alt="mermaid" class="img_ev3q"></p><p>Mermaid is a useful format because Mermaid diagrams are created using plain text and can be easily version-controlled and shared with others. <a href="https://docs.github.com/en/get-started/writing-on-github/working-with-advanced-formatting/creating-diagrams" target="_blank" rel="noopener noreferrer">GitHub supports Mermaid as an advanced format</a> for issues, discussions, pull requests, wikis, and Markdown files.</p><p>Find the <strong>Mermaid</strong> export in Stately from the dropdown menu in the <strong>Code</strong> panel. You can export as Mermaid-formatted code, preview the diagram, and copy an SVG.</p><p>The export to Mermaid feature is in beta. If you have any feedback, please <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">let us know on Discord</a>.</p>]]></content:encoded>
            <category>changelog</category>
            <category>pro</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[Stately Studio minor improvements]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-07-18-stately-studio-minor-improvements</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-07-18-stately-studio-minor-improvements</guid>
            <pubDate>Tue, 18 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[We launched a huge release last week, but we already have more for you! In the last week, we made the following bug fixes and improvements.]]></description>
            <content:encoded><![CDATA[<p>We launched a huge release last week, but we already have more for you! In the last week, we made the following bug fixes and improvements.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="autosave-for-pro-users">Autosave for Pro users<a href="#autosave-for-pro-users" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Machine versions are now automatically saved for Pro users every hour. Once created, these versions appear in the list of versions and function just like other versions, with the ability to view, restore, delete, etc. Users can toggle to filter auto-saved versions out of the version history list. A version is also auto-saved when the user’s browser window is closed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="filter-machines">Filter machines<a href="#filter-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Got a really long list of machines in your project? You can now filter these machines by name.</p><p><img loading="lazy" src="https://canny.io/images/7cd5b51ace3e563f7773e18d1f801b2e.gif" alt="Using the filter machines text input to find machines with export in their name." class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>Importing machines without names will no longer cause errors in Safari.</li><li>The zoom controls now slide out of the way of the Help drawer when it’s toggled open and closed.</li><li>The reset button now slides out of the way of the Help drawer when it’s toggled open and closed in Simulate mode.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>States are now exported in a predictable, intuitive order, regardless of the order you added them. Initial states will be first, and the order of states will tend to follow transitions, with the “furthest” states being last.</li><li>You will now be prompted to sign in when accessing features that require login.</li><li>Improved accessibility of dropdown menus.</li><li>An assortment of internal fixes and improvements.</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>pro</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[Supercharge the canvas]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/supercharge-the-canvas</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/supercharge-the-canvas</guid>
            <pubDate>Tue, 11 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Today we are excited to release an update to Stately that takes a huge step towards making complexity more manageable.]]></description>
            <content:encoded><![CDATA[<p>Today we are excited to release an update to Stately that takes a huge step toward making complexity more manageable.</p><ul><li>Bring color into your flows! 🌈</li><li>Design more logic directly on the canvas 📝</li><li>Interact with effects (like entry actions and invoked actors) as visual blocks 🧩</li><li>Understand complex flows with a refined statechart design 🔥</li><li>Hide the UI to focus on your content 🎧</li><li>Improved transition routing ↵</li><li>Use tags, action parameters, and many XState actions in the Studio 💪</li><li>Export to XState v5 beta 🚚</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="making-complexity-manageable">Making complexity manageable<a href="#making-complexity-manageable" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We believe that making logic explicit using state machines, statecharts, and other visual flows can bring huge benefits like:</p><ul><li>Improving collaboration through a shared understanding.</li><li>Tapping into our innate visual processing capacities with a spatial format.</li><li>Streamlining product creation by helping to sync effort across teams, platforms, and workflows.</li><li>Generating code, tests, documentation, and other artifacts.</li></ul><p>But much of what we build is complex. And when we represent it visually, the result can itself be complex.</p><p>One of our goals at Stately is to make this inherent complexity you face more manageable. We want to help you simplify where possible, automate when useful, and elevate your thinking and communication.</p><p>Today we are launching an updated design for Stately Studio’s visual canvas that lays a foundation we will build on over the next wave of releases.</p><p><img loading="lazy" alt="A flow in Stately Studio for a video player which can be toggled between Mini and Full states. The states and transitions are colored." src="/statelyai-docs/assets/images/making-complexity-manageable-b2d1601c60897b62d0efa3c69d684355.png" width="1200" height="701" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-from-the-canvas-to-stay-in-the-flow">Create from the canvas to stay in the flow<a href="#create-from-the-canvas-to-stay-in-the-flow" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You can now do much more work on the canvas itself.</p><p>Being able to stay on the canvas keeps you closer to your content, lets interactions be more intuitive, can help you stay focused, and can even give you more room to work.</p><p>For example, we enhanced the Edit Menu to support adding <a href="/statelyai-docs/docs/actions#using-actions-in-stately-studio">actions</a>, tags, and other data to <a href="/statelyai-docs/docs/states#using-states-in-stately-studio">states</a> and <a href="/statelyai-docs/docs/transitions#using-transitions-and-events-in-stately-studio">transitions</a>. And most items on the canvas can then be edited directly.</p><video src="https://ascelcgzufjyvdzuplwo.supabase.co/storage/v1/object/public/videos/create-from-canvas.mp4" width="720" controls="" preload="metadata" poster="https://ascelcgzufjyvdzuplwo.supabase.co/storage/v1/object/public/videos/create-from-canvas-poster.png"><p><a href="https://youtube.com/watch?v=ck9uGikxJ8k" target="_blank" rel="noopener noreferrer">Watch this video on YouTube.</a></p></video><h2 class="anchor anchorWithStickyNavbar_LWe7" id="effect-blocks-make-it-easy-to-say-what-happens-when">Effect blocks make it easy to say what happens when<a href="#effect-blocks-make-it-easy-to-say-what-happens-when" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Statecharts are great for modeling how a process goes from state to state when an event occurs. This is especially powerful since you can also make things happen by having effects run at specific times.</p><p>The most important addition we’ve made with this release is that effects (<a href="/statelyai-docs/docs/invoke#using-invoked-actors-in-stately-studio">invoked actors</a>, entry actions, and exit actions) are now interactive. They are represented as blocks on the canvas that can be placed inside states and transitions.</p><p>This will make it easy to define, understand, and modify your app’s behavior as users step through your flow.</p><p><img loading="lazy" alt="An OnboardPatient state machine with XState assign actions on multiple transitions, and actors being invoked from multiple states." src="/statelyai-docs/assets/images/effect-blocks-make-it-ebcc4e5434798c764bf87fd581edfc85.png" width="1733" height="589" class="img_ev3q"></p><p>Effect blocks are editable, can be copied, and handle standard keyboard interactions, just as you’d expect. And rumor is, soon you’ll be able to drag them around, enhancing your codebase with a new spatial dimension. Imagine changing when a JavaScript function is called simply by dragging it to a new place in the flow. 🤫</p><p>Speaking of upcoming features, if you follow <a href="https://youtube.com/statelyai/?source=blog" target="_blank" rel="noopener noreferrer">our live streams</a>, you’ve already seen <a href="https://www.youtube.com/live/FY030no59Y4?feature=share&amp;t=1876" target="_blank" rel="noopener noreferrer">a preview of writing code inside the Studio using the new effect blocks</a>. But we decided to take this functionality even further before releasing it, so stay tuned!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="streamlined-visualization-makes-complex-flows-easier-to-understand">Streamlined visualization makes complex flows easier to understand<a href="#streamlined-visualization-makes-complex-flows-easier-to-understand" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>One bit of feedback we consistently get is that statecharts are helpful, but that sometimes it can be difficult to understand what’s happening when a lot of content is visible at once. We also think it’s important that even non-technical contributors be able to use statecharts to build and understand their products.</p><p>So we’ve turned over every aspect of how statecharts are represented on the canvas, trying to figure out how to balance the need to show a dense variety of information in a way that is not overwhelming.</p><p>One change is that the name of the state is now a header, and most of the other data on it (tags, <a href="/statelyai-docs/docs/descriptions">description</a>, effects, and so on) are grouped together as part of a new detail section.</p><p><img loading="lazy" alt="A MissingItem state with a bold yellow background. The state also has an exception tag, a description, entry action, and invoked actors. These are all displayed under the MissingItem state heading on a lighter background." src="/statelyai-docs/assets/images/streamlined-viz-1-0829caba1bc4c6595280d24a3ba60acb.png" width="696" height="375" class="img_ev3q"></p><p>This means that when you first open the flow, it’s easy to focus on the state names for a quick overview of how they are connected. Then when you want more detail, you can narrow your attention to what interests you.</p><p>We’ve also heard feedback that sometimes it can be hard to tell a state from a transition. One reason is that with Stately, unlike other diagramming tools, transitions can have many of the same properties as states (such as actions and descriptions). This gives a powerful option for modeling but can introduce challenges with ambiguity. We mitigated this, however, by adopting a style where states “pop out” while transitions “blend in”.</p><p><img loading="lazy" alt="States have stronger colored more opaque backgrounds and less rounded corners. Events and transitions have more of a rounded pill shape with translucent backgrounds." src="/statelyai-docs/assets/images/streamlined-viz-2-8082821393fdd3cfea26a9683c7df55e.png" width="1073" height="409" class="img_ev3q"></p><p>Effect blocks, on the other hand, have the same style no matter where they are placed since their location simply says when they are executed. This consistency makes it easy for contributors with various backgrounds to intuitively understand “what happens”.</p><p>And you may notice many other small and not-so-small details. For example, a chunky border around each level in the hierarchy gives a new sectioned-off look. This will be useful in the future as we add support for more dynamic views.</p><p><img loading="lazy" alt="The root state and parent state in this flow both have chunky borders that are colored purple to match their state. The child states are a solid color without a border." src="/statelyai-docs/assets/images/streamlined-viz-3-aaff0e0feb26d871ede6b37abcb19e96.png" width="952" height="846" class="img_ev3q"></p><p>And one principle we used to guide us was that, because statecharts already involve so many boxes and arrows, any sharply defined line should be significant for the flow. That means we generally looked for other solutions for separating sections.</p><p>We think we’ve built something that will increasingly be able to support however you want to use Stately, smoothly growing from casual brainstorming sessions to business-critical production actor systems filled with multi-leveled machines.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="translucency-reduces-ambiguities">Translucency reduces ambiguities<a href="#translucency-reduces-ambiguities" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Another part of the improved design is translucency. Because Stately handles the complex, nonlinear flows often required when building apps, it is not always possible to lay out your logic in a nice straight line. This means that arrows can go underneath other items, making the content difficult to read. Also, when working on a canvas, sometimes it’s nice to casually toss items into overlapping piles as your work comes together. But statecharts can get pretty detailed! And this means sometimes states can cover each other up, and it’s hard to even tell anything is underneath.</p><p>That’s why we made some canvas elements translucent by default, including state details and transition labels.</p><p>It's still usually better to avoid overlapping content. And to help content not overlap in the first place, we've also enhanced transition routing.</p><p>But with translucency flows should be easier to follow when it happens.</p><p><img loading="lazy" alt="A translucent onDone transition means the transition lines running underneath it are still visible." src="/statelyai-docs/assets/images/translucency-f84377326437d358ffd2383a27e9fc4e.png" width="1030" height="586" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hide-the-ui-to-work-without-distraction">Hide the UI to work without distraction<a href="#hide-the-ui-to-work-without-distraction" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>For when you just want to focus on the content, we’ve added a way to hide the Stately UI, including the header bar, side panels, and canvas controls.</p><p>Try hiding the UI from the Stately menu in the top left of the editor, or just press <code>⌘</code> + <code>.</code> to toggle it instantly. We also support <code>⌘</code> + <code>\</code> for the same behavior if you prefer using that shortcut.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-more-of-xstates-power-inside-the-stately-studio">Get more of XState’s power inside the Stately Studio<a href="#get-more-of-xstates-power-inside-the-stately-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We are continuing to bring more of XState into the visual Studio.</p><p>Tags are now supported in the Studio to help you categorize different state nodes. For example, you can add a “loading” tag to each state representing loading data.</p><p>And the Studio now supports action parameters and several categories of <a href="/statelyai-docs/docs/xstate-v4/xstate/actions/built-in-actions">actions that are built into XState</a>:</p><ul><li>assign</li><li>raise</li><li>log</li><li>sendTo</li><li>stop</li></ul><p>You can <a href="/statelyai-docs/docs/xstate-v4/xstate/actions">learn more about tags and the actions built into XState in our documentation</a>.</p><p>Also, you can try exporting your machines to XState v5 beta. Note that support for importing from v5 beta is coming soon.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="design-in-color">Design in color<a href="#design-in-color" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Finally, we have an enthusiastic community, and one request we’ve heard again and again was the need for color in flows.</p><p>Color is finally here! 🌈</p><p>And it doesn’t just look pretty. There are so many ways that color can help you. For example, you can try:</p><ul><li>Setting transition colors to help identify a common target</li><li>Setting transition colors to show a shared source</li><li>Connect a color to a meaning, such as making error states red</li><li>Organize flows into regions with distinct colors</li><li>Use different colors for different user personas or stories</li><li>Mark popular paths with colors based on usage data</li></ul><p><img loading="lazy" alt="Swatches of red, orange, yellow, green, blues, purple, and pink." src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABkAAAABgBAMAAAC3XqOYAAAAGFBMVEXUMy3xhiL4tjIpgztDq98PbuVcMbnPJJskoUtiAAAAzUlEQVR4AWJkoAMQHKJ2jNoxagcTA6B9OhAAAAAAEORvPcjlECAICAKCgCAgCAgCgoAgIAggCAgCgoAgIAgIAoKAICAICAIIAoKAICAICAKCgCAgCAgCCAKCgCAgCAgCgoAgIAgIAoIAgoAgIAgIAoKAICAICAKCAIKAICAICAKCgCAgCAgCgoAggCAgCAgCgoAgIAgIAoKAIIAgIAgIAoKAICAICAKCgCAgCCAICAKCgCAgCAgCgoAgIAgIAggCgoAgIAgIAoKAICAI7ATFXQE3gqdhyQAAAABJRU5ErkJggg==" width="1600" height="96" class="img_ev3q"></p><p>We think you’ll find that color is especially useful when building with others, such as collaborating with team members or presenting to clients. It provides a nice way to convey new layers of meaning. And a colorful image makes the modeling that Stately supports more appealing for non-developers, getting everyone on board and building an attractive bridge between different audiences.</p><p>Because color will be used in diagrams in dynamic and varied ways, we implemented our approach using a perceptually uniform color space. This means that no matter which color you choose, in light mode or dark mode, you don’t have to worry about contrast changes affecting legibility. This is because all colors in any group are perceived as being the same lightness.</p><p>Set a color by selecting a state or transition and choosing the one you want from the Edit Menu above it. You can set colors separately on states and on transitions. Effect blocks and other attached details inherit their color.</p><video src="https://ascelcgzufjyvdzuplwo.supabase.co/storage/v1/object/public/videos/colors-2.mp4" width="720" controls="" preload="metadata" poster="https://ascelcgzufjyvdzuplwo.supabase.co/storage/v1/object/public/videos/create-from-canvas-poster.png"><p><a href="https://youtube.com/watch?v=Yiij2FaGSd0" target="_blank" rel="noopener noreferrer">Watch this video on YouTube.</a></p></video><p>Colors are just for Pro subscribers. So if you haven’t signed up yet, <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">try it out with a free 30-day trial</a>!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="try-out-stately-now">Try out Stately now<a href="#try-out-stately-now" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>With the improved design and new functionality, Stately is even more useful for teams throughout the entire product lifecycle. But this is still just the start of what we’ve been working on this year.</p><p><a href="https://stately.ai" target="_blank" rel="noopener noreferrer">Stately is free to try, so check it out</a>. We’re sure you’ll find many ways it can help you. And if there is anything you would love to see added, please <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">join our Discord community</a> or <a href="mailto:support@stately.ai" target="_blank" rel="noopener noreferrer">reach out directly</a> and let us know!</p>]]></content:encoded>
            <category>canvas</category>
            <category>stately studio</category>
        </item>
        <item>
            <title><![CDATA[New webinar: Intro to Stately Studio and state machines]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/intro-to-stately-studio-webinar</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/intro-to-stately-studio-webinar</guid>
            <pubDate>Wed, 05 Jul 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Join Anders and Laura for a tour of Stately Studio and an introduction to state machines featuring the next release of Stately Studio.]]></description>
            <content:encoded><![CDATA[<p>Last week Anders and I hosted <a href="https://www.youtube.com/watch?v=u_ZU253mH-g" target="_blank" rel="noopener noreferrer">a webinar introducing Stately Studio and state machines</a>. The webinar was a special one, as we previewed the supercharged new editor design which is coming very soon!</p><p>Watch the whole webinar below, or <a href="#chapters">use the chapters to jump to each section</a>.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="chapters">Chapters<a href="#chapters" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=0s" target="_blank" rel="noopener noreferrer">0:00 Intro</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=70s" target="_blank" rel="noopener noreferrer">1:10 Why state machines?</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=180s" target="_blank" rel="noopener noreferrer">3:00 Tour of Stately’s starter machine</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=267s" target="_blank" rel="noopener noreferrer">4:27 State machine basics: modeling a dog walk</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=492s" target="_blank" rel="noopener noreferrer">8:12 Discovering public machines</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=586s" target="_blank" rel="noopener noreferrer">9:46 Forking machines</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=677s" target="_blank" rel="noopener noreferrer">11:17 Annotations</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=769s" target="_blank" rel="noopener noreferrer">12:49 Adding images and descriptions</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=892s" target="_blank" rel="noopener noreferrer">14:52 Filter machines in a project with search</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=915s" target="_blank" rel="noopener noreferrer">15:15 Creating a new machine</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=955s" target="_blank" rel="noopener noreferrer">15:55 Self-transitions</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=1040s" target="_blank" rel="noopener noreferrer">17:20 Eventless (always) transitions</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=1083s" target="_blank" rel="noopener noreferrer">18:03 Delayed (after) transitions</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=1333s" target="_blank" rel="noopener noreferrer">22:13 Entry and exit actions</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=1370s" target="_blank" rel="noopener noreferrer">22:50 Invoking actors</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=1442s" target="_blank" rel="noopener noreferrer">24:02 Simulating machines</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=1570s" target="_blank" rel="noopener noreferrer">26:10 Light and dark mode</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=1680s" target="_blank" rel="noopener noreferrer">28:00 Upgrade to a Pro subscription</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=1811s" target="_blank" rel="noopener noreferrer">30:11 Colors</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=1852s" target="_blank" rel="noopener noreferrer">30:52 Private and unlisted machines</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=1940s" target="_blank" rel="noopener noreferrer">32:20 Versions</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=2008s" target="_blank" rel="noopener noreferrer">33:28 Live simulation</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=2101s" target="_blank" rel="noopener noreferrer">35:01 Guard condition</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=2162s" target="_blank" rel="noopener noreferrer">36:02 More on colors</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=2216s" target="_blank" rel="noopener noreferrer">36:56 Import from GitHub</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=2349s" target="_blank" rel="noopener noreferrer">39:09 Teams</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=2558s" target="_blank" rel="noopener noreferrer">42:38 Export to code</a></li><li><a href="https://youtube.com/watch?v=u_ZU253mH-g&amp;t=2619s" target="_blank" rel="noopener noreferrer">43:39 Wrap up</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="links-and-resources">Links and resources<a href="#links-and-resources" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li><a href="https://stately.ai/docs" target="_blank" rel="noopener noreferrer">Stately docs</a></li><li><a href="https://state.new" target="_blank" rel="noopener noreferrer">Create your own state machine</a></li><li><a href="https://stately.ai/docs/state-machines-and-statecharts" target="_blank" rel="noopener noreferrer">Introduction to state machines and statecharts</a></li><li><a href="https://stately.ai/docs/annotations" target="_blank" rel="noopener noreferrer">Annotations</a></li><li><a href="https://stately.ai/docs/descriptions" target="_blank" rel="noopener noreferrer">Descriptions</a></li><li><a href="https://feedback.stately.ai/changelog" target="_blank" rel="noopener noreferrer">Changelog</a></li><li><a href="https://feedback.stately.ai" target="_blank" rel="noopener noreferrer">Request features</a></li><li><a href="https://feedback.stately.ai/editor/p/stately-studio-xstate-v5-compatibility" target="_blank" rel="noopener noreferrer">Upvote and track support for XState V5 beta in Stately Studio</a></li><li><a href="https://stately.ai/docs/migration" target="_blank" rel="noopener noreferrer">Migration guide for XState V4 - XState V5</a></li></ul>]]></content:encoded>
            <category>stately studio</category>
            <category>state machines</category>
        </item>
        <item>
            <title><![CDATA[25 new server-side workflow examples]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/serverside-workflow-examples</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/serverside-workflow-examples</guid>
            <pubDate>Tue, 20 Jun 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[We’ve added 25 new server-side workflows examples for XState V5, from simple state machines to more complex workflows.]]></description>
            <content:encoded><![CDATA[<p>As part of helping make learning about state machines, the actor model, and XState easier, we’ve been working hard on creating examples for the community. One of the most frequently requested examples has been server-side workflows. And now they’re here! We’ve got 25 new examples specifically for this purpose in the <a href="https://github.com/statelyai/xstate/tree/next/examples" target="_blank" rel="noopener noreferrer">XState GitHub repo</a>.</p><p>Based on the <a href="https://github.com/serverlessworkflow/specification/tree/main" target="_blank" rel="noopener noreferrer">CNCF Serverless workflow specification</a>, these examples showcase the power and versatility of <a href="/statelyai-docs/blog/announcing-xstate-v5-beta">XState v5</a> when it comes to server-side workflows. These examples cover many use cases, from simple state machines to more complex workflows. Whether you are new to XState or an experienced user, we hope you’ll find these examples useful.</p><ul><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-hello" target="_blank" rel="noopener noreferrer">Hello world workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-greeting" target="_blank" rel="noopener noreferrer">Greeting workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-event-greeting" target="_blank" rel="noopener noreferrer">Event-based greeting workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-math-problem" target="_blank" rel="noopener noreferrer">Solving math problems example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-parallel" target="_blank" rel="noopener noreferrer">Parallel execution workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-async-function" target="_blank" rel="noopener noreferrer">Async function invocation workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-async-subflow" target="_blank" rel="noopener noreferrer">Async subflow invocation workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-event-based" target="_blank" rel="noopener noreferrer">Event-based transitions workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-applicant-request" target="_blank" rel="noopener noreferrer">Applicant request decision workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-provision-orders" target="_blank" rel="noopener noreferrer">Provision orders (error handling) workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-monitor-job" target="_blank" rel="noopener noreferrer">Monitor job for completion (polling) workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-send-cloudevent" target="_blank" rel="noopener noreferrer">Send CloudEvent on workflow completion example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-monitor-patient" target="_blank" rel="noopener noreferrer">Monitor patient vital signs workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-finalize-college-app" target="_blank" rel="noopener noreferrer">Finalize college application workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-credit-check" target="_blank" rel="noopener noreferrer">Perform customer credit check workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-car-auction-bids" target="_blank" rel="noopener noreferrer">Handle car auction bids (scheduled start) workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-check-inbox" target="_blank" rel="noopener noreferrer">Check inbox periodically (cron-based workflow start) example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-event-based-service" target="_blank" rel="noopener noreferrer">Event-based service workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-reusing-functions" target="_blank" rel="noopener noreferrer">Reusing function and event definitions workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-new-patient-onboarding" target="_blank" rel="noopener noreferrer">New patient onboarding (error checking and retries) workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-purchase-order-deadline" target="_blank" rel="noopener noreferrer">Purchase order deadline (ExecTimeout) workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-accumulate-room-readings" target="_blank" rel="noopener noreferrer">Accumulate room readings and create timely reports (ExecTimeout and KeepActive) workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-car-vitals" target="_blank" rel="noopener noreferrer">Car vitals checks (SubFlow Repeat) workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-book-lending" target="_blank" rel="noopener noreferrer">Book lending workflow example</a></li><li><a href="https://github.com/statelyai/xstate/tree/next/examples/workflow-filling-water" target="_blank" rel="noopener noreferrer">Filling a glass of water workflow example</a></li></ul><p>Have you any examples to add? Check out <a href="https://github.com/statelyai/xstate/blob/next/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">our contribution guidelines</a>; we’d love your pull request! If you have any questions or want to chat about these examples, please <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">join our Discord</a>. Our team and community will be happy to help.</p>]]></content:encoded>
            <category>xstate</category>
            <category>xstate v5</category>
            <category>examples</category>
            <category>workflow</category>
            <category>serverside</category>
        </item>
        <item>
            <title><![CDATA[Stately Studio minor improvements]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-06-14-stately-studio-minor-improvements</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-06-14-stately-studio-minor-improvements</guid>
            <pubDate>Wed, 14 Jun 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[In the last week, we made the following bug fixes and improvements.]]></description>
            <content:encoded><![CDATA[<p>In the last week, we made the following bug fixes and improvements.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>Annotations will no longer cause validation warnings and errors when exporting machines.</li><li>You can no longer create annotations or access autolayout from embedded mode. The embedded mode will also no longer show a banner when a new version of Stately Studio is available.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>You can no longer simulate a machine that has errors. So fix those errors before you head over to Simulate mode!</li><li>You can now resize the left sidebar to an even smaller width.</li><li>Viewing somebody else’s machine in Discovery will no longer show a banner telling you the machine is view-only.</li><li>The meta value field now auto-resizes to fit the content.</li><li>An array of internal fixes and improvements.</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[What is the actor model and when should I use it?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/what-is-the-actor-model</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/what-is-the-actor-model</guid>
            <pubDate>Tue, 30 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[At Stately, the Actor Model is one of our favorite programming paradigms, and we think it’s for good reason!]]></description>
            <content:encoded><![CDATA[<p>At Stately, the <a href="https://en.wikipedia.org/wiki/Actor_model" target="_blank" rel="noopener noreferrer">Actor Model</a> is one of our favorite programming paradigms, and we think it’s for good reason! The actor model allows developers to build reliable message-based systems by using <em>actors</em> to communicate. This works extremely well with state machines and statecharts, which can also be modeled as actors and can communicate much in the same ways. Read on to learn what the actor model is, the problems it seeks to solve, and how you can use it in your projects to communicate reliably across different entities.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-actor-model">What is the actor model?<a href="#what-is-the-actor-model" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The actor model has been around for quite a while, dating back to the 1970’s. That it’s used with frameworks like <a href="https://akka.io/" target="_blank" rel="noopener noreferrer">Akka</a> and built natively into languages like <a href="https://www.erlang.org/" target="_blank" rel="noopener noreferrer">Erlang</a> are testaments to its utility. When researching the actor model, it’s very common to see the phrase “everything is an actor”, as it is a core tenet in the actor model philosophy. This simply means that in a given system, the <em>actor</em> is the core unit of execution. Every action that occurs in the system is driven by an actor. An actor can communicate with other actors with the use of messaging, and they can also interact with external systems. Specifically, an actor can perform the following basic tasks:</p><ul><li>Actors can manage their own internal state</li><li>Actors can spawn other actors</li><li>Actors can send messages to other actors</li></ul><p>It may sound simple, but this programming model allows for the development of highly scalable and concurrent systems. There are constraints though, the most important of which is that an actor <em>cannot</em> modify the internal state of another actor directly. This can be done implicitly with messaging (i.e an actor updating its state in response to a message) but <em>never directly</em>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="when-should-i-use-it">When should I use it?<a href="#when-should-i-use-it" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The actor model is extremely useful for splitting up work that can be processed in parallel. It’s excellent for <a href="https://java-design-patterns.com/patterns/fanout-fanin/" target="_blank" rel="noopener noreferrer">“fan-out/fan-in”</a> scenarios where several functions need to be run at once and have their results combined before final processing. It also works well with building <a href="https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern" target="_blank" rel="noopener noreferrer">pub/sub</a> systems, where several actors can be “workers”, waiting for messages from the “publisher”. Our last example, but certainly not the least, is in the case of systems that need to manage several similar entities, like a multiplayer game where every player is represented as an actor. A good rule of thumb is to at least consider the actor model whenever distribution and concurrency are core requirements.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="when-not-to-use-it">When not to use it<a href="#when-not-to-use-it" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>As with any pattern, it’s just as important to understand its weaknesses as it is to understand its strengths. Typically you may not want to use the actor pattern when order really matters. Order is usually not promised in the actor pattern, and if one of the actors fails, you’ll have to deal with the concern of rolling back events. The actor model is often unnecessary when dealing with synchronous problems as well and can add unnecessary overhead. Additionally, error handling can be tricky with actors. Erlang popularized the “let it crash” philosophy, but given the problem, it may not always be the most reasonable answer.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-xstate-work-with-the-actor-model">How does XState work with the actor model?<a href="#how-does-xstate-work-with-the-actor-model" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>With XState, we expose the ability to create instances of machines as actors! Looking at the example below, we can see that after defining our machine and its attributes, we only need to use <code>interpret()</code> to instantiate an actor (called <code>toggleActor</code>) and send it messages.</p><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> interpret </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'xstate'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// State machine definition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> toggleMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'toggle'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'inactive'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inactive</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'active'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    active</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'inactive'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Machine instance with internal state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> toggleActor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">toggleMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">toggleActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">subscribe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token builtin" style="color:rgb(0, 112, 193)">console</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">toggleActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// =&gt; logs 'inactive'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">toggleActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'TOGGLE'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// =&gt; logs 'active'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">toggleActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'TOGGLE'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// =&gt; logs 'inactive'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This actor has its own state and context, and it can be updated whenever it receives events. Of course, in order for the internal state of an actor to be updated, the event must be a legal transition defined with the machine.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="spawning-actors">Spawning Actors<a href="#spawning-actors" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>XState can also be used to spawn other actors and communicate with each other:</p><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> spawn </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'xstate'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> todoMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'./todoMachine'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> todosMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string-property property">'NEW_TODO.ADD'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">todos</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">todos</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            todo</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">todo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// add a new todoMachine actor with a unique name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            ref</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">todoMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token template-string string" style="color:rgb(163, 21, 21)">todo-</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(4, 81, 165)">${</span><span class="token template-string interpolation">event</span><span class="token template-string interpolation punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token template-string interpolation">id</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With the use of <code>spawn()</code> and <code>assign()</code>, we create a new actor instance when provided the machine logic and a unique identifier.
By their nature, actions are <a href="/statelyai-docs/docs/xstate-v4/xstate/actions">"fire and forget" effects</a>, meaning they are executed with no expectation of receiving events back to the actor. This makes sense for creating a new actor, but we may still want the parent actor to have a reference to its child, so we save that in its context using <code>assign()</code>. <code>spawn()</code> is the function called that actually creates the new actor. The parent can access this state easily by calling <code>getSnapshot()</code> on the reference to the child.</p><p>For more detailed examples around working with actors in XState, like callback or promised-based actor spawning, sending updates, and communicating between actors, <a href="/statelyai-docs/docs/xstate-v4/actions-and-actors/actors">check out our docs on actors</a>.</p>]]></content:encoded>
            <category>actor model</category>
            <category>modeling</category>
            <category>statechart</category>
            <category>tutorials</category>
            <category>state machine</category>
            <category>typescript</category>
            <category>blog</category>
        </item>
        <item>
            <title><![CDATA[Stately Studio minor improvements]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-05-26-stately-studio-minor-improvements</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-05-26-stately-studio-minor-improvements</guid>
            <pubDate>Fri, 26 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[In the last week, we made the following bug fixes and improvements.]]></description>
            <content:encoded><![CDATA[<p>In the last week, we made the following bug fixes and improvements.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>Live simulation mode is now stopped when you switch machines.</li><li>The child state of a new parallel state will no longer be marked as the initial state.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li>The editor menu is now available when in version view mode.</li><li>Meta values now support multi-line text input.</li><li>Improved the layout of the starter machine at state.new.</li><li>Improved accessibility of the left drawer toggle.</li><li>Improved accessibility of the Discovery search and filters.</li><li>A variety of internal fixes and improvements.</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>improved</category>
            <category>fixed</category>
        </item>
        <item>
            <title><![CDATA[Announcing XState v5 beta]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/announcing-xstate-v5-beta</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/announcing-xstate-v5-beta</guid>
            <pubDate>Thu, 25 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[We’re excited to announce the beta release of XState v5 and related packages after many years of development.]]></description>
            <content:encoded><![CDATA[<p>We’re excited to announce the v5 beta release of XState and related packages after many years of development.<!-- --> XState is a powerful, fully open-source (MIT-licensed) and zero-dependency state management &amp; orchestration solution based on state machines, statecharts, and the actor model. It is currently being used in production by many companies for both frontend and backend applications.</p><p><strong>XState orchestrates any logic</strong>, from promises to state machines and everything in between.</p><p>You can try out XState v5 beta today by installing <code>xstate@beta</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> xstate@beta</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Note:</strong> XState v5 beta support in XState tools such as typegen, the visual inspector, and Stately Studio is still in progress. We appreciate your patience as we work to ensure full compatibility with XState v4 and v5 in all of the XState/Stately tools. For more information, see the <a href="#in-progress">list of items in progress</a>.</p><p>Over the past few years, we have collected a wealth of valuable feedback from the community regarding features they would like to see. These include ways to gradually adopt XState within their team and reduce the learning curve. We have responded by adding numerous new features and improvements that address these desires. Let’s dive in and explore them!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="flattening-the-learning-curve">Flattening the learning curve<a href="#flattening-the-learning-curve" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>One of the biggest items of feedback we’ve received about XState is that although it is powerful, there is a substantial learning curve. There are some <del>new</del> old concepts to learn with XState, such as the actor model, state machines, and statecharts. With these concepts comes new terminology. In XState v5 beta and <a href="https://stately.ai/docs/xstate-v5" target="_blank" rel="noopener noreferrer">the documentation</a>, we have made a concerted effort to make XState as approachable as possible, and to reduce the learning curve as much as possible. Here are some of the changes we’ve made:</p><ul><li><strong>Simplified terminology</strong>. Concepts shouldn’t have multiple names, so we have simplified terms wherever possible. The basic unit of abstraction in XState v5 beta is the <strong>actor</strong>, and we’ve removed some of the more confusing terms, such as “service” and “interpreter,” “transient transitions” to “eventless transitions,” “cond” to “guard", “internal: false” to “reenter: true,” and <a href="https://stately.ai/docs/migration" target="_blank" rel="noopener noreferrer">more</a>.</li><li><strong>Reduced API surface area</strong>. Some of the new features, such as <a href="#actor-input">input</a> made existing features redundant, such as <code>machine.withContext(...)</code>. We’ve also removed redundant functionality, such as <code>actor.onTransition(...)</code>, in favor of <code>actor.subscribe(...)</code>. <a href="https://stately.ai/docs/migration" target="_blank" rel="noopener noreferrer">Read about all the breaking changes</a>.</li><li><strong>Examples, examples, examples</strong>. We’re adding many <a href="https://github.com/statelyai/xstate/tree/next/examples" target="_blank" rel="noopener noreferrer">XState v5 beta examples in the XState repository’s examples folder</a> to help you quickly understand how XState can help with your use cases.</li><li><strong>Interactive documentation</strong>. We’re working on adding interactive examples to the documentation, so you can visualize the concepts as you learn them.</li><li><strong>From zero to “hello world” as quickly as possible</strong>. Our goal with XState v5 and the <a href="https://stately.ai/docs/xstate-v5" target="_blank" rel="noopener noreferrer">updated documentation (work in progress)</a> is to make developers productive with XState quickly. A simple, complete counter example in XState looks like this:</li></ul><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> assign </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'xstate'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> counterMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'counter'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    count</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    increment</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">count</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">count </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    decrement</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">count</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">count </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> counterActor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">counterMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">counterActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">subscribe</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">console</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">counterActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">counterActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'increment'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// logs 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">counterActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'increment'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// logs 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">counterActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'decrement'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// logs 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This functionality is already capable of meeting the majority of state management needs for most applications. If you require more advanced use cases, have no fear - XState v5 beta has got you covered.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="actor-first-approach-for-any-logic">Actor-first approach for any logic<a href="#actor-first-approach-for-any-logic" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Actors are now first-class citizens. In v4, you could invoke/spawn promises, callbacks, observables, and other state machines, but these were special-cased, and you could only <code>interpret()</code> machines. In v5, you can invoke/spawn <em>anything</em>; actors can be created from any type of logic, which can be invoked, spawned, or even interpreted:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  fromPromise</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  fromTransition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  fromObservable</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  fromEventObservable</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  fromCallback</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'xstate'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> interval</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> fromEvent </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'rxjs'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Promise logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> promiseLogic </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fromPromise</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'https://api.example.com/users'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Transition logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> transitionLogic </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fromTransition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">type </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'increment'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> count</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">count </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">type </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'decrement'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> count</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">count </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> count</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Observable logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> observableLogic </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fromObservable</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">interval</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Event observable logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> eventObservableLogic </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fromEventObservable</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">fromEvent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'resize'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Callback logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> callbackLogic </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fromCallback</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> sendBack </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">handler</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">ev</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">sendBack</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">ev</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">addEventListener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'resize'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> handler</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">removeEventListener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'resize'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> handler</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Invoke any logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> callbackLogic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Spawn any logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    event</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">promiseRef</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> spawn </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">promiseLogic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> actor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">actor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The composable building block to this is “actor logic,” which is an object consisting of <code>.transition(...)</code>, <code>.getInitialState(...)</code>, and <code>.getSnapshot()</code> methods, among other useful properties and methods. XState v5 beta provides the following actor logic creators:</p><ul><li><code>createMachine(machineDef)</code>: useful for more complex state machine/statechart logic; can spawn/invoke actors and declaratively handle effects</li><li><code>fromTransition(fn, initialState)</code>: useful for basic reducer-like state management, similar to Redux, Zustand, Pinia, NgRx, etc.</li><li><code>fromPromise(promiseFn)</code>: useful for async/await promise-based logic</li><li><code>fromCallback(fn)</code>: useful for subscription-based or other free-form logic that can send events back to the parent actor</li><li><code>fromObservable(observableFn)</code>: useful for subscribing to an observable stream of values</li><li><code>fromEventObservable(observableFn)</code>: useful for subscribing to an observable stream of events</li></ul><p>With this new actor logic abstraction, it is now possible to create your own actor logic for any use-case; imagine <code>fromWebSocket(...)</code>, <code>fromQuery(...)</code>, and <code>fromWebWorker(...)</code> logic creator functions. Furthermore, higher-order actor functions can be made that bring additional functionality to actors, such as <code>withUndoRedo(actorLogic)</code> or <code>withLocalStoragePersistence(actorLogic)</code>. We’re still writing documentation and examples of these new patterns, so keep on the lookout for them.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deep-persistence">Deep persistence<a href="#deep-persistence" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Actor persistence is a pattern where the internal state of an actor can be persisted and restored at any time. In XState v4, machines can invoke/spawn actors, but those child actors are not persisted. In XState v5 beta, actors are now deeply (recursively) persisted. Invoked/spawned actors will be persisted, as well as actors invoked/spawned from those actors, and so on.</p><p>In the following example, the state of the <code>mainActor</code> will be persisted, as well as the state of the invoked <code>someCounter</code> actor. When the <code>restoredActor</code> is started, it will start at the persisted state of <code>mainActor</code>, which includes the persisted state of <code>someCounter</code>:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'counter'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'someCounter'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> mainActor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">mainActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Deeply persist state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Also persists the "someCounter" actor!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> persistedState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> mainActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">getPersistedState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Restore state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> restoredActor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  state</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> persistedState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Starts at recursively persisted state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">restoredActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is useful for both client-side (e.g. handling page refreshes) and server-side (e.g. persisting workflow state) use cases. Customizing persistence/restoration logic for actors is also possible, and we will document those options soon.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="actor-system">Actor system<a href="#actor-system" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>As actors can spawn other actors, which in turn can spawn other actors, these connected actors form a natural hierarchy. This collection of connected actors is known as an actor system.</p><p>In XState v5 beta, calling <code>interpret(...)</code> to create a root actor will also create an implicit actor system. This enables a key feature called the <strong>receptionist pattern</strong>. The receptionist pattern means actors can be registered and looked up by their <code>systemId</code>, which is useful for actors that need to communicate with each other but don’t directly know about each other (i.e., actors not in a parent-child relationship).</p><p>For example, let’s say you have a <code>checkoutMachine</code> that orchestrates the state of an online shop. If you want a notifier actor to be available to any machines spawned anywhere within the <code>checkoutMachine</code> system, you can register it by providing a <code>systemId</code>:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> notifierMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'../notifierMachine'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> shippingMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'../shippingMachine'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> checkoutMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> notifierMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    systemId</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'notifier'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    shipping</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> shippingMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> checkoutActor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">checkoutMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">checkoutActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, any actor within the <code>checkoutActor</code> system can access the notifier actor by calling <code>system.get("notifier")</code>:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> shippingMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string-property property">'address.updated'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sendTo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> system </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> system</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">get</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'notifier'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'notify'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        message</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'Shipping address updated'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The implicit system and receptionist pattern make it much easier to model arbitrary actor-to-actor communication, event buses, and other event-driven patterns.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="actor-input">Actor input<a href="#actor-input" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In some cases where you want to specify initial “input data” for actors. Providing that input data in XState v4 was not easy. You had to either:</p><ul><li>Create a factory machine function that took in some input data and returned a machine with that input data in context.</li><li>Create a new machine with <code>machine.withContext(...)</code> and pass the entire context with the input data inside.</li></ul><p>Since only the machine should initially determine <code>context</code>, this was not ideal, as it was possible to initialize a machine at some impossible state. Additionally, you may want to consider some <code>context</code> properties <em>private</em> (internal to the machine) and not externally configurable.</p><p>In XState v5 beta, you can now provide input data to machines by passing it as the second argument to <code>interpret(machine, { input })</code>. This input data can be read by machines in the <code>context</code> initialization function:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> greetingMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> input </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    greeting</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token template-string string" style="color:rgb(163, 21, 21)">Hello, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(4, 81, 165)">${</span><span class="token template-string interpolation">input</span><span class="token template-string interpolation punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token template-string interpolation">name</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token template-string string" style="color:rgb(163, 21, 21)">!</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> greetingActor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">greetingMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  input</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    name</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'David'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Furthermore, this works for any actor logic, not just state machines:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> promiseLogic </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fromPromise</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> input </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token template-string string" style="color:rgb(163, 21, 21)">https://api.example.com/users/</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(4, 81, 165)">${</span><span class="token template-string interpolation">input</span><span class="token template-string interpolation punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token template-string interpolation">id</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">res</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">json</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> promiseActor </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">promiseLogic</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  input</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">42</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="unified-arguments">Unified arguments<a href="#unified-arguments" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>The crowd has spoken. Most of you wanted a unified arguments object for all implementation functions. Implementation functions previously took multiple arguments, making it hard to remember which argument to use or awkward to ignore certain arguments. In XState v5 beta, all implementation functions now take a single unified argument object, which contains <code>context</code>, <code>event</code>, and other properties relevant to the implementation function:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    count</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    increment</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// Single argument, instead of:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// guard: (_, event) =&gt; ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">guard</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain">Number</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">isNaN</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// Single argument, instead of:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// actions: (context, event) =&gt; ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token builtin" style="color:rgb(0, 112, 193)">console</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="self-reference">Self reference<a href="#self-reference" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In the unified argument object, there is a <code>self</code> property that references the actor itself. This enables new, flexible patterns for actor communication, as you can pass this <code>self</code> reference to other actors in events:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> pingMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'pong'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'pong'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ping</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sendTo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'pong'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> self </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'ping'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sender</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> self </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> pongMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    ping</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">sendTo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'pong'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="higher-order-guards">Higher-order guards<a href="#higher-order-guards" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In XState v4, guards were simple functions on the <code>.cond</code> transition property that returned <code>true</code> or <code>false</code> to determine if a transition would be taken. To negate a guard or combine guards, you had to create a new guard, which resulted in duplication or redundant code. In XState v5 beta, you can now use higher-order guards, which are functions that take in guards (referenced and/or inline) and return a guard function. There are 3 built-in higher-order guard functions: <code>and([...guards])</code>, <code>or([...guards])</code>, and <code>not(guard)</code>:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> and</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> not </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'xstate'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> userMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      doSomething</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// Higher-order guard</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// Renamed from "cond" (v4) -&gt; "guard" (v5)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        guard</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">and</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">'isAuthenticated'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'isAdmin'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">not</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'isBanned'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    guards</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">isAuthenticated</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">user </span><span class="token operator" style="color:rgb(0, 0, 0)">!==</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">undefined</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">isAdmin</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">role </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'admin'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">isBanned</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">status </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'banned'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>These higher-order guards can be combined in many different ways to express any complex condition. In the future, Stately visual tooling will be able to visualize complex conditional logic expressed in guards.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="predictable-events-and-actions">Predictable events and actions<a href="#predictable-events-and-actions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In XState v4, actions and events had nuanced default behavior: <code>assign(...)</code> actions were prioritized over other actions, which made action order less predictable. Additionally, events were <em>nullified</em> when going through eventless transitions, making it difficult to reference data from the original event. The <code>predictableActionArguments: true</code> flag was a necessary workaround for this. In XState v5 beta, actions are always executed in order, and events are always preserved, even when going through eventless transitions. No need for flags ⛳️:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">const machine = createMachine({</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> // ...</span><br></span><span class="token-line" style="color:#000000"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> // Action order is now predictable by default</span><br></span><span class="token-line" style="color:#000000"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:rgb(163, 21, 21)">-</span><span class="token deleted-sign deleted line" style="color:rgb(163, 21, 21)"> predictableActionArguments: true,</span><br></span><span class="token-line" style="color:#000000"><span class="token deleted-sign deleted line" style="color:rgb(163, 21, 21)"></span><span class="token plain">})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="partial-event-descriptors">Partial event descriptors<a href="#partial-event-descriptors" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Partial event descriptors, also known as <em>partial wildcards</em>, are a powerful new feature in XState v5 beta that makes it easier to handle groups of events. In XState v4, you could use wildcards to handle any event that wasn’t matched by any other transition, but you had to be careful not to handle events that you didn’t intend to handle accidentally. In XState v5 beta, you can use partial event descriptors to handle groups of events by placing a wildcard after the delimiter (<code>.*</code>), and you can be explicit about which events you want to handle:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Will handle any event that starts with "pointer.":</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// "pointer.down", "pointer.up", "pointer.move", etc.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string-property property">'pointer.*'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'logPointerEvent'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><a href="https://codesandbox.io/p/sandbox/github/statelyai/xstate/tree/next/examples/todomvc-react" target="_blank" rel="noopener noreferrer">Check out the TodoMVC example with React, TypeScript, and XState v5 beta</a>.</p><p>For more examples, <a href="https://github.com/statelyai/xstate/tree/next/examples" target="_blank" rel="noopener noreferrer">visit the <code>/examples</code> directory in the XState repository</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="migration-and-breaking-changes">Migration and breaking changes<a href="#migration-and-breaking-changes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>As with any major version, there are some breaking changes. We’ve tried to keep these to a minimum, but some are necessary to make XState v5 beta as powerful and flexible as possible. <a href="https://stately.ai/docs/migration" target="_blank" rel="noopener noreferrer">Read our current guide for migrating from XState v4 to v5 and the list of breaking changes</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="in-progress">In progress<a href="#in-progress" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>XState v5 beta API is mostly stabilized, and there is still much work for us to do now we’ve reached this milestone. We are working on the following:</p><ul><li>Type safety is a priority. We are working on using the latest TypeScript features to make XState v5 beta as type-safe as possible. This includes better type inference for as many parts of the machine as possible, including <code>context</code>, events, guards, actions, finite state values, and more. For everything that cannot be inferred or specified, we are updating <a href="https://stately.ai/docs/xstate/typescript/typegen" target="_blank" rel="noopener noreferrer">XState Typegen</a> to generate accurate TypeScript types for your machines. And yes, we’re still figuring out typestates.</li><li>We will update the <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.vscode-xstate" target="_blank" rel="noopener noreferrer">XState VS Code extension</a> to support XState v5 beta.</li><li>We will also update <a href="https://stately.ai/editor" target="_blank" rel="noopener noreferrer">Stately Studio</a> to support importing/exporting XState v5 machines and provide visual tooling for the new features in XState v5 beta, such as machine input/output, partial events, higher-order guards, and more.</li><li>We’re making the inspector protocol and <code>@xstate/inspect</code> much more flexible to support XState v5 beta and beyond (even other state management libraries).</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stately-studio">Stately Studio<a href="#stately-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Speaking of Stately Studio, besides adding support for XState v5, we’re taking the “everything is an actor” support to heart. We will be building visual tooling for not just managing actor logic (state machines &amp; statecharts) but also visualization of entire actor systems (architecture diagrams) and the communication between actors (sequence diagrams). This will be a huge step forward for visually understanding and debugging complex systems, and we’re excited to share more about this in the future.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="we-hope-you-enjoy-xstate-v5-beta">We hope you enjoy XState v5 beta!<a href="#we-hope-you-enjoy-xstate-v5-beta" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’re excited to see what you build with it (I know everyone says this, but we truly mean it). If you have any questions, feel free to reach out to us on <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">Discord</a> or <a href="https://twitter.com/statelyai" target="_blank" rel="noopener noreferrer">Twitter</a>.</p>]]></content:encoded>
            <category>xstate</category>
            <category>xstate v5</category>
            <category>announcement</category>
            <category>beta</category>
        </item>
        <item>
            <title><![CDATA[Context-aware search in the docs]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-05-19-context-aware-search</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-05-19-context-aware-search</guid>
            <pubDate>Fri, 19 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[The search results in the Stately Studio and XState docs are now context-aware. ]]></description>
            <content:encoded><![CDATA[<p>The search results in the <a href="https://stately.ai/docs" target="_blank" rel="noopener noreferrer">Stately Studio and XState docs</a> are now context-aware. So if you’re browsing the current XState V4 version of the docs, you’ll get results for V4, and if you’re browsing the XState V5 beta version of the docs, you’ll get results for V5.</p><p><img loading="lazy" src="https://canny.io/images/0a39d4269b59a7a5268b9b85bf0a172a.png" alt="Side-by-side comparison of search results for cond in the Stately docs. In the V4 docs, it gives you results about combining cond and in. In the V5 docs, it gives you results telling you to use guard instead of cond." class="img_ev3q"></p><p>Thanks to Chev for bringing this up in <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">our Discord</a>, Tobi for suggesting the solution, and Anders for quickly implementing it! If you have any feedback about our docs, please let us know in our <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">#documentation channel in Discord</a>.</p>]]></content:encoded>
            <category>changelog</category>
            <category>new</category>
            <category>improved</category>
        </item>
        <item>
            <title><![CDATA[Explain your machines with annotations]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/explain-your-machines-with-annotations</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/explain-your-machines-with-annotations</guid>
            <pubDate>Thu, 18 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Sometimes you want to share a machine with descriptive details or comments, so we’ve added annotations to Stately Studio.]]></description>
            <content:encoded><![CDATA[<p>Sometimes you want to share a machine with descriptive details or comments, so we’ve added <a href="https://stately.ai/docs/annotations" target="_blank" rel="noopener noreferrer">annotations</a> to Stately Studio.</p><p>Unlike <a href="https://stately.ai/docs/descriptions" target="_blank" rel="noopener noreferrer">descriptions</a>, annotations are notes you can use to annotate your machine that only appear in Stately Studio’s editor. To add an annotation, right-click anywhere on the canvas to bring up the canvas menu and use <strong>Add annotation</strong> to add your annotation.</p><p><a href="https://stately.ai/registry/editor/embed/5b170468-d66a-4136-84c8-676c8fea82e8?machineId=7879be19-d267-4e75-9a7d-6a870d540257" target="_blank" rel="noopener noreferrer">Check out the dog walk machine below</a>, which I’ve annotated with notes describing the machine and how some of the states work.</p><iframe loading="lazy" src="https://stately.ai/registry/editor/embed/5b170468-d66a-4136-84c8-676c8fea82e8?machineId=7879be19-d267-4e75-9a7d-6a870d540257&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/5b170468-d66a-4136-84c8-676c8fea82e8?machineId=7879be19-d267-4e75-9a7d-6a870d540257">View the <em>Annotated dog walk machine</em> machine in Stately Studio</a>.</iframe><p><em>You can now also <a href="https://stately.ai/docs/embed" target="_blank" rel="noopener noreferrer">embed your machines anywhere <code>iframe</code>s are supported</a>!</em></p><p>Annotations are not exported when you <a href="https://stately.ai/docs/export-as-code" target="_blank" rel="noopener noreferrer">export your machine as code</a>, so you can add as many as you like without affecting your codebase!</p><p>Annotations are particularly useful when you’re sharing machines with your teams. <a href="https://stately.ai/docs/teams" target="_blank" rel="noopener noreferrer">Teams</a> are a pro feature of Stately Studio, where you can share and collaborate on your app logic. We offer a <strong>30-day free trial</strong> on the <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">Stately Studio Pro account</a> so you can explore how our Pro features work for you and your team.</p><p>We hope annotations make sharing a link to your machine even easier without additional supporting information or explanation. Try them out today and see how they can enhance your workflow!</p>]]></content:encoded>
            <category>stately</category>
            <category>studio</category>
            <category>annotations</category>
            <category>comments</category>
            <category>teams</category>
        </item>
        <item>
            <title><![CDATA[Stately Studio minor improvements]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-05-17-stately-studio-minor-improvements</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-05-17-stately-studio-minor-improvements</guid>
            <pubDate>Wed, 17 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Over the week, the Stately team made the following improvements.]]></description>
            <content:encoded><![CDATA[<p>Over the week we made the following improvements.</p><ul><li>When copy and pasting states and transitions, the pasted layout is now much improved. <a href="https://www.youtube.com/watch?v=fPrZ19EKlJU&amp;t=128s" target="_blank" rel="noopener noreferrer">Watch a demo of copy paste in last week’s office hours</a>.</li><li>The background of the <strong>Live simulation</strong> mode panel is now easier to read in light mode.</li><li>A whole range of internal minor improvements and fixes.</li></ul>]]></content:encoded>
            <category>changelog</category>
            <category>improved</category>
        </item>
        <item>
            <title><![CDATA[Watch in-depth demos in our Stately Streams]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/stately-streams-may-2023</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/stately-streams-may-2023</guid>
            <pubDate>Tue, 16 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Tomorrow is part four in our popular Stately Stream series, where we are modeling a semi-complex client-side application using XState, Stately Studio, React and TypeScript.]]></description>
            <content:encoded><![CDATA[<p><a href="https://www.youtube.com/watch?v=sigMw-Xelvw" target="_blank" rel="noopener noreferrer">Tomorrow is part four in our popular Stately Stream series</a>, where we are modeling a semi-complex client-side app using XState, Stately Studio, React and TypeScript. You can catch up on the previous videos in the series below or <a href="https://www.youtube.com/playlist?list=PLvWgkXBB3dd5UEJZCk4C3Wn1Ys8WRMDbi" target="_blank" rel="noopener noreferrer">watch all our past videos in our Stately Streams YouTube playlist</a>.</p><p>Across this series, David and I have been working on a canvas-based app project that showcases using statecharts for both components and globally accessible actors across an entire system, as well as multi-actor communication and state orchestration.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-1">Part 1<a href="#part-1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In part 1 we look at the power of using statecharts to model and implement a canvas-based app.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-2">Part 2<a href="#part-2" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In part 2, we look at implementing multiple selection, including collision detection and what you might need for live collaboration.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-3">Part 3<a href="#part-3" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In part 3, we migrate our code from XState V4 to <a href="https://stately.ai/docs/migration" target="_blank" rel="noopener noreferrer">XState V5</a>.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="watch-part-4-tomorrow-at-630-pm-et">Watch part 4 tomorrow at 6.30 PM ET<a href="#watch-part-4-tomorrow-at-630-pm-et" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Join us tomorrow at 6.30 PM ET on YouTube or <a href="https://www.linkedin.com/events/statelystream-modelingagraphica7064177817600581634/" target="_blank" rel="noopener noreferrer">LinkedIn</a> for our next live stream!</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>]]></content:encoded>
            <category>stately</category>
            <category>studio</category>
            <category>xstate</category>
            <category>xstate v5</category>
            <category>stately stream</category>
            <category>demo</category>
            <category>examples</category>
        </item>
        <item>
            <title><![CDATA[Watch our “best Stately office hours yet”]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/office-hours-64</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/office-hours-64</guid>
            <pubDate>Fri, 12 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Two weeks ago we had what some have called our “best office hours yet.” Watch the video to find out what’s coming soon to Stately Studio.]]></description>
            <content:encoded><![CDATA[<p>Two weeks ago, we had what some have called our “best office hours yet.” We introduced a whole bunch of new features and improvements to Stately Studio, including <a href="https://state.new?source=blog" target="_blank" rel="noopener noreferrer">state.new</a> with our new starter machine, annotations, embed mode, and version history. We also gave the first peek at our most significant editor update to date; we call it “codename: blocks,” check out the video to find out why!</p><p>We also talk about XState v5 being in beta (more on that soon!) and <a href="https://stately.ai/docs/migration" target="_blank" rel="noopener noreferrer">how to migrate from XState V4 to V5</a>.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><p>Watch the video to find out what’s coming soon to Stately Studio. Use the links below to jump straight to that chapter in the video:</p><ul><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=0s" target="_blank" rel="noopener noreferrer">0:00:00 Intro</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=10s" target="_blank" rel="noopener noreferrer">0:00:10 Team intros</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=122s" target="_blank" rel="noopener noreferrer">0:02:02 state.new 🆕</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=140s" target="_blank" rel="noopener noreferrer">0:02:20 New default machine</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=150s" target="_blank" rel="noopener noreferrer">0:02:30 Annotations 🆕</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=308s" target="_blank" rel="noopener noreferrer">0:05:08 Embed mode 🆕</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=647s" target="_blank" rel="noopener noreferrer">0:10:47 Version history 🆕</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=1171s" target="_blank" rel="noopener noreferrer">0:19:31 Deletion confirmation 🆕</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=1251s" target="_blank" rel="noopener noreferrer">0:20:51 Codename: blocks (coming soon)</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=1677s" target="_blank" rel="noopener noreferrer">0:27:57 Codename: blocks continued… colors! (coming soon)</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=1872s" target="_blank" rel="noopener noreferrer">0:31:12 Codename: blocks as machine options (coming soon)</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=2980s" target="_blank" rel="noopener noreferrer">0:49:40 XState v5 (in beta)</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=3222s" target="_blank" rel="noopener noreferrer">0:53:42 Use cases for XState in the backend</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=3329s" target="_blank" rel="noopener noreferrer">0:55:29 Changelog 🆕</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=3431s" target="_blank" rel="noopener noreferrer">0:57:11 Remote inspect via websockets</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=3529s" target="_blank" rel="noopener noreferrer">0:58:49 Detecting the version of XState you’re using</a></li><li><a href="https://www.youtube.com/watch?v=FY030no59Y4&amp;t=3578s" target="_blank" rel="noopener noreferrer">0:59:38 Wrap up</a></li></ul><p>You can join us for our <a href="https://www.youtube.com/watch?v=fPrZ19EKlJU" target="_blank" rel="noopener noreferrer">next office hours live today at 10 AM ET</a>. We’ll share more demos and take your questions live; we hope to see you there!</p>]]></content:encoded>
            <category>stately</category>
            <category>studio</category>
            <category>office hours</category>
            <category>starter machine</category>
            <category>annotations</category>
            <category>embed mode</category>
            <category>version history</category>
            <category>blocks</category>
            <category>xstate</category>
            <category>xstate v5</category>
            <category>changelog</category>
        </item>
        <item>
            <title><![CDATA[Everything new since Stately Studio 1.0!]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/everything-new-since-stately-studio-1-0</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/everything-new-since-stately-studio-1-0</guid>
            <pubDate>Thu, 04 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[It’s been more than six months since the release of Stately Studio 1.0, and we’ve been busy working on Stately Studio and XState. Here are some of the highlights.]]></description>
            <content:encoded><![CDATA[<p>It’s been more than six months since the release of Stately Studio 1.0, and we’ve been busy working on Stately Studio and XState. Here are some of the highlights:</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="version-history">Version History<a href="#version-history" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve added <a href="https://stately.ai/blog/2023-05-02-version-history" target="_blank" rel="noopener noreferrer">Version History</a> to Stately Studio, so you can easily track the changes made to your machines over time, whether you want to align your machines with versions in your codebase or record milestones for your machine. Version History is the first of our new features exclusively for <a href="https://stately.ai/docs/studio-pro-plan" target="_blank" rel="noopener noreferrer">Pro users</a>.</p><p><a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">Try out all these features with our 30-day free trial →</a></p><p><img loading="lazy" alt="Version History panel opened from the toolbox showing a current version selected and three older versions." src="/statelyai-docs/assets/images/2023-05-04-version-history-b8faca342663048e1945a3839106878d.png" width="1600" height="894" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="live-simulation-mode">Live Simulation Mode<a href="#live-simulation-mode" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Stately Studio now includes live simulation in Simulate mode. Share your machine URL with your team, and walkthrough your machine live! We’ve got big plans for more live features in the future.</p><p><a href="https://www.youtube.com/live/ysB2oKIig-k?feature=share&amp;t=2824" target="_blank" rel="noopener noreferrer">Watch a demo of Live Simulation Mode →</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="import-from-code">Import from Code<a href="#import-from-code" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Import from Code was one of our most-requested features from users who had already created machines using XState or our Stately Viz. You can now import an existing machine (or multiple machines!) from JavaScript, TypeScript or JSON using the code panel in the editor’s right tool menu or the Machines list in the left drawer.</p><p><a href="https://stately.ai/blog/2022-11-29-import-from-code" target="_blank" rel="noopener noreferrer">Read more about Import from Code →</a></p><p><img loading="lazy" alt="Code panel open in the Studio with the Import button highlighted." src="/statelyai-docs/assets/images/2023-05-04-import-from-code-1d44e8f59791fe168a92b8243a91fe3d.png" width="1310" height="440" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="import-from-github">Import from GitHub<a href="#import-from-github" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Users on our Pro plan can now also import machines from GitHub. You can import every machine in your repo or use the GitHub URL to import all machines in that file.</p><p><a href="https://www.youtube.com/watch?v=5OAxh0SG18Y" target="_blank" rel="noopener noreferrer">Watch Laura’s video on two ways to import machines from GitHub →</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="recovery-mode">Recovery Mode<a href="#recovery-mode" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Recovery Mode is one of those features we hope you never have to use. We now try to detect any missing connectivity or backend failure on our end while you’re editing your machines. We will let you know if a connectivity issue or other failure happens and start saving your work locally on your device. The next time you visit the Studio from that same device, we compare what we saved with the machine from the server. If the versions are different, we will give you the option to restore the saved copy to a new machine.</p><p><a href="https://stately.ai/blog/2022-12-22-machine-recovery" target="_blank" rel="noopener noreferrer">Read more about Recovery Mode →</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="xstate-vs-code-update">XState VS Code update<a href="#xstate-vs-code-update" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The XState VS Code extension has had a significant overhaul making it run much faster and giving it more accurate bi-directional editing between the code and visual editing modes. We’ve also added two much-requested features from our VS Code users; you can now use the XState VS Code extension without logging in and entirely offline.</p><p><a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">Get our XState VS Code extension →</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="all-new-docs">All-new docs<a href="#all-new-docs" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve finally launched our new Stately docs. We now have docs for Stately Studio and XState, with how-tos, tutorials, code examples, and much more. And yes, the new docs have dark mode!</p><p><a href="https://stately.ai/docs" target="_blank" rel="noopener noreferrer">Check out our new Stately docs →</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="editor-tutorials">Editor tutorials<a href="#editor-tutorials" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The editor now has several tutorials to help get you started, along with basic state machine and statechart concepts. You can access the tutorials from the blue question mark button in the lower right of the editor canvas or our new editor menu. Most tutorials also have an accompanying short video for those who like to learn visually.</p><p><a href="https://www.youtube.com/watch?v=Aixi0e53qAE&amp;list=PLvWgkXBB3dd4I_l-djWVU2UGPyBgKfnTQ" target="_blank" rel="noopener noreferrer">Watch the playlist of all the tutorial videos on YouTube →</a></p><p><img loading="lazy" alt="The editor menu with Tutorials selected, and the tutorials panel opened showing a tutorial for states." src="/statelyai-docs/assets/images/2023-05-04-tutorials-1a6e630b83806751aed1e46d2028e0de.png" width="1600" height="930" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-editor-menu">New editor menu<a href="#new-editor-menu" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The Stately editor now has a menu for quickly accessing your projects, machines, and frequently-used commands. The new menu is one of the most visible of the many small improvements we’re continuously making to Stately Studio.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="moving-machines">Moving machines<a href="#moving-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You can now quickly move machines between projects from the machines list menu. You can move your machines to your own projects or any projects you share with your teams.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pro-features-extended-to-all-team-members">Pro features extended to all team members<a href="#pro-features-extended-to-all-team-members" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Finally, we’re happy to announce that we’ve extended our pro features to all team members for their own projects, not just projects worked on as part of your team. Everyone with a seat on your team can now take advantage of new and upcoming features, including Import from GitHub, Version History, and Live Simulation Mode.</p><p><a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">Try all of Stately Studio’s Pro features with our 30-day free trial →</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-coming-very-soon">More coming very soon<a href="#more-coming-very-soon" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve got so much more to share with you soon. If you want to be the first to know about our new features, join us on <a href="https://www.youtube.com/c/statelyai" target="_blank" rel="noopener noreferrer">YouTube</a>, <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">Discord</a>, <a href="https://social.stately.ai/@stately" target="_blank" rel="noopener noreferrer">Mastodon</a>, <a href="https://www.linkedin.com/company/statelyai" target="_blank" rel="noopener noreferrer">LinkedIn</a>, or <a href="https://twitter.com/statelyai" target="_blank" rel="noopener noreferrer">Twitter</a>. Want to know what we’re working on before it’s released? Check out our <a href="https://www.youtube.com/watch?v=PfUIqTkDkfI&amp;list=PLvWgkXBB3dd6PXbSoctwDXjWX-AQrxhds" target="_blank" rel="noopener noreferrer">office hours</a>, live-streamed bi-weekly.</p>]]></content:encoded>
            <category>stately</category>
            <category>studio</category>
            <category>version histroy</category>
            <category>live simulation mode</category>
            <category>import</category>
            <category>github</category>
            <category>xstate</category>
            <category>extension</category>
            <category>docs</category>
        </item>
        <item>
            <title><![CDATA[Introducing ➡️ state . new]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-05-03-introducing-state-new</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-05-03-introducing-state-new</guid>
            <pubDate>Wed, 03 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[We’re making it even easier to create state diagrams with our new domain state.new.]]></description>
            <content:encoded><![CDATA[<p>Our top priority at Stately is to make it as easy as possible to create robust app logic in the form of state diagrams. That’s why we’re constantly striving to remove any potential barriers.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-the-problem">What’s the problem?<a href="#whats-the-problem" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>One barrier we’ve identified is; <strong>where to start when you want to create a state diagram?</strong> Well, as some of you might have noticed from David’s tweet the other day, we now have a solution for this.</p><p>We’re excited to share that generating a new diagram has never been easier. Simply input <a href="https://state.new" target="_blank" rel="noopener noreferrer"><code>state.new</code></a> into your browser, and you can edit your brand-new diagram immediately.</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p><em>By the way</em>, that tweet caused quite a splash. At this point in time it has over 1.5K likes and around 250K views. We also got a big spike of new users and are thrilled to have you!</p><p>State machines, charts and diagrams might be old, but luckily never go out of fashion!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-statenew">Why state.new?<a href="#why-statenew" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Sorry for being captain obvious here, but we think state.new is the perfect domain for creating a new state. A new state diagram, a new state machine, even a new state of mind, perhaps if you haven’t used machines and state diagrams for your app logic before. Give it a try, and let us know what you think.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-does-it-look-like">What does it look like?<a href="#what-does-it-look-like" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>When you land in the editor for the first time, you’ll find an example diagram to familiarize you with the concepts. You’re free to edit and delete this starting point to your liking. Notice that we have a little blue helper button in the bottom-right corner which you can click to <a href="/statelyai-docs/blog/2022-10-27-studio-tutorials">learn more about creating state diagrams</a>.</p><p><img loading="lazy" alt="Viewing the template state diagram in the Editor." src="/statelyai-docs/assets/images/state.new-starter-diagram-21e442241c5f97c0d302ac77a677309e.png" width="3096" height="2056" class="img_ev3q"></p><p>We can’t wait to see what you create!</p>]]></content:encoded>
            <category>stately</category>
            <category>studio</category>
            <category>state diagrams</category>
            <category>state charts</category>
            <category>state machines</category>
            <category>create</category>
        </item>
        <item>
            <title><![CDATA[Track changes as you work with Version History]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-05-02-version-history</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-05-02-version-history</guid>
            <pubDate>Tue, 02 May 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Version History is one of our most recent Pro features in Stately Studio. You can track changes to your work as you go.]]></description>
            <content:encoded><![CDATA[<p>Today we’re happy to introduce another pro feature for our Stately Studio subscribers; <strong>Version History</strong>. With this feature, you can save versions of your work as you go and refer back to them in the future. <!-- -->You can use those versions to compare changes, revert to a previous version, or even create a new machine from a version 🎉</p><p><img loading="lazy" alt="Viewing the past version of your machine in the Editor." src="/statelyai-docs/assets/images/2023-05-02-example-version-view-plain-a71d3a6459c96963dae96bbf4ba9bbcd.png" width="1480" height="962" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-use-version-history">Why use Version History?<a href="#why-use-version-history" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Version history allows you to save the current state of your machine as snapshots that you can go back to at a later time. This allows for a much more flexible way of working and evolving your machine.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="progressive-layers-of-detail">Progressive layers of detail<a href="#progressive-layers-of-detail" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>When you’re working on a machine, you often start with a high-level overview of the machine’s states and transitions and then gradually add more detail as you go. That detail could include adding actions, guards, nested states, markdown descriptions, and images. Version history allows you to save each of these layers of detail as a version so that you can refer back to them, much like commits in a version control system.</p><p><img loading="lazy" alt="Example of creating versions of your machine for different layers of detail." src="/statelyai-docs/assets/images/2023-05-02-example-why-layers-of-detail-f95f9a55d16cc4c46204a35cc7fd78cf.png" width="1480" height="962" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modeling-experiments">Modeling experiments<a href="#modeling-experiments" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>There are often many ways to model a system with statecharts, all of which are legitimate. Many decisions need to be made regarding state granularity, nesting, grouping or separating transitions and actions, context vs finite states, etc. Version history allows you to save each of these different versions so you can freely compare various approaches and be more experimental when modeling your software.</p><p><img loading="lazy" alt="Example of creating versions of your machine for experimenting with different modeling approaches." src="/statelyai-docs/assets/images/2023-05-02-example-why-modeling-experiments-5c6654f664944d212f1a96c90e20057b.png" width="1480" height="962" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-for-different-audiences">Creating for different audiences<a href="#creating-for-different-audiences" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>You can also use version history to create different versions of your machine for different audiences. For example, you might want to create a version of your machine that is more detailed for your team and a version that is more high-level for your stakeholders. This can be done by creating screenshots of versions or even by creating new machines from your versions.</p><p><img loading="lazy" alt="Example of creating versions of your machine intended for different audiences." src="/statelyai-docs/assets/images/2023-05-02-example-why-audiences-0e973746cc28beea124d197e07fd7c1f.png" width="1480" height="962" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="organization-and-alignment-with-other-versioning-systems">Organization and alignment with other versioning systems<a href="#organization-and-alignment-with-other-versioning-systems" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Version history is a great way to keep your work organized. Just as git commits encourage a more organized workflow, version history encourages you to save your work as you go. It’s very quick to save a version at any time while also convenient to edit a version name or even delete it later on.</p><p>Version history can also be used to sync up with semantic versioning of your application or with corresponding tickets in a tracking system. Any other versioning system can be mirrored in Stately Studio using this feature.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use-version-history">How to use Version History<a href="#how-to-use-version-history" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="version-history-panel">Version history panel<a href="#version-history-panel" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The version history panel is located on the right side of the editor. It shows a list of all the versions of your machine that you have saved. You can see the date and time of each version, as well as the author of the version.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="saving-a-version">Saving a version<a href="#saving-a-version" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>To save a version, click the <strong>+ Save</strong> button in the version history panel. A new version will be added to the top of the list. You can edit the version name or just keep the timestamp as the name.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="viewing-past-versions">Viewing past versions<a href="#viewing-past-versions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Clicking on a version in the list will show you the machine as it was at that point in time. You can still inspect properties of your machine along with canvas elements and you can switch between Design mode and Simulate mode to simulate this version of the machine.</p><p><img loading="lazy" alt="Viewing the past version of your machine in the Editor, indicating the features for working with that version." src="/statelyai-docs/assets/images/2023-05-02-example-version-view-explained-e95b4fcf2c87e7793f222d2d2cbb3681.png" width="1480" height="962" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="restoring-a-version">Restoring a Version<a href="#restoring-a-version" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The top header includes a button to <strong>Restore</strong> <!-- -->[1]<!-- --> the machine to this version. This will overwrite the current machine with the version you are viewing. However, you can undo that restoration using the Undo button to the bottom right of the canvas as you would with any other edit you make.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-new-machine-from-a-version">Creating a new machine from a version<a href="#creating-a-new-machine-from-a-version" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The Copy button <!-- -->[2]<!-- --> allows you to create a new machine (like a fork) from this version which will reside alongside the original machine within the same project.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="deleting-a-version">Deleting a Version<a href="#deleting-a-version" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The Delete button <!-- -->[3]<!-- --> will permanently delete the version and remove it from the list of versions.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="returning-to-the-current-version">Returning to the current version<a href="#returning-to-the-current-version" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>Clicking the Close button <!-- -->[4]<!-- --> in the header, clicking the <strong>Current version</strong> button <!-- -->[5]<!-- --> in the Version History panel, or pressing the Escape key will return you to the current version of the machine.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="restoring-a-version-from-the-version-list">Restoring a version from the version list<a href="#restoring-a-version-from-the-version-list" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>As an added convenience, you can also restore a version directly from the version list in the <strong>Version History</strong> panel without first viewing that version. To do this, click the Restore button to the right of the version you want to restore. This will overwrite the current machine with the version you selected but can be undone using the Undo button.
<img loading="lazy" alt="Restoring your machine to a past version from the versions list." src="/statelyai-docs/assets/images/2023-05-02-example-restore-from-version-list-f397397925d1d73d4b6e41923d18cd14.png" width="1480" height="572" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-and-sharing-versions-via-url">Accessing and sharing versions via URL<a href="#accessing-and-sharing-versions-via-url" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>When viewing a specific version, a unique URL is created so it is possible to copy and share that URL with others. Assuming the recipient has access to the machine, this URL will take them to that machine at the specific version.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="future-plans">Future plans<a href="#future-plans" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Saving versions of machines is a significant step in a larger effort to make the modeling experience in Stately Studio more robust and even more useful in software production. It will soon enable some exciting new features we are already building on top of versions. In the meantime, we are also thinking about more ways to create and interact with versions and we would love to hear your feedback on how you would like to use version history in your workflow!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="try-it-out">Try it out<a href="#try-it-out" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Version history is included with the <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">Pro subscription</a> to Stately Studio. If you’re not a Pro subscriber yet, you can still get started today with versioning your work by getting a 30-day free trial!</p>]]></content:encoded>
            <category>versions</category>
            <category>stately</category>
            <category>studio</category>
            <category>tutorial</category>
            <category>editor</category>
            <category>announcement</category>
            <category>modeling</category>
            <category>statechart</category>
        </item>
        <item>
            <title><![CDATA[New default machine]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-04-28-new-default-machine</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-04-28-new-default-machine</guid>
            <pubDate>Fri, 28 Apr 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[There’s now a more detailed default machine when you create a new machine in Stately Studio or jump straight into modeling at state.new.]]></description>
            <content:encoded><![CDATA[<p>There’s now a more detailed default machine when you create a new machine in Stately Studio or when you jump straight into modeling at state.new.</p><p><img loading="lazy" src="https://canny.io/images/362e27b65f13dfe7ce6979a91a5fdd6c.png" alt="Stately Studio machine featuring initial state, guards, parent and child states, and using descriptions." class="img_ev3q"></p><p>We hope this will help you get started and maybe learn more about features you’ve not used before.</p><p>If you don’t want any of these states and transitions in your new machine, you can drag to select all the unwanted features and hit backspace to delete them.</p><p>We’d love your thoughts about our new default machine; please <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">give us your feedback in our Discord!</a></p>]]></content:encoded>
            <category>changelog</category>
            <category>improved</category>
        </item>
        <item>
            <title><![CDATA[Embed URL]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-04-21-embed-url</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-04-21-embed-url</guid>
            <pubDate>Fri, 21 Apr 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[🤫 We’re testing a new feature where you can embed machines.]]></description>
            <content:encoded><![CDATA[<p>🤫 We’re testing a new feature where you can embed machines.</p><p>From the <strong>Share</strong> menu, there’s now a <strong>Copy embed URL</strong> button. You can use this URL in an <code>&lt;iframe&gt;</code> to embed your machine anywhere <code>&lt;iframe&gt;</code>s are allowed. We love to use embedded machines in our docs!</p><p><img loading="lazy" src="https://canny.io/images/d1135e463827ba77d2199971d2e7d1e9.png" alt="embed-url" class="img_ev3q"></p><p>We plan to add more to this feature in the future, and <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">we’d love to hear your feedback</a>.</p>]]></content:encoded>
            <category>changelog</category>
            <category>new</category>
            <category>beta</category>
        </item>
        <item>
            <title><![CDATA[Book a demo with the Stately team]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-04-03-book-a-demo</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-04-03-book-a-demo</guid>
            <pubDate>Mon, 03 Apr 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Are you looking to take your team collaboration to the next level? Do you want to explore the features of Stately and XState to their fullest potential? Then book a live demo with the Stately team!]]></description>
            <content:encoded><![CDATA[<p>Are you looking to take your team collaboration to the next level? Do you want to explore the features of Stately and XState to their fullest potential? Then <a href="https://calendly.com/d/yc8-3hq-rpc/request-a-demo" target="_blank" rel="noopener noreferrer">book a live demo with the Stately team</a>!</p><p>Our team is excited to give you a walkthrough of the Stately Studio and explore your use cases. During the demo, you can get answers to all your questions about Stately and XState. Learning more about you and your team will help us develop future features that benefit your work.</p><p>What can you expect from a live demo with the Stately team?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="walkthrough-of-the-stately-studio">Walkthrough of the Stately Studio<a href="#walkthrough-of-the-stately-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Get an in-depth tour of Stately’s visual editor and its features. Explore how the Stately Studio works for teams and learn how to build complex state machines quickly.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="explore-your-use-cases">Explore your use cases<a href="#explore-your-use-cases" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Our team will help you explore the Stately Studio’s features by walking you through your use cases. We can help you understand how Stately can be used to solve your specific problems and how you can integrate it into your workflow.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="answer-any-questions-you-have-about-stately-and-xstate">Answer any questions you have about Stately and XState<a href="#answer-any-questions-you-have-about-stately-and-xstate" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>During the demo, our team will answer your questions about Stately and XState. Whether you’re curious about a particular feature or want to know how Stately can help you solve a specific problem, our team will provide the answers you need.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="follow-up-demo-designed-for-your-team-and-use-cases">Follow-up demo designed for your team and use cases<a href="#follow-up-demo-designed-for-your-team-and-use-cases" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>After the demo, our team can work with you to schedule a follow-up demo that is designed specifically for your team and use cases. We will consider your feedback from the initial demo and create a customized demo that meets your specific needs.</p><section style="background-color:RGBA(144, 205, 244, .15);margin-block:16px;margin-inline:-16px;padding-inline:16px;padding-block:16px;margin-top:32px;display:flex;flex-direction:column;gap:5px;align-items:center"><p style="margin:0!important;text-align:left">Use the link below to book your live demo. We look forward to helping you build amazing applications with Stately and XState.</p><a style="justify-content:center;background-color:#0b6dff;transition:background-color 0.2s ease-in-out;padding:8px 16px;border-radius:8px;color:white;text-decoration:none;width:max-content" href="https://calendly.com/d/yc8-3hq-rpc/request-a-demo">Book a demo</a></section>]]></content:encoded>
            <category>stately</category>
            <category>studio</category>
            <category>demo</category>
            <category>xstate</category>
        </item>
        <item>
            <title><![CDATA[Import all machines from your GitHub repo]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-03-09-import-all-machines-from-github-repo</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-03-09-import-all-machines-from-github-repo</guid>
            <pubDate>Thu, 09 Mar 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Learn about a new pro feature in the Stately Studio; importing all your machines from a GitHub repo.]]></description>
            <content:encoded><![CDATA[<p>Last month, Anders showed you how you could <a href="/statelyai-docs/blog/2023-02-06-github-import-machines">import a machine from GitHub by changing the GitHub URL in the browser’s address bar</a>. We’ve added more to our GitHub integration. Our <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">Pro</a> users can now import all the machines from a repository into a Stately Studio project with the <strong>Import from GitHub</strong> button.</p><p><img loading="lazy" alt="Stately Studio My Projects page showing a list of projects. Above the list is an Import from GitHub button, alongside the Create project button." src="/statelyai-docs/assets/images/2023-03-09-import-all-machines-from-github-repo-button-794caa0cbac5c5e00149856de8b70cc3.png" width="1480" height="600" class="img_ev3q"></p><p>If you’ve been working with state machines in XState or using the <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">XState VS Code extension</a> to visualize your machines, this is a great way to import all the machines in your repo quickly. Once you’ve imported your machines into the Stately Studio, you can visualize and improve them in our Editor and easily share your machines with your team.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-import-all-the-machines-from-a-github-repository">How to import all the machines from a GitHub repository<a href="#how-to-import-all-the-machines-from-a-github-repository" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ol><li>Navigate to <strong>My Projects</strong> from the sidebar or the Stately menu.</li><li>Use <strong>Import from GitHub</strong> to open the Import repo from GitHub modal.</li><li>The GitHub integration will fetch all available repositories (public and private).</li><li>Choose the repository from which you wish to import machines.</li><li>The Studio will import your machines into a new private project using the same name as your repository and open your project in the Editor.</li></ol><p>Importing a machine with <strong>Import from GitHub</strong> or importing a machine with a GitHub URL will prompt you to <strong>Allow integration</strong> to give our GitHub integration access to your GitHub repositories. You will only be prompted if you have not yet given the GitHub integration access on your current device.</p><p>Currently, the <strong>Import from GitHub</strong> feature imports all machines from the <em>default branch</em> in your GitHub repository. If you want to import machines from a different branch or a pull request, we recommend <a href="/statelyai-docs/blog/2023-02-06-github-import-machines">importing each machine from a GitHub URL</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="try-our-pro-plan-to-import-from-github">Try our Pro plan to import from GitHub<a href="#try-our-pro-plan-to-import-from-github" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Import from GitHub is one of the <a href="https://stately.ai/docs/studio-pro-plan" target="_blank" rel="noopener noreferrer">Pro features</a> of the Stately Studio. We offer a <strong>30-day free trial</strong> on the <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">Stately Studio Pro account</a> so you can explore how our Pro features work for you and your team today!</p>]]></content:encoded>
            <category>stately</category>
            <category>studio</category>
            <category>integration</category>
            <category>github</category>
        </item>
        <item>
            <title><![CDATA[Import machines from GitHub]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-02-06-github-import-machines</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-02-06-github-import-machines</guid>
            <pubDate>Mon, 06 Feb 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Learn about a new pro feature in the Stately Studio; importing machines from GitHub.]]></description>
            <content:encoded><![CDATA[<p>Today we’re happy to introduce another pro feature for our Stately Studio subscribers; <strong>import machines from GitHub</strong>. With this feature, you can quickly visually machines in any of your GitHub repositories. You can even import the machines to the Studio and keep working on them here 🎉</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to">How to<a href="#how-to" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Importing a machine is easy. You open a file containing one or more machines on GitHub. Next, you modify the URL, replace <code>.com</code> with <code>.stately.ai</code>, and the import will start.</p><p><img loading="lazy" alt="Updating the URL on GitHub imports a machine into the Stately Studio." src="/statelyai-docs/assets/images/github-import-machine-095bef67cdb00ae6c8fa6823d7e66d3b.gif" width="1200" height="903" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>If you have a machine hosted at GitHub: <code>https://github.com/username/repo/blob/main/apps/superMachine.ts</code>, you update the URL to <code>https://github.stately.ai/username/repo/blob/main/apps/superMachine.ts</code> and the import will start 🚀</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="saving-the-machine">Saving the machine<a href="#saving-the-machine" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>You can easily save imported machines into a Studio project. After the import, you click the save button and choose a project for the machine.</p><p><img loading="lazy" alt="Saving a machine into a new project after a machine is imported into Stately Studio." src="/statelyai-docs/assets/images/github-save-machine-93108fef2cb9ed5202aac879651a951a.gif" width="1200" height="903" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-started">Get started<a href="#get-started" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>This feature requires the following prerequisites:</p><ul><li>A <strong>professional or enterprise</strong> subscription to the Stately Studio.</li><li>You must install the GitHub integration app.</li></ul><p>When importing a machine, we help you with both of those tasks.</p><p>Your GitHub token is stored on your own devices by design; we don’t save it in our database. This is to keep your data as safe as possible with the tradeoff being that you must accept the integration on the initial import for each device you use.</p><p>See this example where the GitHub integration gets installed during the initial import.</p><p><img loading="lazy" alt="The user is asked to install our GitHub integration during the initial import of a machine." src="/statelyai-docs/assets/images/github-save-machine-93108fef2cb9ed5202aac879651a951a.gif" width="1200" height="903" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="future-work">Future work<a href="#future-work" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We have much more planned for integrating with GitHub; this is just the start. Let us know what you think about the machine import and what GitHub integration features you would like to see in the Stately Studio.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bookmarklet-bonus">Bookmarklet bonus<a href="#bookmarklet-bonus" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>You can create a <a href="https://en.wikipedia.org/wiki/Bookmarklet" target="_blank" rel="noopener noreferrer">bookmarklet</a> if you want to make it extra easy to import machines from GitHub. You do this by adding a new bookmark and setting the web address to <code>javascript:(function(){ location.href = 'https://github.stately.ai/' + window.location.pathname;})();</code>. Now you can click the bookmarklet whenever you want to import a machine. The bookmarklet will work on any GitHub file containing one or more machines.</p>]]></content:encoded>
            <category>stately</category>
            <category>studio</category>
            <category>integration</category>
            <category>github</category>
        </item>
        <item>
            <title><![CDATA[Making state machines global in React]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-1-27-making-state-machines-global-in-react</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-1-27-making-state-machines-global-in-react</guid>
            <pubDate>Fri, 27 Jan 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Learn how to use the `createActorContext` function to make state machines global in React.]]></description>
            <content:encoded><![CDATA[<p>React developers often need to share state between components. While the <code>useMachine(...)</code> hook provides a convenient way to represent local state as a state machine, it’s not very feasible for shared or global state. Thankfully, <code>@xstate/react</code>’s <code>createActorContext(machine)</code> function, released in <code>@xstate/react@3.1.0</code>, is a convenient way to share state machines globally in any React application.</p><p>The <code>createActorContext(machine)</code> function returns a <a href="https://beta.reactjs.org/learn/passing-data-deeply-with-context" target="_blank" rel="noopener noreferrer">React Context object</a> that interprets the machine and makes the actor (interpreted machine) available through React Context. The object returned from <code>createActorContext(...)</code> has helper methods for accessing state and the actor ref. It takes one argument, <code>machine</code>, which is a state machine from <code>createMachine(...)</code> or a function that lazily returns a machine.</p><p><a href="https://www.youtube.com/watch?v=M6KjEogxfQE" target="_blank" rel="noopener noreferrer">▶️ Stately Stream: Simple React todo app with <code>createActorContext</code></a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-actor-context">Creating an actor context<a href="#creating-an-actor-context" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Here’s how you would create a React Context for an actor created from a machine and provide it in app scope:</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// ./App.tsx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token imports"> createActorContext </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token imports"> someMachine </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"../path/to/someMachine"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Create a React Context for the actor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token maybe-class-name">SomeMachineContext</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createActorContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">someMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">App</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Provide the actor context in app scope</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">SomeMachineContext.Provider</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">SomeComponent</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">SomeMachineContext.Provider</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This provider will make the actor available to any component that consumes it. You can also provide the actor context in any part of the component tree, such as a modal or a sidebar.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="consuming-the-actor-context">Consuming the actor context<a href="#consuming-the-actor-context" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>To consume the actor in a component, you can use the <code>useActor()</code> hook to get the <code>state</code> and <code>send</code> function, or you can use <code>useSelector(selector, compare?)</code> hook to derive a specific value from the snapshot:</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// ./SomeComponent.tsx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">SomeMachineContext</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"./App"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">SomeComponent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Read full snapshot and get `send` function from `useActor()`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token maybe-class-name">SomeMachineContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">useActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Or derive a specific value from the snapshot with `useSelector()`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> count </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token maybe-class-name">SomeMachineContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">useSelector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">div</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">p</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text">Count: </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">p</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">button</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript function" style="color:rgb(0, 0, 255)">send</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> type</span><span class="token tag script language-javascript operator" style="color:rgb(0, 0, 0)">:</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript string" style="color:rgb(163, 21, 21)">"INCREMENT"</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text">Increment</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">button</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">div</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As a reminder, the <code>useSelector(...)</code> hook is better when you want to control rerenders, as it will only rerender when the selected state changes.</p><p>If you only need the <code>actorRef</code>, which is a reference to the invoked actor, you can use the <code>useActorRef()</code> hook:</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">SomeMachineContext</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"./App"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">SomeComponent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> actorRef </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token maybe-class-name">SomeMachineContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">useActorRef</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">div</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">button</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> actorRef</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token tag script language-javascript method function property-access" style="color:rgb(0, 0, 255)">send</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> type</span><span class="token tag script language-javascript operator" style="color:rgb(0, 0, 0)">:</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript string" style="color:rgb(163, 21, 21)">"INCREMENT"</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">        Increment</span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">button</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">div</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="providing-custom-machines">Providing custom machines<a href="#providing-custom-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Lastly, if you need to provide implementation details to the machine, such as <code>actions</code>, <code>guards</code>, or <code>delays</code>, you can provide these options in the <code>options={...}</code> prop on the <code>Provider</code> component:</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">SomeMachineContext</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"../path/to/SomeMachineContext"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token imports"> someMachine </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"../path/to/someMachine"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">SomeComponent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token maybe-class-name">SomeMachineContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access maybe-class-name">Provider</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      options</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">doSomething</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ev</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">SomeOtherComponent</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">SomeMachineContext.Provider</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The <code>createActorContext(...)</code> function from <code>@xstate/react</code> is a convenient way to share state machines globally in any React application, or in any part of the component tree. It is available as of version <code>@xstate/react@3.1.0</code>. If you have any questions or feedback, please <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">let us know on Discord</a> to get help, ask questions, and give us your feedback.</p><p>Happy modeling!</p>]]></content:encoded>
            <category>react</category>
            <category>hook</category>
            <category>tutorial</category>
        </item>
        <item>
            <title><![CDATA[What’s new for Stately in 2023]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-01-20-whats-new-in-2023</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-01-20-whats-new-in-2023</guid>
            <pubDate>Fri, 20 Jan 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[Happy 2023! We thought we’d kick off the year with a reminder of all the features we’ve released since the Stately Studio 1.0 release in October.]]></description>
            <content:encoded><![CDATA[<p>Happy 2023! The Stately team is back from their <a href="https://twitter.com/statelyai/status/1615394794251096065" target="_blank" rel="noopener noreferrer">first off-site of the year in Lisbon</a> and excited to get started on our plans for this year. We thought we’d kick off the year with a reminder of all the features we’ve released since the <a href="https://stately.ai/blog/2022-10-18-introducing-stately-studio-1-0" target="_blank" rel="noopener noreferrer">Stately Studio 1.0 release</a> in October. It’s been just three months, and we already have so much to share.</p><p><img loading="lazy" alt="Jenny takes a selfie including the team all sitting at a long table in a room with stone and Portuguese tiled walls with laptops, coffees, and juices. David, Mateusz, Laura, Farzad, Anders, Kevin, and Gavin are all working, looking at the camera, or chatting to each other." src="/statelyai-docs/assets/images/2023-01-20-team-in-lisbon-33e5164e820af84a4a33cc10c32b83e3.png" width="1480" height="1057" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="import-from-code">Import from code<a href="#import-from-code" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><a href="https://stately.ai/blog/2022-11-29-import-from-code" target="_blank" rel="noopener noreferrer">Import from code</a> was one of our most-requested features from users who had already created machines using XState or our Stately Viz. You can import an existing machine from JavaScript, TypeScript or JSON using the code panel in the editor’s right tool menu or the Machines list in the left drawer. Import from code works well with our existing export as code feature, where you can export your machine as JSON, JavaScript, and TypeScript using the code panel in the right tool menu.</p><p><img loading="lazy" alt="Code panel open in the Studio with the Import button highlighted." src="/statelyai-docs/assets/images/2022-11-29-import-from-code-right-panel-7a96000b02bb5c33a15ac338d579aa30.png" width="1480" height="330" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="moving-machines">Moving machines<a href="#moving-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You can now quickly move machines between projects from the machines list menu. You can move your machines to your own projects or any projects you share with your teams. <a href="https://www.youtube.com/watch?v=MpbbgOQ9WAI&amp;t=709s" target="_blank" rel="noopener noreferrer">Watch Kevin demo moving machines</a> during our office hours in December last year.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="recovery-mode">Recovery mode<a href="#recovery-mode" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Recovery mode is one of those features we hope you never have to use. We now try to detect any missing connectivity or backend failure on our end while you’re editing your machines. We will let you know if a connectivity issue or other failure happens and start saving your work locally on your device. The next time you visit the Studio from that same device, we compare what we saved with the machine from the server. If the versions are different, we will give you the option to restore the safe copy to a new machine.</p><p><img loading="lazy" alt="The Stately Studio shows an option to restore changes made to a machine while the user was offline." src="/statelyai-docs/assets/images/recovery_restore_machine-aa9e3b86b54606936f314b196c6ae4bb.gif" width="800" height="492" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="editor-tutorials">Editor tutorials<a href="#editor-tutorials" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The editor now has several tutorials to help get you started, along with basic state machine and statechart concepts. You can access the tutorials from the blue question mark button in the lower right of the editor canvas. Most tutorials also have an accompanying short video for those who like to learn visually. You can <a href="https://www.youtube.com/watch?v=Aixi0e53qAE&amp;list=PLvWgkXBB3dd4I_l-djWVU2UGPyBgKfnTQ" target="_blank" rel="noopener noreferrer">watch the playlist of all the tutorial videos on YouTube</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="xstate-vs-code-update">XState VS Code update<a href="#xstate-vs-code-update" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The XState VS Code extension has had a significant overhaul making it run much faster and giving it more accurate bi-directional editing between the code and visual editing modes.</p><p><img loading="lazy" alt="XState VSCode extension installation page in VS Code." src="/statelyai-docs/assets/images/2023-01-20-xstate-vscode-dc03e606a5b235fb41f47d8ab6abe1eb.png" width="1480" height="560" class="img_ev3q"></p><p>We’ve also added two much-requested features from our VS Code users; you can now use the XState VS Code without logging in, and use the extension entirely offline.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="learn-more-with-the-stately-streams">Learn more with the Stately streams<a href="#learn-more-with-the-stately-streams" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you want to learn more about using the Stately Studio and XState, check out <a href="https://www.youtube.com/watch?v=25zL7hUOc1k&amp;list=PLvWgkXBB3dd5UEJZCk4C3Wn1Ys8WRMDbi" target="_blank" rel="noopener noreferrer">David and Farzad’s Stately streams</a>. These are a series of videos where David and Farzad work through modeling and coding features and best practices with state orchestration.</p><p><img loading="lazy" alt="Stately Streams video playlist on YouTube." src="/statelyai-docs/assets/images/2023-01-20-stately-streams-51148f318ca9f4e41836962f1a44f717.png" width="1480" height="388" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="docs">Docs<a href="#docs" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><a href="https://stately.ai/blog/2023-01-19-introducing-the-stately-docs" target="_blank" rel="noopener noreferrer">We’ve finally launched our new Stately docs</a>. We now have docs for the Stately Studio and XState, with how-tos, tutorials, code examples, and much more. And yes, the new docs have dark mode!</p><p><img loading="lazy" alt="Stately docs homepage." src="/statelyai-docs/assets/images/2023-01-19-docs-ff48ff14dcf9ff90ca018887f4b3613c.png" width="1480" height="844" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="even-more-in-the-studio">Even more in the Studio<a href="#even-more-in-the-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We continue making improvements to the Studio to improve your experience. We’ve improved how we track features in the Studio, enhancing your privacy by keeping our users entirely anonymous in our analytics. We now support Safari and hope to work on the touchscreen experience in the future. And we’ve also introduced dedicated support for our Pro subscription users, which has a 100% success and speedy response record so far!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="machine-metadata">Machine metadata<a href="#machine-metadata" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>We now support metadata for states and events for those who want to include static data in their machines. You can add your metadata as JSON key-value pairs at the end of the State details panel. The Studio will recognize and format your values as strings, numbers, or booleans; all metadata is included when you export your machines to code.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="read-only-mode">Read-only mode<a href="#read-only-mode" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>At the end of last year, we added a read-only mode to the editor. Previously when viewing a read-only machine, you’d be able to edit the machine even though the editor wouldn’t save your changes. Now, when checking out a read-only machine, you won’t be able to edit the machine, and you’ll see a banner explaining why you can’t make changes.</p><p><img loading="lazy" alt="A machine in the editor with a banner on top that says ‘This machine is read only. Changes will not be saved.’" src="/statelyai-docs/assets/images/2023-01-20-read-only-2d80854b195783eab11771c63daecbc2.png" width="1480" height="660" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="machine-images">Machine images<a href="#machine-images" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>You’ll love our new machine images if you’ve been looking for an easy way to share an overview of your machines on GitHub, Slack, Discord, or any other web platform. From the machines list menu, you can choose <strong>Copy image URL</strong> and use that URL anywhere you want to share your machine. The image will be live-updated when your machine is updated, so you don’t need to worry about your reference images going out of date. </p><p><img loading="lazy" alt="A machine image in both light and dark mode in the Stately docs." src="/statelyai-docs/assets/images/2023-01-20-machine-images-6d3587ae86fabf2cf78624316a65cb8b.png" width="1480" height="720" class="img_ev3q"></p><p>I’ve been using these images everywhere in our new docs, and you can see there that you can get light and dark mode versions of each image. The image URL copied to your clipboard will use the same mode you’re using in the Studio, but you can always change the mode by switching the .dark.png and .light.png suffixes in the URL. This feature is part of our work toward our GitHub integration, so look out for that coming soon!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="find-out-more">Find out more<a href="#find-out-more" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If all of that isn’t enough for you, you can catch up with <a href="https://www.youtube.com/watch?v=-uoEro1jsBI&amp;t=1916s" target="_blank" rel="noopener noreferrer">David’s wrap-up of 2022</a> and a <a href="https://www.youtube.com/watch?v=-uoEro1jsBI&amp;t=2140s" target="_blank" rel="noopener noreferrer">preview of what’s to come from Stately in 2023</a>. We can’t wait to share what we’re working on!</p>]]></content:encoded>
            <category>recovery</category>
            <category>restore</category>
            <category>offline</category>
            <category>editor</category>
            <category>studio</category>
        </item>
        <item>
            <title><![CDATA[Introducing the Stately docs]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2023-01-19-introducing-the-stately-docs</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2023-01-19-introducing-the-stately-docs</guid>
            <pubDate>Thu, 19 Jan 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[The time has finally come; our new docs are ready to share with you all. If you’ve been following our office hours, you know I’ve been talking about these docs for a long time…]]></description>
            <content:encoded><![CDATA[<p>The time has finally come; <a href="https://stately.ai/docs" target="_blank" rel="noopener noreferrer">our new docs</a> are ready to share with you all. If you’ve been following our office hours, you know I’ve been talking about these docs for a long time. Thanks to Anders, who used <a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer">Docusaurus</a> to build us a rock solid easily-maintainable platform with search that actually works, and the whole team, who have contributed reviews, explainers, and examples to get these docs started.</p><p><img loading="lazy" alt="Stately docs homepage." src="/statelyai-docs/assets/images/2023-01-19-docs-ff48ff14dcf9ff90ca018887f4b3613c.png" width="1480" height="844" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="docs-for-the-stately-studio">Docs for the Stately Studio<a href="#docs-for-the-stately-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Our new docs have documentation for both the <a href="https://stately.ai/editor" target="_blank" rel="noopener noreferrer">Stately Studio</a> and <a href="https://xstate.js.org" target="_blank" rel="noopener noreferrer">XState</a>. If you want to learn how to use the Studio without having to learn any code, we’ve got you covered with a <a href="https://stately.ai/docs/state-machines-and-statecharts" target="_blank" rel="noopener noreferrer">no-code introduction to state machines and statecharts</a> and <a href="https://stately.ai/docs/states/intro" target="_blank" rel="noopener noreferrer">step-by-step tutorials for different features in the Studio</a>. We’ve also got a <a href="https://stately.ai/docs/descriptions" target="_blank" rel="noopener noreferrer">modeling section</a> where we’ll add more guides to modeling your machines in the future.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="docs-for-xstate">Docs for XState<a href="#docs-for-xstate" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you’re a more experienced developer who wants to <a href="https://stately.ai/docs/xstate/basics/what-is-a-statechart" target="_blank" rel="noopener noreferrer">jump straight into XState</a>, we have docs that focus on the coding experience and cover all the concepts you need to know when working with XState. Shoutout to <a href="https://totaltypescript.com" target="_blank" rel="noopener noreferrer">Matt Pocock</a>, who used his vast knowledge of XState to kick these docs off when he was with us last year.</p><p><img loading="lazy" alt="The ‘What is a statechart?’ section of the XState docs with code examples." src="/statelyai-docs/assets/images/2023-01-19-docs-xstate-b3ec53a9a46b03a62ebf1fb94f12c7dd.png" width="1480" height="720" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="useful-search">Useful search<a href="#useful-search" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>As I mentioned earlier, the search in the docs really works. Search is a problem for a lot of documentation across the web and something we were keen to improve over the previous XState docs. Anders worked hard to make the Algolia search work for us, and while the structure of our docs navigation is essential, we all know the search is where you’ll likely go first.</p><p><img loading="lazy" alt="Docs search showing results for ‘actor’ which includes relevant and useful results." src="/statelyai-docs/assets/images/2023-01-19-docs-search-4afc7ff8b2d8f0b34797ef1f171da28d.png" width="1480" height="720" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dark-mode">Dark mode<a href="#dark-mode" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>One of our most-requested features for our docs was dark mode. Inspired by Nick’s light and dark mode designs for the Studio, I’ve given the docs light mode and dark modes that should hopefully be easy on the eyes and give you the best possible reading experience. Even our images respond to the light and dark modes!</p><p><img loading="lazy" alt="Stately docs homepage split into light mode and dark mode." src="/statelyai-docs/assets/images/2023-01-19-docs-light-mode-fd4c65a71ea51c5747edf4ec11ac1679.png" width="1480" height="844" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="easy-to-contribute">Easy to contribute<a href="#easy-to-contribute" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>At the end of every page, we have an <strong>Edit this page on GitHub</strong> link, which takes you directly to that page in our docs’ GitHub repository. We appreciate any contributions that help our community learn XState and the Stately Studio. We have a short <a href="https://github.com/statelyai/docs/wiki" target="_blank" rel="noopener noreferrer">Stately Guide to Writing Docs wiki</a> on <a href="https://github.com/statelyai/docs/" target="_blank" rel="noopener noreferrer">our repository</a> with recommendations on structure and style. Read below if you want to suggest an improvement to our docs.</p><p><img loading="lazy" alt="A link at the bottom of a Stately docs page with an ‘Edit this page on GitHub’ link." src="/statelyai-docs/assets/images/2023-01-19-docs-contribute-33e76e7384860621e77f5991796f6ab6.png" width="1480" height="520" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="still-in-beta">Still in beta<a href="#still-in-beta" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>These docs are still in beta, and we want your feedback! At Stately, we care a great deal about accessible and valuable education. Our docs are a living iterable product, and we want to continuously improve them to make them as valuable a resource as possible. Please <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">let us know in Discord</a> or <a href="https://twitter.com/statelyai" target="_blank" rel="noopener noreferrer">on Twitter</a> if you have suggestions for improvements or where we could make the docs clearer or better for you. Use <a href="https://feedback.stately.ai/docs" target="_blank" rel="noopener noreferrer">our Canny documentation request board</a> if you have a page, feature, or example request. </p><p>We hope you like our new, improved docs, and we’re looking forward to hearing from you!</p>]]></content:encoded>
            <category>studio</category>
            <category>xstate</category>
            <category>docs</category>
            <category>search</category>
            <category>light mode and dark mode</category>
            <category>contribute</category>
        </item>
        <item>
            <title><![CDATA[New in the Studio: Machine restore]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-12-22-machine-recovery</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-12-22-machine-recovery</guid>
            <pubDate>Tue, 13 Dec 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[We have introduced a new feature to the Stately Studio, a feature we hope you’ll never see. Let’s call it machine restore, for lack of a better description.]]></description>
            <content:encoded><![CDATA[<p>We have introduced a new feature to the Stately Studio, a feature we hope you’ll never see. Let’s call it machine restore, for lack of a better description.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="whats-the-challenge">What's the challenge?<a href="#whats-the-challenge" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>At this moment in time, the Studio is using a traditional server-client architecture. Whenever you edit a machine, we will persist these changes to our central database, ready for you to use when you return - on any device with an internet connection.</p><p><img loading="lazy" alt="Simplified drawing of the Stately Studio architecture described above." src="/statelyai-docs/assets/images/studio_architecture_challenges-58edfee5ff1087c67b5aa6924ffb192a.png" width="2564" height="1442" class="img_ev3q"></p><p>But what happens with your edits if your internet connection fails or the Stately backend is having problems? This is where our new feature comes into play.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>In our example, Santa’s delivery machine has a problem; the Christmas-time state is unreachable. So we do as any good Santa’s helper would; we create an event to get to Christmas. But alas, we’re offline, so our changes could get lost. Before this new feature, there was a chance you wouldn’t notice you’d gone offline or that the server returned an error. But as you can see in the GIF below, we’ve introduced new error banners to show you what’s happening.</p><p><img loading="lazy" alt="Santa’s delivery state machine shows an error while trying to edit offline." src="/statelyai-docs/assets/images/recovery_offline_error-a6805d060bb624bb16626f61ce842d8c.gif" width="800" height="492" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-restore">How to restore<a href="#how-to-restore" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>We try our best to detect any failure or missing connectivity when you edit your machines. If you hit any error state, we will inform you and start saving your work locally on your device. So next time you visit the Studio from that same device, we will compare what we saved with the machine from the server. And if they are different, we will give you the option to restore the safe copy to a new machine.</p><p>You can see this in action using our example from above. When I return to the Studio, I can restore the changes I did while offline. Christmas is saved.</p><p><img loading="lazy" alt="The Stately Studio shows an option to restore changes made to a machine while the user was offline." src="/statelyai-docs/assets/images/recovery_restore_machine-aa9e3b86b54606936f314b196c6ae4bb.gif" width="800" height="492" class="img_ev3q"></p><p>Hopefully, you’ll never see this feature, but if you do, I hope you find it helpful.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What's next<a href="#whats-next" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>We have some exciting plans around an offline-first approach for the Studio which should make this restore feature obsolete and also enable features such as multi-player editing. Stay tuned for more news about this in 2023.</p>]]></content:encoded>
            <category>recovery</category>
            <category>restore</category>
            <category>offline</category>
            <category>editor</category>
            <category>studio</category>
        </item>
        <item>
            <title><![CDATA[New in the Studio: Import from code]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-11-29-import-from-code</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-11-29-import-from-code</guid>
            <pubDate>Tue, 29 Nov 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[One of our most-requested features has just landed in the Stately Studio; you can now import from code!]]></description>
            <content:encoded><![CDATA[<p>One of our most-requested features has just landed in the Stately Studio; you can now import your machines from code! </p><p><a href="https://www.youtube.com/watch?v=DAoIFaugDLo" target="_blank" rel="noopener noreferrer">Watch import from code in action in our latest video</a>.</p><p>Importing from code is handy if you’ve already built machines while working with <a href="https://xstate.js.org/docs" target="_blank" rel="noopener noreferrer">XState</a>, or have created a machine using our older <a href="https://stately.ai/viz" target="_blank" rel="noopener noreferrer">Stately Viz</a> and haven’t yet tried the <a href="https://stately.ai/editor" target="_blank" rel="noopener noreferrer">Stately visual editor</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-import-from-code">How to import from code<a href="#how-to-import-from-code" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>You can import an existing machine from JavaScript and TypeScript using the code panel in the right tool menu or from the <strong>Machines</strong> list in the left drawer.</p><p><img loading="lazy" alt="Code panel open in the Studio with the Import button highlighted." src="/statelyai-docs/assets/images/2022-11-29-import-from-code-right-panel-7a96000b02bb5c33a15ac338d579aa30.png" width="1480" height="330" class="img_ev3q"></p><p><img loading="lazy" alt="Left drawer open in the Studio showing the Machines list. A machine’s contextual menu is open with the Import Code option highlighted." src="/statelyai-docs/assets/images/2022-11-29-import-from-code-left-drawer-9367ce6457127ab4f7da6e5810a8404c.png" width="1480" height="560" class="img_ev3q"></p><p>Your code should be formatted as a <a href="https://xstate.js.org/docs/guides/machines.html" target="_blank" rel="noopener noreferrer"><code>createMachine()</code> factory function</a> before import. The importer has basic validation in case your machine has basic errors, including reminding you if the <code>createMachine</code> definition is missing.</p><p><img loading="lazy" alt="Left drawer open in the Studio showing the Machines list New machine dialog with the Import Code slider switched on. There’s JavaScript already in the text area and the cursor is hovering over the Create machine button." src="/statelyai-docs/assets/images/2022-11-29-import-from-code-create-machine-a6729c6767f8e14cb0e68145494a15f2.png" width="1480" height="720" class="img_ev3q"></p><p>And please import your code into an existing machine with caution! Importing code from the code panel will overwrite the current machine in the editor. You may have multiple <code>createMachine</code>s included in the code you insert in the text area, but the Studio will currently only import the first machine found in the code. We plan to support importing multiple machines in the future, if that’s a feature you’d love, please <a href="https://feedback.stately.ai/editor/p/import-multiple-machines-from-one-code-import" target="_blank" rel="noopener noreferrer">upvote the multiple machine import feature request</a> on our board.</p><p><img loading="lazy" alt="Import Code modal. There’s JavaScript formatted as a createMachine factory function inside the text area. A warning at the top of the dialog warns you that importing from JSON will overwrite all data in “My new machine”." src="/statelyai-docs/assets/images/2022-11-29-import-from-code-importer-975340023f95a0c62ca53133bccb552b.png" width="1480" height="1520" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="export-code">Export code<a href="#export-code" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>What about exporting your machines as code? You might have missed this feature as we released it as part of the <a href="https://stately.ai/blog/2022-10-18-introducing-stately-studio-1-0#more-export-options" target="_blank" rel="noopener noreferrer">Stately Studio 1.0 release</a>. You can export your machine as JSON, JavaScript, and TypeScript using the code panel in the right tool menu. </p><p>Using the export icon button in the editor’s top bar, you can also export as code from the <strong>Export machine</strong> dialog. <a href="https://www.youtube.com/watch?v=NVQai9SBpiU" target="_blank" rel="noopener noreferrer">Check out Laura’s demo utilizing this feature to go from modeling your machine to code</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="please-give-us-your-feedback">Please give us your feedback!<a href="#please-give-us-your-feedback" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Have you used the import and export features yet? We’d love to hear your thoughts! The team loves hearing your feedback <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">on our Stately Discord</a> or during our next <a href="https://youtube.com/statelyai" target="_blank" rel="noopener noreferrer">office hours live stream</a>. If you have any feature requests, please add them to our <a href="https://feedback.stately.ai" target="_blank" rel="noopener noreferrer">feature request board</a>, and we’ll keep you updated if it’s planned, in progress, or complete!</p>]]></content:encoded>
            <category>editor</category>
            <category>studio</category>
            <category>import</category>
            <category>code</category>
            <category>xstate</category>
        </item>
        <item>
            <title><![CDATA[New: Safari support, new login providers, and more!]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-11-22-studio-update</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-11-22-studio-update</guid>
            <pubDate>Tue, 22 Nov 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[It’s been just over a month since we released Stately Studio 1.0, and the team has barely slowed down! We’ve got more features live in the Studio today and even more planned before the end of the year.]]></description>
            <content:encoded><![CDATA[<p>It’s been just over a month since <a href="/statelyai-docs/blog/2022-10-18-introducing-stately-studio-1-0">we released Stately Studio 1.0</a>, and the team has barely slowed down! We’ve got more features live in the Studio today and even more planned before the end of the year.</p><p><a href="https://www.youtube.com/watch?v=N9QtPcknqDw" target="_blank" rel="noopener noreferrer">Watch a demo of these features in our release video</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="safari-support">Safari support<a href="#safari-support" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’re happy to tell you <a href="https://stately.ai/studio" target="_blank" rel="noopener noreferrer">the Stately Studio</a> now works in Safari. It took a significant code refactor, which doesn’t just mean that you can now edit your statecharts using Safari; the new code structure should also give us bonuses for accessibility and future integrations. If you’re curious about what David refactored, you can watch him talk about the Safari support during <a href="https://youtu.be/JBckQTgeD9g?t=2153" target="_blank" rel="noopener noreferrer">our office hours from last week</a>.</p><p>Safari support is still in beta, you’ll get a message warning you when you open the Studio in Safari for the first time. Your machines are not in danger; you might encounter a few bugs when using the Safari browser. If you do come across any bugs, please let us know in the #studio-feedback channel in <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">our Discord</a>, and we’ll try to get them fixed as quickly as possible.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sign-up-and-log-in-with-twitter-google-and-email">Sign up and log in with Twitter, Google, and email<a href="#sign-up-and-log-in-with-twitter-google-and-email" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You can now log into the Stately Studio with Twitter or Google, or set up an account with your email address and password. We’ve had GitHub login support since we first launched the Studio, and alternative login providers have been a popular request from our community.</p><p><img loading="lazy" alt="The Stately Studio sign up page with login options for GitHub, Google, Twitter, as well as email address and password fields for sign up." src="/statelyai-docs/assets/images/2022-11-22-studio-update-login-providers-0338e197e5c287b00fae675df692ba2f.png" width="1480" height="1200" class="img_ev3q"></p><p>Are there any login providers we should add? Please let us know as a <a href="https://feedback.stately.ai/studio" target="_blank" rel="noopener noreferrer">feature request on our Studio board</a>. Many options are available to us, and we aim to support the community’s most popular providers.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-editor-improvements">More editor improvements<a href="#more-editor-improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve continued making usability improvements to the editor. You might notice that transition lines now run underneath the nodes, resulting in tidier, more readable machines by default. We also now highlight the selected event and its target and source states, fading out other nodes. Changes like this should help you focus and understand the machine, especially inside vast and complex machines.</p><p><img loading="lazy" alt="Section of a machine in the Stately Studio showing the event selected, its transitions, and source and target states all at 100% opacity, and all other nodes and transition lines at a faded out transparency." src="/statelyai-docs/assets/images/2022-11-22-studio-update-highlighted-selected-event-120c2d2dc0150182bad86a5afb7ffc0f.png" width="1480" height="718" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="better-overall-performance">Better overall performance<a href="#better-overall-performance" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The team has also migrated the Studio to tRPC v10 on the back end and TanStack Query on the front end. The migration isn’t a change you can see, but it has enormously improved the performance of the Studio, making everything feel speedier and smoother.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="want-to-know-whats-coming-up">Want to know what’s coming up?<a href="#want-to-know-whats-coming-up" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you want to keep up with the team’s latest work-in-progress, <a href="https://youtube.com/statelyai" target="_blank" rel="noopener noreferrer">subscribe to our YouTube channel</a>. We share our work, upcoming features, and answer your questions in our regular office hours live streams. <a href="https://www.youtube.com/watch?v=JBckQTgeD9g" target="_blank" rel="noopener noreferrer">Check out last week’s office hours live stream</a> for a peek into features we’re looking to release very soon.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="request-the-features-you-want">Request the features you want<a href="#request-the-features-you-want" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you’ve watched <a href="https://www.youtube.com/watch?v=JBckQTgeD9g&amp;list=PLvWgkXBB3dd6PXbSoctwDXjWX-AQrxhds" target="_blank" rel="noopener noreferrer">our office hours</a>, you know the team listens to every feature request and loves to make our community happy. You can request features, upvote other people’s suggestions, and check out what’s in progress on <a href="https://feedback.stately.ai" target="_blank" rel="noopener noreferrer">our Canny roadmap</a>.</p>]]></content:encoded>
            <category>editor</category>
            <category>studio</category>
            <category>safari</category>
            <category>login</category>
            <category>performance</category>
        </item>
        <item>
            <title><![CDATA[Learn the Stately Studio with our new video tutorials]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-10-27-studio-tutorials</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-10-27-studio-tutorials</guid>
            <pubDate>Thu, 27 Oct 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[If you’re new to the Stately Studio, state machines or statecharts, we have the videos for you! Our new Stately Studio tutorials playlist on YouTube features bite-size videos to help you get started with understanding statecharts and state machines, and start modeling in the Stately Studio.]]></description>
            <content:encoded><![CDATA[<p>If you’re new to the Stately Studio, state machines or statecharts, we have the videos for you! Our new Stately Studio tutorials playlist on YouTube features bite-size videos to help you get started with understanding statecharts and state machines, and start modeling in the Stately Studio.</p><p>Each video explains a concept with an example machine and shows you how to use the features in the Stately Studio. You can <a href="https://www.youtube.com/playlist?list=PLvWgkXBB3dd4I_l-djWVU2UGPyBgKfnTQ" target="_blank" rel="noopener noreferrer">watch the whole playlist</a> in one go or watch the videos individually, as shown below.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-state-machines-and-statecharts">What are state machines and statecharts?<a href="#what-are-state-machines-and-statecharts" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="states">States<a href="#states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="initial-states">Initial states<a href="#initial-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="transitions-and-events">Transitions and events<a href="#transitions-and-events" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="parent-and-child-states">Parent and child states<a href="#parent-and-child-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="parallel-states">Parallel states<a href="#parallel-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="final-states">Final states<a href="#final-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="entry-and-exit-actions">Entry and exit actions<a href="#entry-and-exit-actions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="delayed-after-transitions">Delayed (after) transitions<a href="#delayed-after-transitions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="state-done-events">State done events<a href="#state-done-events" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="invoked-actors">Invoked actors<a href="#invoked-actors" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="descriptions">Descriptions<a href="#descriptions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-videos-coming-soon">More videos coming soon<a href="#more-videos-coming-soon" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ll be adding more videos to the playlist very soon! Do you want us to make tutorials for a concept you need help understanding? Or how to use a particular feature in the Stately Studio? <a href="https://feedback.stately.ai" target="_blank" rel="noopener noreferrer">Leave us a request on our Canny roadmap</a>.</p>]]></content:encoded>
            <category>editor</category>
            <category>studio</category>
            <category>tutorials</category>
            <category>video</category>
        </item>
        <item>
            <title><![CDATA[Introducing Stately Studio 1.0]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-10-18-introducing-stately-studio-1-0</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-10-18-introducing-stately-studio-1-0</guid>
            <pubDate>Tue, 18 Oct 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[We’re excited to announce the release of Stately Studio 1.0! We’ve been working on Stately Studio for over a year now, and we’re thrilled to share it with you.]]></description>
            <content:encoded><![CDATA[<p>We’re excited to announce the release of Stately Studio 1.0! 🚀 Our mission is for all app logic to be visually collaborative and accessible to your entire team, and we’ve been working hard to make that a reality.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="thank-you-for-your-support">Thank you for your support!<a href="#thank-you-for-your-support" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Earlier this year, we released <a href="/statelyai-docs/blog/2022-02-08-join-the-stately-editor-public-beta">the first beta of Stately Editor &amp; Stately Registry</a> (together called the Stately Studio). We also released <a href="https://stately.ai/viz" target="_blank" rel="noopener noreferrer">Stately Viz</a>, a visualizer for XState machines, and the <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">XState VS Code extension</a>. Since then, over 10,000 of you have tried our tools out, creating and sharing tens of thousands of machines (we don’t know the exact number because machines built with the extension are always private!) </p><p>Thank you for giving our tools a go and for all the valuable feedback you’ve given us; we’ve been blown away by the response. We’re listening and continuing to improve the Stately Studio. As always, you can <a href="https://feedback.stately.ai" target="_blank" rel="noopener noreferrer">create and upvote feature requests on our Canny roadmap</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="teams">Teams<a href="#teams" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Collaborating on app logic is one of Stately’s key goals. That’s why we’ve introduced <strong>teams</strong>, where you can organize, privately share, and edit projects with your teammates. A <strong>project</strong> is a collection of related machines you can keep to yourself or share with your team. You can invite teammates to your team, and they can join your team by accepting the invitation.</p><p><img loading="lazy" alt="Stately Studio view of My Projects, with a big Create Projects button and a list of My Projects. Each project has a title such as Flows, its visibility, such as public, unlisted or private, and the number of machines inside that project." src="/statelyai-docs/assets/images/studio-1-0-projects-ede5104e9c681b287e48ddb4d137f4fd.png" width="2540" height="1520" class="img_ev3q"></p><p>The teams feature is the first step to providing more powerful collaboration features. We’re working on GitHub integration with public and private repos, commenting, machine revisions with visual diffs, multiplayer mode for collaboratively editing machines in real time, and much more.</p><p>Teams (previously known as Systems) are available on <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">our new Pro subscription</a>.</p><p><img loading="lazy" alt="The Members view of the Stately team in the Stately Studio. There’s an inline Invite Members form with options for an email address, and dropdown for role with “Viewer” currently selected. In the team there’s a list of Owners/Admins including David Khourshid and Laura Kalbag. David has a badge of “Owner” alongside his avatar." src="/statelyai-docs/assets/images/studio-1-0-teams-f4d12c3597505c140a838768601452dc.png" width="2540" height="1520" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="machine-visibility-and-roles">Machine visibility and roles<a href="#machine-visibility-and-roles" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Machines may contain business logic you don’t want to share with the world; that’s why we’ve introduced <strong>visibility</strong> and <strong>roles</strong>. You can set a machine to be <em>private</em>, <em>public</em>, or <em>unlisted</em>. Private machines are only visible to you and your teammates. Public machines are visible to everyone, and <a href="https://stately.ai/registry/discover" target="_blank" rel="noopener noreferrer">discoverable through search</a>. Unlisted machines are only visible to those with the link, as they don’t appear in search results.</p><p><img loading="lazy" alt="Share menu in the Stately Studio with an option to copy link, and set the project to either public, unlisted, or private. The private option is selected and Permissions text under the option states that this project is only visible to you and your team." src="/statelyai-docs/assets/images/studio-1-0-visibility-c4feaa96f2ce530baacb04f2746c4b9a.png" width="2540" height="1520" class="img_ev3q"></p><p>You can also set roles for teammates to restrict how they can edit projects and machines. You can set a teammate to be a viewer, editor, or admin. Viewers can view projects and machines, but can’t edit them. Editors can edit projects and machines, but can’t delete them. Admins can do everything, including assigning roles.</p><p>Private/unlisted machines and team roles are available on <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">our new Pro subscription.</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="editor-redesign">Editor redesign<a href="#editor-redesign" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You might have noticed a refreshed redesign of the editor. The editor view is now more project-centric, allowing you to switch between machines with a single click. And we’ve improved the layout of states to give you more space to create and rearrange states. </p><p><img loading="lazy" alt="Simulate view in the Stately Studio showing a video player machine. In the mini state of the machine, there’s an image of a video player embedded in the description. There’s a popover menu showing the simulation event log. There’s a drawer icon in the top left showing where the tree view is hidden away. A breadcrumb in the header shows this machine is in the Stately team and Learn Stately studio project. The current tab in the top navigation is Simulate, but Edit is also available." src="/statelyai-docs/assets/images/studio-1-0-simulate-dcb4bfc29a950217cc44e9f21c7d2dbb.png" width="2540" height="1520" class="img_ev3q"></p><p>We’ve also redesigned guarded transitions. They are now individual transitions connected with a dotted line and a diamond, which should feel natural to anyone that has worked with flowcharts. The separated transitions make it easier to read and arrange the conditions for each transition, allowing you to change the source and target states of individual transitions quickly.</p><p><img loading="lazy" alt="Detail of a state machine in the Stately Studio featuring a guard in a rounded rectangle labeled with “if” and a diamound shape and 1, where a guard is a condition that is checked when a machine goes through an event, attached by dotted lines to its conditions which are also in rounded rectangles, numbered 2 and 3 in diamond labels. The first condition is labeled “else if”, the second condition is labeled “else”." src="/statelyai-docs/assets/images/studio-1-0-guards-5cc277e4fe856e3c29372912092e8bef.png" width="2222" height="924" class="img_ev3q"></p><p>Simulation mode has also been redesigned, making it easier to see active states and transitions. There are many more improvements to the editor, but we’ll leave them to you to discover.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-export-options">More export options<a href="#more-export-options" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You asked, and we listened (we’re currently in the listening state). We’ve added more export options beyond JSON, including JavaScript and TypeScript. We have plans to add more export options in the future, including:</p><ul><li>Markdown</li><li>CodeSandbox</li><li>StackBlitz</li><li>SVG, PNG, PDF</li><li>And others </li></ul><p><a href="https://feedback.stately.ai" target="_blank" rel="noopener noreferrer">Request your favorite export options on our Canny roadmap</a>.</p><p><img loading="lazy" alt="The code popover panel showing over a video player machine. The Code options are JSON, JavaScript and TypeScript. The JavaScript option is selected, alongside a button to copy to clipboard. The code is shown in a text area below as JavaScript object describing the video player machine." src="/statelyai-docs/assets/images/studio-1-0-export-24203f6bcec202ded5ec95f5711055b1.png" width="2540" height="1520" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What’s next?<a href="#whats-next" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We have so many things planned for the future:</p><ul><li>A Stately GitHub integration for public and private repos</li><li>XState parity: supporting all of <a href="https://github.com/statelyai/xstate" target="_blank" rel="noopener noreferrer">XState’s features</a> in the Stately Studio (we’re almost there!)</li><li>More export options and an embeddable editor</li><li>Support for other graph-based tools, CI/CD pipelines and other workflow engines/DSLs</li><li>Static graph analysis to help you catch logic errors ahead of time, which is difficult to do with plain code</li><li>Many more examples, tutorials, videos, and documentation</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="try-out-the-studio">Try out the Studio<a href="#try-out-the-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>All our new Pro features are available with a 30-day free trial you can try with your whole team. Upgrade today using the Upgrade button in <a href="https://stately.ai/editor" target="_blank" rel="noopener noreferrer">the Stately Studio</a> or Sign in with GitHub to create a new account.</p><p><img loading="lazy" alt="The Upgrade button has an orange border and is located in the top right of the Studio navigation, between the Export machine icon and the user avatar." src="/statelyai-docs/assets/images/studio-1-0-upgrade-e915a6cc235ae36990462f7336f63216.png" width="2540" height="732" class="img_ev3q"></p><p>If you’re a Product Hunt fan, you can also <a href="https://www.producthunt.com/posts/stately-studio-1-0" target="_blank" rel="noopener noreferrer">find Stately Studio 1.0 on Product Hunt</a>.</p><p>Have any questions? Join us in <a href="https://www.youtube.com/watch?v=JcT7iJOPFjE" target="_blank" rel="noopener noreferrer">our office hours live stream this Friday</a>, where we’ll answer your questions and give you more demos.</p>]]></content:encoded>
            <category>editor</category>
            <category>studio</category>
            <category>announcement</category>
        </item>
        <item>
            <title><![CDATA[What’s new in September 2022?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-09-14-whats-new-september-2022</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-09-14-whats-new-september-2022</guid>
            <pubDate>Wed, 14 Sep 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[The Stately team has got some huge features to share with you soon. Here’s what we’ve been working hard on through the summer!]]></description>
            <content:encoded><![CDATA[<p>The Stately team has got some huge features to share with you soon. We’ve been working hard through the summer, which is why we’re already halfway into September by the time I’ve gotten around to this update post.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="human-readable-timers">Human-readable timers<a href="#human-readable-timers" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>When building after events, the convention is to specify the delay length in milliseconds, which is great for computers, but less easy for humans to understand. Now we display the timers in more human-friendly terms, including years, weeks, minutes, and seconds. You can still access the delay in milliseconds from the right panel when the event is selected.</p><p><img loading="lazy" alt="An after event in the studio showing “after 3 mins” as the event label and 180000 milliseconds in the delay field in the side panel." src="/statelyai-docs/assets/images/human-readable-timers-7dcc800b0416ff7306a6c3290ef31f72.png" width="4052" height="2376" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-version-alerts-in-the-stately-studio">New version alerts in the Stately studio<a href="#new-version-alerts-in-the-stately-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We will now notify you in the browser when there is a new version of the studio. You’ll likely have seen other platforms with similar notifications in the past. This alert is our way of getting you the latest changes to the studio without the risk of losing your work in progress.</p><p><a href="https://youtu.be/HI8LbL5Yu74?t=150" target="_blank" rel="noopener noreferrer">Watch the office hours from August 26 for more on the new version alerts</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="xstate-4336-patch-release">XState 4.33.6 patch release<a href="#xstate-4336-patch-release" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’re all looking forward to the XState version 5 release. In the meantime, we’ve got some migratory moves towards v5 in the form of the <a href="https://github.com/statelyai/xstate/releases/tag/xstate%404.33.6" target="_blank" rel="noopener noreferrer">XState 4.33.6 patch release</a>.</p><p>Reading state directly from <code>someService.state</code> is now deprecated, and we encourage you to use <code>someService.getSnapshot()</code> instead. <code>.getSnapshot()</code> will become the go-to way to read the current snapshot from any actor.</p><p>We’re also deprecating the <code>send()</code> action in favor of the new <code>sendTo()</code> action. <code>sendTo(actorName, event)</code> allows you to send to a specific, named actor with the <code>actorName</code> string. <code>sendTo()</code> paves the way for more improved typings and making the terms and concepts we use easier to understand for folks new to XState.</p><p><a href="https://youtu.be/H0uTQbaW9rk?t=115" target="_blank" rel="noopener noreferrer">Find out more in David’s update on the 4.33.6 patch release from last week’s office hours</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="have-you-attended-our-office-hours">Have you attended our office hours?<a href="#have-you-attended-our-office-hours" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you want more regular updates from the Stately team, check out the <a href="https://youtube.com/playlist?list=PLvWgkXBB3dd6PXbSoctwDXjWX-AQrxhds" target="_blank" rel="noopener noreferrer">Stately office hours</a>. Every Friday at 10 AM ET, we live stream demos and discussions of our recent work at Stately and on XState. Live streaming on YouTube, Twitter, LinkedIn and Twitch, they’re a real highlight of our week, and we’re nearing our 50th edition 🎉.</p><p>Be sure to join us at <a href="https://www.youtube.com/watch?v=37YVzAjhDHA" target="_blank" rel="noopener noreferrer">our next office hours this Friday</a>!</p>]]></content:encoded>
            <category>stately</category>
            <category>xstate</category>
            <category>studio</category>
        </item>
        <item>
            <title><![CDATA[Building a resizable panel: Part 2]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-08-31-building-a-resizable-panel</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-08-31-building-a-resizable-panel</guid>
            <pubDate>Wed, 31 Aug 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Farzad and David add more features to their resizable panel using XState and React.]]></description>
            <content:encoded><![CDATA[<p>Farzad and David add more features to their resizable panel using XState and React. <a href="/statelyai-docs/blog/2022-08-22-building-a-resizable-panel">Watch Part 1</a>.</p><p><a href="https://codesandbox.io/s/resizable-panel-example-jjgkzl?file=/src/index.tsx" target="_blank" rel="noopener noreferrer">Check out the accompanying code on Code Sandbox</a>.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>]]></content:encoded>
            <category>stately</category>
            <category>stately stream</category>
            <category>xstate</category>
            <category>studio</category>
            <category>react</category>
        </item>
        <item>
            <title><![CDATA[Building a resizable panel]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-08-22-building-a-resizable-panel</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-08-22-building-a-resizable-panel</guid>
            <pubDate>Mon, 22 Aug 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Farzad and David use XState to build the logic for a resizable panel with React in an impromptu live stream.]]></description>
            <content:encoded><![CDATA[<p>Farzad and David use XState to build the logic for a resizable panel with React in an impromptu live stream.</p><p><a href="https://codesandbox.io/s/resizable-panel-example-jjgkzl?file=/src/index.tsx" target="_blank" rel="noopener noreferrer">Check out the accompanying code on CodeSandbox</a>.</p><p><a href="/statelyai-docs/blog/2022-08-31-building-a-resizable-panel">Watch part 2</a>.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>]]></content:encoded>
            <category>stately</category>
            <category>xstate</category>
            <category>studio</category>
            <category>react</category>
        </item>
        <item>
            <title><![CDATA[“Goodbye, useEffect” at React Next conference]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-08-17-goodbye-use-effect-at-react-next</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-08-17-goodbye-use-effect-at-react-next</guid>
            <pubDate>Wed, 17 Aug 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Create a state machine in seconds and edit using our visual editor.]]></description>
            <content:encoded><![CDATA[<p>From fetching data to fighting with imperative APIs, side effects are one of the biggest sources of frustration in web app development. And let’s be honest, putting everything in useEffect hooks doesn’t help much. </p><p>Thankfully, there is a science (well, math) to side effects, formalized in state machines and statecharts, that can help us visually model and understand how to declaratively orchestrate effects, no matter how complex they get. In this talk, David ditches the <code>useEffect</code> hook and discovers how these computer science principles can be used to simplify effects in our React apps.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>]]></content:encoded>
            <category>stately</category>
            <category>xstate</category>
            <category>studio</category>
            <category>conference</category>
            <category>talk</category>
        </item>
        <item>
            <title><![CDATA[XState + VS Code: xsm snippet]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-08-10-get-started-with-xstate-using-xsm-snippet</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-08-10-get-started-with-xstate-using-xsm-snippet</guid>
            <pubDate>Wed, 10 Aug 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Create a state machine in seconds and edit using our visual editor.]]></description>
            <content:encoded><![CDATA[<p>Using the XState extension for VS Code, you can create a state machine in seconds and edit the machine using our visual editor. Use the <code>xsm</code> snippet to quickly generate the code required for your state machine, then drag and drop inside our visual editor to rapidly model your machine.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>]]></content:encoded>
            <category>stately</category>
            <category>xstate</category>
            <category>vscode extension</category>
            <category>snippet</category>
        </item>
        <item>
            <title><![CDATA[What’s new in August 2022?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-08-03-whats-new-august-2022</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-08-03-whats-new-august-2022</guid>
            <pubDate>Fri, 05 Aug 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Get up and running faster with our XState VS Code extension and enjoy all the design details in the Stately studio experience.]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="updates-to-our-vs-code-extension">Updates to our VS Code extension<a href="#updates-to-our-vs-code-extension" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Our <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">XState VS Code extension</a> has now been installed 10k times! Install the extension yourself from inside VS Code or find the <a href="https://stately.ai/blog/2022/03/11/xstate-vscode-extension-now-available-on-the-open-vsx-registry" target="_blank" rel="noopener noreferrer">XState extension on the Open VSX Registry</a> to enjoy the following new features.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xsm-snippet"><code>xsm</code> snippet<a href="#xsm-snippet" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>We want to make it fast and easy to use XState and the visual editor in your code. By adding the <code>xsm</code> snippet to our VS Code extension, we’ve made it possible to go from nothing to a full-blown machine you can open in the visual editor in a few keystrokes.</p><p>Use our new <code>xsm</code> snippet (<a href="https://youtu.be/EkhWpJfVLDo?t=155" target="_blank" rel="noopener noreferrer">Anders says “think <strong>X</strong> <strong>S</strong>tate <strong>M</strong>achine”</a>) with the latest version of the extension to insert a state machine template into your code, with the cursor ready for you to type the name of the machine. </p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword module" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token imports"> createMachine </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'xstate'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> nameOfMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'nameOf'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'initialState'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">initialState</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Just give your machine a name, hit “Open visual editor,” and you’ll be able to continue creating your machine with the visual editor.</p><p><img loading="lazy" alt="Statechart showing a no nodes selected state then an event of using cmd/ctrl + A transitioning to an all node selected state." src="/statelyai-docs/assets/images/xsm-snippet-48e5a4d73d232cea7bc6b069549e164d.gif" width="1920" height="1080" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-editor-now-syncs-with-your-vs-code-theme">The editor now syncs with your VS Code theme<a href="#the-editor-now-syncs-with-your-vs-code-theme" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>You can now set your light mode or dark mode preference for the visual editor inside the VS Code extension:</p><ul><li>Auto: syncs to your VS Code preference</li><li>Light: always uses light mode</li><li>Dark: always uses dark mode</li></ul><p><img loading="lazy" alt="The XState: theme setting in VSCode is set to light and the visual editor is in light mode." src="/statelyai-docs/assets/images/vscode-lightmode-b7900130782d466b9b33a6848dff686e.png" width="3278" height="1727" class="img_ev3q"></p><p><img loading="lazy" alt="The XState: theme setting in VSCode is set to dark and the visual editor is in dark mode." src="/statelyai-docs/assets/images/vscode-darkmode-bd959547b0724b0d66ae64c286967e3b.png" width="3278" height="1727" class="img_ev3q"></p><p>If the editor is open when you change the setting, you’ll need to close and re-open the editor tab to view the change.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="initial-support-for-non-vs-code-editors">Initial support for non-VS Code editors<a href="#initial-support-for-non-vs-code-editors" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>If you don’t use VS Code, we haven’t forgotten about you! We intend to support more code editors in the future and have recently taken the first step of making it easier to edit machine code using other code editors. Watch <a href="https://www.youtube.com/watch?v=EkhWpJfVLDo&amp;t=252s" target="_blank" rel="noopener noreferrer">Anders’ demo using Webstorm</a> during last week’s office hours to find out more.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="updates-to-stately-editor">Updates to Stately editor<a href="#updates-to-stately-editor" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you haven’t used the  <a href="https://stately.ai/editor" target="_blank" rel="noopener noreferrer">Stately editor</a> in a while, you’re in for a treat!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="canvas-refinements">Canvas refinements<a href="#canvas-refinements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>We’ve made some small changes that have significantly changed how machines look and behave. Icons are now only used to distinguish the history states and final states, reducing the noise and increasing the readability of your machines.</p><p><img loading="lazy" alt="State machine for editor improvements, starting in a July state, transitioning through an event of “Canvas improvements go live” with a description saying “We&amp;#39;ve made many small improvements to the canvas in the last month.” Ending in a parent state of August with a child state of “My machines are so easy to read!”." src="/statelyai-docs/assets/images/august-22-editor-improvements-1a0f6b3323d2978f972572fe145b514c.png" width="1406" height="908" class="img_ev3q"></p><p>The transition line drawing algorithm has been improved further for straighter, more reasonable lines with fewer bends. The lines are now highlighted on hover, making them easier to select. We’ll continue to improve the algorithm so that it’s more intelligent about drawing even better lines.</p><p>We’ve also removed the terminal squares at the end of the transition lines and put a little space between the transition lines and nodes. These subtle changes make the machines look less crowded, helping you focus more on your modeling.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="select-all-with-the-keyboard-shortcut">Select all with the keyboard shortcut<a href="#select-all-with-the-keyboard-shortcut" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>You can now use the <kbd>cmd</kbd>/<kbd>ctrl</kbd> <strong>+</strong> <kbd>a</kbd> keyboard shortcut to select all nodes and transitions in the editor. This shortcut is so common that you’ve probably tried to use it already… now the shortcut will work!</p><p><img loading="lazy" alt="Statechart showing a no nodes selected state then an event of using cmd/ctrl + A transitioning to an all node selected state." src="/statelyai-docs/assets/images/select-all-keyboard-shortcut-71eb56df73fa13f30225d27fd1257c14.gif" width="1920" height="1080" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-privacy-options">New privacy options<a href="#new-privacy-options" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We now have a modal asking for your consent the next time you log into the Stately Studio. We are sending some non-personal activity data to Mixpanel to help us understand how you use our features, but we need your permission to connect this data to a hash of your user ID. Many tech companies won’t ask for your explicit consent for similar activities. Still, at Stately, we want to use best practices regarding your privacy and be transparent about the minimal data we collect, how we use that data, and how we design for privacy by default. You can update your choices at any time in the studio settings.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="please-give-us-feedback-in-our-yearly-survey">Please give us feedback in our yearly survey<a href="#please-give-us-feedback-in-our-yearly-survey" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Soon we’ll be closing <a href="https://stately.ai/survey" target="_blank" rel="noopener noreferrer">the Stately 2022 survey</a>. Do you know someone who isn’t using our tools but should be? Please get them to respond to our survey! We’d love to understand what features folks need to start using Stately tools. And if you’ve not responded yet, get your response in soon! All the questions are optional, and it will take just five minutes of your time.</p>]]></content:encoded>
            <category>stately</category>
            <category>xstate</category>
            <category>announcement</category>
            <category>vscode extension</category>
            <category>studio</category>
            <category>survey</category>
        </item>
        <item>
            <title><![CDATA[“Just Use Hooks”: XState in React Components]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-07-18-just-use-hooks-xstate-in-react-components</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-07-18-just-use-hooks-xstate-in-react-components</guid>
            <pubDate>Mon, 18 Jul 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[XState can be easily added to React components by using custom machine hooks for greater encapsulation and reusability.]]></description>
            <content:encoded><![CDATA[<p>Are you a React developer using <a href="https://xstate.js.org/" target="_blank" rel="noopener noreferrer">XState</a> to model your application logic? Perhaps you’ve heard of XState but have been looking for an easy way to try it out in one of your projects. If so, then I’d like to share with you a pattern I was introduced to when first diving into codebase at Stately, that of using <strong>custom machine hooks</strong>. This lightweight, reusable way to integrate XState into React components is a delight to work with and I think you might like it as much as I do!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>In this post I’ll review the most common way to use the <a href="https://xstate.js.org/docs/packages/xstate-react/" target="_blank" rel="noopener noreferrer"><code>@xstate/react</code></a> library in a project. I’ll then demonstrate how encapsulation and reuse of state machines can be achieved by using hooks in your components, with some examples. I’ll also touch on the advantages and disadvantages to using this level of abstraction.</p><p>For more background, you can check out <a href="https://stately.ai/blog/2021-01-11-just-use-props-an-opinionated-guide-to-react-and-xstate" target="_blank" rel="noopener noreferrer">“Just Use Props”: An opinionated guide to React and XState</a> by Matt Pocock.</p><p>After years of usage in the wild, and in response to confusion and frustration about hooks, the React Team has been putting a lot of effort into making the use of hooks clearer and simpler. Now is the perfect time to re-explore how hooks, when used effectively, can help make component creation easier.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xstate-in-react-components">XState in React components<a href="#xstate-in-react-components" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>For those of you who are already using XState with React, you’re probably used to creating a machine using <code>createMachine()</code> and then passing that machine to the <code>useMachine</code> hook from within a component.</p><p>Here is the code from the <a href="https://xstate.js.org/docs/packages/xstate-react/#quick-start" target="_blank" rel="noopener noreferrer">Quick Start example</a> in the <code>@xstate/react</code> docs, where a <code>toggleMachine</code> (<a href="https://stately.ai/registry/editor/5e6286ca-5075-42da-9af8-99358530a0ac" target="_blank" rel="noopener noreferrer">view in the Editor</a>) is created with <code>createMachine()</code> and then passed to <code>useMachine()</code> for use in a <code>Toggler</code> component.</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token imports"> useMachine </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token imports"> createMachine </span><span class="token imports punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> toggleMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"toggle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"inactive"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    inactive</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"active"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    active</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"inactive"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">Toggler</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">toggleMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">button</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript function" style="color:rgb(0, 0, 255)">send</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"inactive"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Click to activate"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Active! Click to deactivate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">button</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This example shows how you can then evaluate <code>state.value</code> to render the corresponding UI for the toggle state and you can also call <code>send('TOGGLE')</code> in a button’s <code>onClick</code> handler to toggle the state.</p><p>Similarly, one could access other state methods and properties like <code>state.matches()</code>, <code>state.can()</code>, <code>state.hasTag()</code>, or even <code>state.context</code> to evaluate state and show the correct UI.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-custom-machine-hook">A custom machine hook<a href="#a-custom-machine-hook" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>But what if your component really doesn’t need access to all of those features when using a machine? That’s where the custom machine hook comes into play. We can still create a machine and pass it to the <code>useMachine</code> hook but this can all be done inside of the custom hook.</p><p>Here’s an example of what that custom hook might look like, including a <a href="https://codesandbox.io/s/usetogglemachine-example-1-lazy-machine-8zcbvs?file=/src/Toggler.tsx" target="_blank" rel="noopener noreferrer">React/TypeScript CodeSandbox version</a>:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useEffect </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> useToggleMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initialActive</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">boolean</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token builtin" style="color:rgb(0, 112, 193)">boolean</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">void</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"toggle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> initialActive </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"active"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"inactive"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        inactive</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"active"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        active</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"inactive"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> isActive </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"active"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">isActive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> toggle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="why-a-hook">Why a hook?<a href="#why-a-hook" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>Why might we opt for this extra layer of abstraction? Well, consider what we need to do in the example:</p><ol><li>Create the <code>toggleMachine</code>, including states and possible transitions.</li><li>Pass the machine to the <code>useMachine</code> hook.</li><li>Expose the most relevant pieces to our component.</li></ol><p>From this hook, we can expose a minimal interface to components. In fact, we don’t even need to export the machine at all. By encapsulating the XState code, we allow components to focus on their core task, rendering UI as a function of data/props. Sweet!</p><p>Our <code>useToggleMachine</code> hook now fully manages a toggle state for any component that uses it. This is now more resuable since a single component can create multiple instances of <code>useToggleMachine</code>. Similarly, multiple components can instantiate this hook one or more times to keep track of multiple, separate toggle states.</p><p>Related: If you’re wondering about how to create a global machine hook then have a look at this <a href="https://github.com/statelyai/rfcs/pull/8" target="_blank" rel="noopener noreferrer">RFC for a Global Hooks API</a>.</p><p>Let’s dive deeper into a the details of this <code>useToggleMachine</code> hook.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hook-params">Hook params<a href="#hook-params" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>If you recall, we initialized our machine to start out in its “inactive” state by specifying <code>initial: 'inactive'</code> in the machines config object. But we’re also receiving an <code>initialActive</code> value as the one and only argument passed into this hook. If that value is false or omitted, since it defaults to false, then the inital value will be in sync with the machine’s default state.</p><p>But what if we want to start out with <code>initialActive</code> passed in as <code>true</code>? We need a way to immediately transiton our machine away from its own initial state to be synchronized with the incoming <code>initialActive</code> value.</p><p>The original version of this post included an example that used the infamous <code>useEffect</code> hook to dynamically establish the initial state, based on the <code>initialActive</code> prop passed into the hook.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// This example is deprecated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">useEffect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">initialActive </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"inactive"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">initialActive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Some readers noted in their feedback that they prefer to avoid using the <code>useEffect</code> hook altogether for understandable reasons. The <code>state</code> really should be included in the dependency array to make the linter happy and using <code>useEffect</code> here feels generally awkward.</p><p>Instead, I've updated the example by wrapping the call to <code>createMachine</code> in a function passed to <code>useMachine</code>, utilizing a sort of <a href="https://xstate.js.org/docs/packages/xstate-react/#usemachine-machine-options" target="_blank" rel="noopener noreferrer">"lazily created machine"</a>.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"toggle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> initialActive </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"active"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"inactive"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      inactive</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"active"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      active</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"inactive"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This gives our machine config object access to the incoming <code>initialActive</code> prop so that we can dynamically assign the machine's initial value. It's a subtle but significant change.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> initialActive </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"active"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"inactive"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can read about alternative methods and proposals in our <a href="https://github.com/statelyai/rfcs/pull/9" target="_blank" rel="noopener noreferrer">RFC for input</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="return-values">Return values<a href="#return-values" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>We’ve looked at the input param for <code>useToggleMachine</code> so now let’s look at its return values.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> isActive </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"active"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">isActive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> toggle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We have a boolean <code>isActive</code> value which is derived from the state of the machine, the raison d’être of this hook. This is a simple mapping of one of two machine states to a boolean in this example. But you can imagine how states of a more complex machine might be derived from evaluating matches on the current state, possible next events, and even tags. Vist the <a href="https://xstate.js.org/docs/guides/states.html#state-methods-and-properties" target="_blank" rel="noopener noreferrer">docs on state methods</a> for details.</p><p>We also have a <code>toggle</code> function which enables us to toggle the state of the machine. It’s an anonymous function wrapping the call to XState’s <code>send('TOGGLE')</code>.</p><p>Our hook returns an array of just these values much like <code>useState</code> or <code>useMachine</code> would and they should be destructured in the component.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-hook-in-a-component">Using the hook in a component<a href="#using-the-hook-in-a-component" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>What does this look like for the <code>Toggler</code> component to now use our <code>useToggleMachine</code> hook? It looks pretty good!</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">Toggler</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">isActive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> toggle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useToggleMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// Or pass true.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">button</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">toggle</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text">Click me (</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">isActive </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"✅"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"❌"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain-text">)</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">button</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In that example, we use the value of <code>isActive</code> to specify the button’s text but it could easily be used for other purposes in this component or as a prop to pass down to child components.</p><p>For the <code>Toggler</code> component’s <code>onChange</code> handler, we set its value to be the <code>toggle</code> function. Since that is already wrapping XState’s <code>send('TOGGLE')</code> call, we don’t even need to use another anonymous function. It all just works as is, in a tidy functional style.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reusability">Reusability<a href="#reusability" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>As you can see, this pattern separates our normal React component code from our state machine implementation which keeps files neat and focused. Hooks make for more reusable machines across many components and in different situations. A <code>useToggleMachine</code> may be used to represent a toggle switch in one component but it might also represent the showing or hiding of UI or something else in another component.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">isAnimationEnabled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> toggleAnimation</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useToggleMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">isDarkMode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> toggleLightDarkMode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useToggleMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In a future blog post we can explore ways to compose machine hooks to build up more sophisticated machines from reusable parts, not unlike how small reusable functions are typically composed to create larger functions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="team-specialization">Team specialization<a href="#team-specialization" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>This separation of code also means that <strong>team members who are more familiar with XState can create and manage machine hooks</strong> with autonomy. Meanwhile, their teammates, who may be less familiar with state machines or with XState, can still rapidly churn out UI components that will, nevertheless, be backed by the power of state machines. This greatly <strong>facilitates incremental adoption</strong>. You can begin using XState in small bits and pieces right away, neither needing to design your entire application as a large statechart nor rewrite everything to fit that way of working.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="caveats">Caveats<a href="#caveats" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>If you only have one component and all you need to do is toggle a boolean flag, then creating a machine and a hook on top of that may feel like unnecessary ceremony. Splitting code into two different files has the usual tradeoffs. Also, understanding how changing the <code>initialActive</code> prop works with the state machine’s own internal state can be a bit tricky although we’d still need to transition the machine to a non-initial state, in a similar way, from within a component that calls <code>useMachine()</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>We saw a baseline example of how components traditionally employ the <code>useMachine</code> hook from <code>XState/react</code> with a <a href="https://codesandbox.io/s/usetogglemachine-example-1-lazy-machine-8zcbvs?file=/src/Toggler.tsx" target="_blank" rel="noopener noreferrer">complete example</a> of how to separate the machine into its own custom <code>useToggleMachine</code> hook for comparison. We covered implementation details for this hook, as well as how to wire it up in a React component. I’ve offered several benefits that I believe make this abstraction worthwhile like incremental adoption and future feature scaling.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next steps<a href="#next-steps" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Again, the toggle example is a small yet usable example for creating a machine with XState and wrapping it in a hook. But we can take this even further. What about <strong>combining multiple machines</strong> into a single hook? How about <strong>overriding machine implmentation details</strong> via hooks on a per use basis? I’ll be exploring these patterns and more in some upcoming blog posts so stay tuned!</p><p>In the meantime, if you like using XState then keep creating your own machines and try wrapping those in custom hooks to use in your components. Additonally, you can build upon machine/hook examples in these posts for your own purposes and even find machines in the <a href="https://stately.ai/registry/discover" target="_blank" rel="noopener noreferrer">Discovery section of the Stately Studio</a> and turn those into hooks. Whatever path you take, I hope you <strong>get hooked on using XState</strong> to make your UI more robust and more reusable!</p>]]></content:encoded>
            <category>component</category>
            <category>hook</category>
            <category>stately</category>
            <category>xstate</category>
            <category>react</category>
            <category>state machine</category>
            <category>prop</category>
        </item>
        <item>
            <title><![CDATA[What’s new in July 2022?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-07-06-whats-new-july-2022</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-07-06-whats-new-july-2022</guid>
            <pubDate>Wed, 06 Jul 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Search for machines, pinch to zoom, nest typegen files and more! Find out the latest features in the Stately editor and XState VS Code extension.]]></description>
            <content:encoded><![CDATA[<p>On top of our usual minor improvements and bug fixes, we’ve got great new features to share with you in July!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="search-for-machines">Search for machines<a href="#search-for-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Thanks to Anders’ hard work, the <a href="https://stately.ai/registry/discover" target="_blank" rel="noopener noreferrer">Discover page</a> now has a fully-featured search where you can find and filter through all the machines our community has made.</p><p>The filters can limit your search by source, features and number of states.</p><p><img loading="lazy" alt="The discover page showing 101 search results for the “auth” keyword, each with the word “auth” highlighted in the title. The search is filtered by the Editor source, and also has the option to filter by features entry actions, exit actions, final states, guards, invoke, and parallel states." src="/statelyai-docs/assets/images/2022-07-06-search-962ff461b46cd04b2bf6b7788be6ae13.png" width="2052" height="1858" class="img_ev3q"></p><p>We have more planned for search in the future that we can’t wait to share with you.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pinch-to-zoom">Pinch to zoom<a href="#pinch-to-zoom" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Trackpad fans rejoice; you can now pinch to zoom in and out to navigate the editor’s canvas by touch. This feature was a popular request at a workshop Matt gave, so he implemented it the following day! If you prefer a keyboard or mouse, you can also use the zoom in and out buttons or the <strong>+</strong> and <strong>-</strong> keyboard shortcuts.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nesting-typegen-files">Nesting typegen files<a href="#nesting-typegen-files" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You’re missing out if you’re not using <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">our XState VS Code extension</a> yet! After a top tip from our friend Erik Rasmussen, Anders added the feature to our VS Code extension. Read <a href="/statelyai-docs/blog/nesting-typegen-files">Anders’ blog post on nesting XState typegen files</a> for more details.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="labels-on-quick-action-buttons">Labels on quick action buttons<a href="#labels-on-quick-action-buttons" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The quick action buttons for adding states and guarded transitions are now labeled with <strong>+ State</strong> and <strong>+ Guard</strong> to make the buttons’ function clearer. Improvements that make the editor’s interface easier to understand and use are a priority for us, and we appreciate any feedback you have for improvements that would benefit you.</p><p><img loading="lazy" alt="A state with quick action buttons labeled “+ state” and “x” to delete the state. And an event with quick action buttons labeled “+ guard“ and “x” to delete the event." src="/statelyai-docs/assets/images/2022-07-06-labeled-buttons-273bbd60ff00b9608f3b49a3de6cb403.png" width="2484" height="972" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-upcoming-features">More upcoming features<a href="#more-upcoming-features" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve got many more features coming up. Watch <a href="https://www.youtube.com/watch?v=4v_M3HcZc3U" target="_blank" rel="noopener noreferrer">our office hours from last week</a> and <a href="https://www.youtube.com/watch?v=qmbeYvcA3Ks" target="_blank" rel="noopener noreferrer">office hours from June 24</a> for demos of <a href="https://www.youtube.com/watch?v=qmbeYvcA3Ks&amp;t=530s" target="_blank" rel="noopener noreferrer">smoother transition lines</a>, <a href="https://www.youtube.com/watch?v=4v_M3HcZc3U&amp;t=1214s" target="_blank" rel="noopener noreferrer">fit to content on initial render</a> and <a href="https://www.youtube.com/watch?v=4v_M3HcZc3U&amp;t=208s" target="_blank" rel="noopener noreferrer">parity between XState and the Stately editor</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="suggest-features-and-help-us-prioritize-our-roadmap">Suggest features and help us prioritize our roadmap<a href="#suggest-features-and-help-us-prioritize-our-roadmap" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve also started using Canny to collect your feedback and help us prioritize planned features in the last month. If there’s anything you want from XState or our Stately tools, please create a post or <a href="https://feedback.stately.ai" target="_blank" rel="noopener noreferrer">upvote and give feedback on proposed features</a>.</p><p>Visit <a href="https://feedback.stately.ai" target="_blank" rel="noopener noreferrer">our Canny roadmap</a> to make feature requests, submit feedback, view the roadmap and vote on features.</p><p><img loading="lazy" alt="The Stately roadmap showing options to give feedback on the Editor, XState, Documentation, Workflows, Devtools and Registry, as well as a roadmap showing Planned, In Progress and Complete features" src="/statelyai-docs/assets/images/2022-07-06-canny-7f3262bff791414104c94f6e26dbf431.png" width="2100" height="1680" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-videos-on-our-youtube-channel">New videos on our YouTube channel<a href="#new-videos-on-our-youtube-channel" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Matt has made five great videos for <a href="https://www.youtube.com/statelyai" target="_blank" rel="noopener noreferrer">our YouTube channel</a> to help you learn about using XState. Join our 1000+ subscribers and find out more about:</p><ul><li><a href="https://www.youtube.com/watch?v=AQHpXDo_S1k" target="_blank" rel="noopener noreferrer">How XState scales to ANY requirement</a></li><li><a href="https://www.youtube.com/watch?v=qqyQGEjWSAw" target="_blank" rel="noopener noreferrer">XState in the backend</a></li><li><a href="https://www.youtube.com/watch?v=Xa0H-vf2VuQ" target="_blank" rel="noopener noreferrer">Complex forms in XState &amp; React</a></li><li><a href="https://www.youtube.com/watch?v=EIi6CV4Bc_Q" target="_blank" rel="noopener noreferrer">Is XState good with TypeScript?</a></li><li><a href="https://www.youtube.com/watch?v=FrNXCJa5FLs" target="_blank" rel="noopener noreferrer">How to decide between useState, useReducer and XState</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="please-give-us-feedback-in-our-yearly-survey">Please give us feedback in our yearly survey<a href="#please-give-us-feedback-in-our-yearly-survey" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>And finally, <a href="https://stately.ai/survey" target="_blank" rel="noopener noreferrer">the Stately 2022 survey</a> is out, and we would love you to add your response to help us make our tools work for you. All the questions are optional, and it will take just five minutes of your time.</p>]]></content:encoded>
            <category>stately</category>
            <category>xstate</category>
            <category>announcement</category>
            <category>editor</category>
            <category>search</category>
            <category>typegen</category>
            <category>survey</category>
            <category>roadmap</category>
        </item>
        <item>
            <title><![CDATA[What is XState used for?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-06-21-what-is-xstate-used-for</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-06-21-what-is-xstate-used-for</guid>
            <pubDate>Tue, 21 Jun 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[XState can be used wherever JavaScript runs, whether on the backend or frontend. Because the code it creates can be visualized, it’s great at handling complex use cases.]]></description>
            <content:encoded><![CDATA[<p>XState can be used wherever JavaScript runs, whether on the backend or frontend. Because the code it creates can be visualized, it’s great at handling complex use cases - being able to see what a complex piece of code does can be extremely useful.</p><p>Let’s look at each use case one-by-one.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="on-the-web">On the web<a href="#on-the-web" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>XState can be used in any frontend application to manage state. It has first-class integrations for <a href="https://reactjs.org/" target="_blank" rel="noopener noreferrer">React</a>, <a href="https://vuejs.org/" target="_blank" rel="noopener noreferrer">Vue</a>, <a href="https://svelte.dev/" target="_blank" rel="noopener noreferrer">Svelte</a>, as well as an upcoming <a href="https://www.solidjs.com/" target="_blank" rel="noopener noreferrer">Solid</a> integration. It also works well in <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer">Angular</a> without any integrations needed.</p><p>You can try it in a Vanilla JS app by running this simple piece of code:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> interpret </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"waiting"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    waiting</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      after</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">2000</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"alerted"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    alerted</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">entry</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">alert</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"Hello from the state machine!"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this example, the machine will wait for 2 seconds, then call <code>alert()</code> to let you know it’s alive.</p><p>There are plenty of ways XState can be used on the frontend - let’s talk about two of the most common patterns:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="complex-components">Complex components<a href="#complex-components" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Most frontend apps split their code into components - individual pieces which can be reused across the app. If need to build a complex component, you can use XState to co-ordinate it.</p><p>A great example of this is the library <a href="https://zagjs.com/components/react/accordion" target="_blank" rel="noopener noreferrer">Zag.js</a>, which is using XState-style syntax and statecharts to build reusable components across frameworks. You can even <a href="https://state-machine-viz.vercel.app/accordion" target="_blank" rel="noopener noreferrer">see them visualized</a> using Stately’s tools.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="global-state">Global state<a href="#global-state" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>You can also use XState to manage global state in your apps. A common pattern is the <a href="https://facebook.github.io/flux/docs/in-depth-overview/" target="_blank" rel="noopener noreferrer">Flux</a> architecture, where you dispatch events to a single top-level store. Parts of your app can subscribe to updates from that store, using <a href="https://redux.js.org/usage/deriving-data-selectors" target="_blank" rel="noopener noreferrer">selectors</a>.</p><p>XState can <strong>replace global state managers like <a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer">Redux</a> or <a href="https://vuex.vuejs.org/" target="_blank" rel="noopener noreferrer">Vuex</a></strong>, with one major benefit - your global state can be visualised and <a href="https://stately.ai/editor" target="_blank" rel="noopener noreferrer">visually edited</a>. XState gives you the ability to create a global store, dispatch events to it, and subscribe to only the pieces that matter. See our specific instructions in <a href="https://xstate.js.org/docs/recipes/react.html#global-state-react-context" target="_blank" rel="noopener noreferrer">React</a> for more info.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nativeextensions">Native/extensions<a href="#nativeextensions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>XState is also extremely useful in <a href="https://reactnative.dev/" target="_blank" rel="noopener noreferrer">React Native</a> or <a href="https://www.electronjs.org/" target="_blank" rel="noopener noreferrer">Electron</a> apps, Browser extensions and IDE extensions. Since XState doesn’t use any browser API’s, you can use it anywhere JavaScript runs.</p><p>For instance, we use XState at Stately to <a href="https://github.com/statelyai/xstate-tools/blob/6a91d6a5cdd4cf73c882175a2ad5fbe3b2a9910d/apps/extension/client/src/editorWebviewScript.ts#L90" target="_blank" rel="noopener noreferrer">co-ordinate our VSCode extension</a>. <a href="https://www.centered.app/" target="_blank" rel="noopener noreferrer">Centered</a> uses XState extensively in their Electron and React Native apps to co-ordinate timers, control app updates and handle complex user interactions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="backend">Backend<a href="#backend" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You can use XState in <a href="https://nodejs.org/en/" target="_blank" rel="noopener noreferrer">Node.js</a> or <a href="https://deno.land/" target="_blank" rel="noopener noreferrer">Deno</a> to build <a href="https://vercel.com/docs/concepts/functions/serverless-functions" target="_blank" rel="noopener noreferrer">serverless functions</a> or persistent servers.</p><p>For lambda functions, XState exposes a function called <a href="https://xstate.js.org/docs/guides/interpretation.html#waitfor" target="_blank" rel="noopener noreferrer"><code>waitFor</code></a>, which allows you to wait for a state machine to be in a certain state. This allows you to use XState inside <code>async</code> functions with ease.</p><p>To learn more about XState in the backend, see our <a href="https://www.youtube.com/watch?v=qqyQGEjWSAw" target="_blank" rel="noopener noreferrer">recent video</a> introducing the topic.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="scripting-and-clis">Scripting and CLIs<a href="#scripting-and-clis" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>XState can be used when running scripts or CLIs to co-ordinate long-running processes.</p><p>The most famous example of this in the wild is the frontend framework <a href="https://www.gatsbyjs.com/" target="_blank" rel="noopener noreferrer">Gatsby</a>. They use XState in their build process and development server to co-ordinate file-system changes and parallelize multiple processes. This means their entire build system is visualisable - an incredibly boon for such a complex process.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>XState works anywhere JS runs - and folks are using it in the wild for <em>all sorts</em> of use cases. Any time you’re building something that feels remotely complex, you can use XState to simplify your code and enable powerful visual tooling.</p>]]></content:encoded>
            <category>xstate</category>
            <category>react</category>
            <category>node</category>
            <category>vue</category>
            <category>redux</category>
        </item>
        <item>
            <title><![CDATA[Nesting XState typegen files]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/nesting-typegen-files</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/nesting-typegen-files</guid>
            <pubDate>Mon, 13 Jun 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[What is file nesting in VS Code and how to enable it for XState's generated type files.]]></description>
            <content:encoded><![CDATA[<p>Our latest update to the <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">XState VS Code extension</a> has made it easy to enable file nesting for typegen files. But what is file nesting?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="explorer-file-nesting">Explorer file nesting<a href="#explorer-file-nesting" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><a href="https://code.visualstudio.com/updates/v1_67#_explorer-file-nesting" target="_blank" rel="noopener noreferrer">VS Code introduced file nesting</a> in version 1.67 back in April of 2022. This feature is elegant as it allows you to group related files in the explorer view of VS Code.</p><p>Our friend Erik Rasmussen quickly found this feature works well with the generated type files for XState. Thanks to Erik for his great idea!</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="show-me">Show me<a href="#show-me" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The image below shows the explorer in VS Code without file nesting enabled; you have a machine source file alongside a generated type file for that machine.</p><p><img loading="lazy" alt="The source file in the VS Code explorer called coolMachine.ts is listed above the typegen file called coolMachine.typegen.ts." src="/statelyai-docs/assets/images/without-typegen-b73c7f15684b1a7257705c56b00a624b.png" width="2424" height="1150" class="img_ev3q"></p><p>After enabling file nesting for typegen files, VS Code explorer allows you to nest and collapse the generated file under the source file.</p><p><img loading="lazy" alt="Pressing the arrow icon toggle alongside the source file toggles the nesting of the generated type file." src="/statelyai-docs/assets/images/with-typegen-10d29bc7110a3dea9f2f162fe1a2ad42.gif" width="1200" height="656" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enable-nesting">Enable nesting<a href="#enable-nesting" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>If you’re using our VS Code extension and haven’t manually enabled file nesting for typegen files, you will see a helper prompt allowing you to enable file nesting with a click.
The prompt will show when you open a file with a machine.
If you miss the prompt, you can enable or disable file nesting as described in the next section.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="disable-nesting">Disable nesting<a href="#disable-nesting" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>You can disable, or enable, the file nesting by using the <code>Xstate: Nest Typegen Files</code> toggle in your VS Code settings.
<img loading="lazy" alt="The Extensions settings view in VS Code has XState settings including the option to enable nesting the generated typegen files." src="/statelyai-docs/assets/images/xstate-vscode-settings-bbce7ae42cb6f7d3a1c58055a1e0ce85.png" width="2008" height="1278" class="img_ev3q"></p><p>PS: If you’re unsure what typegen is in XState, <a href="/statelyai-docs/blog/2022-01-27-introducing-typegen">read this post where we introduced TypeScript typegen for XState</a>.</p>]]></content:encoded>
            <category>stately</category>
            <category>extension</category>
            <category>open source</category>
            <category>xstate</category>
            <category>vscode</category>
        </item>
        <item>
            <title><![CDATA[What’s new in June 2022?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-06-07-whats-new-june-2022</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-06-07-whats-new-june-2022</guid>
            <pubDate>Tue, 07 Jun 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Updates to XState, @xstate/test and the Stately editor in the last month.]]></description>
            <content:encoded><![CDATA[<p>We’ve had a busy month and have plenty to share with you this June!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="another-stately-update">Another Stately update<a href="#another-stately-update" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In May, we welcomed three new people to the Stately team. Kevin Maes and Anders Mellson join us as engineers, and Nick Perich as our product designer. Watch all three of them introduce themselves in <a href="https://youtu.be/4WwaSZ-ciRI?t=127" target="_blank" rel="noopener noreferrer">our office hours live stream from May 20</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="xstate-test-v1-alpha">XState Test v1 alpha<a href="#xstate-test-v1-alpha" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Last week we released an alpha version of the XState Test package.</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><ul><li>Read more in the <a href="https://graph-docs.vercel.app/model-based-testing/intro" target="_blank" rel="noopener noreferrer">model-based testing section in our alpha docs</a>.</li><li>Find the <a href="https://github.com/statelyai/xstate/releases/tag/%40xstate%2Ftest%401.0.0-alpha.0" target="_blank" rel="noopener noreferrer">XState test tag release notes on GitHub</a>.</li><li><a href="https://twitter.com/statelyai/status/1531250605313892352" target="_blank" rel="noopener noreferrer">Watch the video above on Twitter</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="light-mode-in-the-stately-visual-editor">Light mode in the Stately visual editor<a href="#light-mode-in-the-stately-visual-editor" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Nick and Anders got straight to work in their first week at Stately, creating light mode for the visual editor. We will keep improving both light mode and dark mode in the future, but we thought the initial designs were too good not to share with everyone!</p><p><img loading="lazy" alt="A dark mode light mode state machine in the Stately editor show in light mode." src="/statelyai-docs/assets/images/light-mode-d85767417d9a8b6c55e2f51ff0928f26.png" width="1420" height="780" class="img_ev3q"></p><p>Toggle “Switch to light mode” in the editor’s menu to view the editor in light mode. Toggle “Switch to dark mode” to switch back to dark mode.</p><p><img loading="lazy" alt="A dark mode light mode state machine in the Stately editor show in dark mode." src="/statelyai-docs/assets/images/dark-mode-141d306b339d91419c0afbd2225ffba0.png" width="1420" height="780" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="and-theres-more-to-come">And there’s more to come!<a href="#and-theres-more-to-come" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Want to know more about what we’ve got planned? <a href="https://xstate.js.org/docs/roadmap/" target="_blank" rel="noopener noreferrer">Check out our Roadmap</a>. Got any feedback or want to suggest features? <a href="https://github.com/statelyai/xstate/discussions" target="_blank" rel="noopener noreferrer">Share your thoughts in the XState discussions</a>.</p><p>We’re also looking for your feedback on XState snippets, errors in XState, and more in our <a href="https://github.com/statelyai/rfcs" target="_blank" rel="noopener noreferrer">Stately RFCs (Requests for comments)</a>.</p>]]></content:encoded>
            <category>stately</category>
            <category>xstate</category>
            <category>announcement</category>
            <category>release</category>
            <category>lightmode</category>
            <category>xstate test</category>
        </item>
        <item>
            <title><![CDATA[What’s new in May 2022?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-05-03-whats-new-may-2022</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-05-03-whats-new-may-2022</guid>
            <pubDate>Tue, 03 May 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Updates to XState, @xstate/react and @xstate/fsm in the last month.]]></description>
            <content:encoded><![CDATA[<p>What’s new to XState and Stately for May 2022?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="updates-in-xstate">Updates in XState<a href="#updates-in-xstate" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>With a few updates to @xstate/react and @xstate/fsm last month, our headline release was the <code>waitFor()</code> helper function.</p><p>Read all the release notes and patch notes in the <a href="https://github.com/statelyai/xstate/releases" target="_blank" rel="noopener noreferrer">XState GitHub repository releases</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="waitfor"><code>waitFor()</code><a href="#waitfor" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The new <code>waitFor(...)</code> helper function asynchronously waits for an actor’s emitted value to satisfy a predicate before a timeout.</p><p>Example usage:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> waitFor </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'xstate/lib/waitFor'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> loginService </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">interpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">loginMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">start</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> loggedInState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">waitFor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">loginService</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> state </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">hasTag</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'loggedIn'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">loggedInState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">hasTag</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">'loggedIn'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="updates-in-the-xstatereact-package">Updates in the @xstate/react package<a href="#updates-in-the-xstatereact-package" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The @xstate/react package contains utilities for using XState with React. Find out more in the <a href="https://github.com/statelyai/xstate/tree/main/packages/xstate-react" target="_blank" rel="noopener noreferrer">@xstate/react package readme</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="react-18">React 18<a href="#react-18" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The @xstate/react package now accepts React 18 as a peer dependency, and we rewrote the implementation to use the <code>use-sync-external-store</code> package. The package uses a shim to keep compatibility with older versions of React, so there is no need to worry if you haven’t upgraded yet.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="subscribing-to-stopped-interpreters">Subscribing to stopped interpreters<a href="#subscribing-to-stopped-interpreters" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>Subscribing to a stopped interpreter will now always immediately emit the interpreter’s state and call a completion callback.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="aseffect-and-aslayouteffect-removed"><code>asEffect</code> and <code>asLayoutEffect</code> removed<a href="#aseffect-and-aslayouteffect-removed" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>We have removed the <code>asEffect</code> and <code>asLayoutEffect</code> action creators. These action creators didn’t fit the React model well and had the potential to cause issues as their existence suggested that they might be easy to use.</p><p>If you want to execute actions at those exact times, you can either make a call directly from those effects or send events to the machine from those effects and execute explicit actions in response to said events.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="usemachine-and-useservice-with-xstatefsm"><code>useMachine</code> and <code>useService</code> with @xstate/fsm<a href="#usemachine-and-useservice-with-xstatefsm" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>We changed the signatures of <code>useMachine</code> and <code>useService</code> integrating with @xstate/fsm to match their signatures with their related hooks integrating with XState. Both now only accept a single generic. <code>useMachine</code> accepts <code>TMachine</code>, and <code>useService</code> accepts <code>TService</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="updates-in-the-xstatefsm-package">Updates in the @xstate/fsm package<a href="#updates-in-the-xstatefsm-package" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>@xstate/fsm is a minimal, 1kb implementation of XState for finite state machines. Find out more in the <a href="https://github.com/statelyai/xstate/tree/main/packages/xstate-fsm" target="_blank" rel="noopener noreferrer">@xstate/fsm package readme</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="start"><code>.start()</code><a href="#start" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>When you call .start() without any argument, it now always starts from the machine’s initial state, matching the behavior of XState itself.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-coming-soon">More coming soon!<a href="#more-coming-soon" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you want to know more about what we’ve got planned, you can <a href="https://xstate.js.org/docs/roadmap/" target="_blank" rel="noopener noreferrer">check out our Roadmap</a>. Got any feedback, or want to suggest features? <a href="https://github.com/statelyai/xstate/discussions" target="_blank" rel="noopener noreferrer">Share your thoughts in the XState discussions</a>.</p><p>We’re also looking for your feedback on specific ideas in our <a href="https://github.com/statelyai/rfcs" target="_blank" rel="noopener noreferrer">Stately RFCs (Requests for comment)</a>.</p>]]></content:encoded>
            <category>stately</category>
            <category>xstate</category>
            <category>announcement</category>
            <category>release</category>
        </item>
        <item>
            <title><![CDATA[Building a video player with XState and Stately tools]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022/04/05/building-a-video-player</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022/04/05/building-a-video-player</guid>
            <pubDate>Tue, 05 Apr 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[A few weeks ago we uploaded a new video to the Stately YouTube channel showing how you can build basic video player functionality using XState and Stately tools.]]></description>
            <content:encoded><![CDATA[<p>A few weeks ago we uploaded a new video to the <a href="http://youtube.com/c/statelyai" target="_blank" rel="noopener noreferrer">Stately YouTube channel</a> showing how you can build basic video player functionality using XState and Stately tools. You can watch the video below or <a href="/statelyai-docs/#video-chapters">use the chapter links</a> to jump to the chapter you want to watch.</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="video-chapters">Video chapters<a href="#video-chapters" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ul><li><a href="https://www.youtube.com/watch?v=3wZBSeLxVEw&amp;t=0s" target="_blank" rel="noopener noreferrer">0:00</a> What we want to build</li><li><a href="https://www.youtube.com/watch?v=3wZBSeLxVEw&amp;t=172s" target="_blank" rel="noopener noreferrer">2:52</a> Modeling the video player</li><li><a href="https://www.youtube.com/watch?v=3wZBSeLxVEw&amp;t=583s" target="_blank" rel="noopener noreferrer">9:43</a> Implementing the state machine</li><li><a href="https://www.youtube.com/watch?v=3wZBSeLxVEw&amp;t=1189s" target="_blank" rel="noopener noreferrer">19:49</a> Modeling with the visual editor</li><li><a href="https://www.youtube.com/watch?v=3wZBSeLxVEw&amp;t=1330s" target="_blank" rel="noopener noreferrer">22:10</a> Editing the state machine</li><li><a href="https://www.youtube.com/watch?v=3wZBSeLxVEw&amp;t=1505s" target="_blank" rel="noopener noreferrer">25:05</a> Editing the state machine in the visual editor</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="we-want-your-suggestions-and-feedback">We want your suggestions and feedback<a href="#we-want-your-suggestions-and-feedback" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Please let us know what we should demo for you! Share your feedback or suggestions in <a href="https://github.com/statelyai/xstate/discussions" target="_blank" rel="noopener noreferrer">our GitHub Discussions</a>, <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">our Discord</a> or <a href="https://twitter.com/statelyai" target="_blank" rel="noopener noreferrer">Twitter</a>.</p>]]></content:encoded>
            <category>xstate</category>
            <category>modeling</category>
            <category>tutorial</category>
        </item>
        <item>
            <title><![CDATA[Introducing the new Stately Roadmap]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-03-29-introducing-the-new-stately-roadmap</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-03-29-introducing-the-new-stately-roadmap</guid>
            <pubDate>Tue, 29 Mar 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[We’ve added a Roadmap to our Documentation, so you know what we’re currently working on and what features are coming up soon.]]></description>
            <content:encoded><![CDATA[<p>This week we’ve added <a href="https://xstate.js.org/docs/roadmap" target="_blank" rel="noopener noreferrer">our Roadmap</a> to the XState documentation.</p><p>Many of you have requested a roadmap to help you determine if it’s the right time to integrate XState and Stately tools into your team’s workflow. We’ve added a simple Roadmap so you know what we’re currently working on and what features are coming up soon.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upcoming-features">Upcoming features<a href="#upcoming-features" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>To give you an idea of what we’re working on, below are the features currently planned for April - June 2022.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xstate">XState<a href="#xstate" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><ul><li>XState v5 Alpha</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="editor">Editor<a href="#editor" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><ul><li>Billing and Teams</li><li>Feature parity with XState</li><li>Authentication bug fixes</li><li>Welcome emails</li><li>Inline editing</li><li>Simulation mode</li><li>Markdown descriptions</li><li>Workflow creation</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="documentation">Documentation<a href="#documentation" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><ul><li>Stately tools visibility</li><li>Update and rework</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="please-give-us-your-feedback-and-suggestions">Please give us your feedback and suggestions<a href="#please-give-us-your-feedback-and-suggestions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We prioritize features based on your feedback. Please let us know if you have feedback or suggestions in <a href="https://github.com/statelyai/xstate/discussions" target="_blank" rel="noopener noreferrer">our GitHub Discussions</a>, <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">our Discord</a> or on <a href="https://twitter.com/statelyai" target="_blank" rel="noopener noreferrer">Twitter</a>.</p>]]></content:encoded>
            <category>stately</category>
            <category>roadmap</category>
            <category>introduction</category>
        </item>
        <item>
            <title><![CDATA[Stately is hiring!]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022/03/28/stately-is-hiring</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022/03/28/stately-is-hiring</guid>
            <pubDate>Mon, 28 Mar 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[We’re hiring for a frontend engineer, backend engineer, developer advocate and product designer at Stately.]]></description>
            <content:encoded><![CDATA[<p>We’re hiring for a frontend engineer, backend engineer, developer advocate and product designer at Stately. You can <a href="https://statelyai.notion.site/Careers-at-Stately-db3d704abd8f41058e5361e5ab9c1098" target="_blank" rel="noopener noreferrer">check out the Careers at Stately page on Notion</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-stately">About Stately<a href="#about-stately" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Stately is building <strong>the visual future of software development.</strong></p><p>At Stately, we want to make app and business logic accessible to the entire team and eliminate barriers between development, design, and product to make it easier to build and maintain complex applications quickly and robustly.</p><p>We enable development teams to collaborate effectively on even the most complex logic and flows with visual tools and insightful services. Helping them speak a common language so that the specifications, designs, and code are always synchronized, up-to-date, and visually clear.</p><p>We’re building a team inspired to work on this mission to make software development better for everyone and practice what we preach, both inside Stately and everywhere else.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="questions-from-our-office-hours--stream-last-week">Questions from our office hours  stream last week<a href="#questions-from-our-office-hours--stream-last-week" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>During <a href="https://www.youtube.com/watch?v=zYCnVkaUT3w" target="_blank" rel="noopener noreferrer">our office hours live stream last week</a>, we answered questions about working with Stately. You can find the questions and links to the timecode with our responses below.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-the-job-listings">About the job listings<a href="#about-the-job-listings" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><ul><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=826s" target="_blank" rel="noopener noreferrer">What are the responsibilities of the product designer role?</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=943s" target="_blank" rel="noopener noreferrer">What is the hiring process?</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1627s" target="_blank" rel="noopener noreferrer">What is the definition of a senior developer? (And other roles)</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1175s" target="_blank" rel="noopener noreferrer">Is there a trial period?</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-stately-1">About Stately<a href="#about-stately-1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><ul><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1115s" target="_blank" rel="noopener noreferrer">When was the company founded, and how are you financially sustainable?</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=705s" target="_blank" rel="noopener noreferrer">What exciting projects would you be working on at Stately?</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-the-stately-team">About the Stately team<a href="#about-the-stately-team" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><ul><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1225s" target="_blank" rel="noopener noreferrer">How many people are on the Stately team?</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1313s" target="_blank" rel="noopener noreferrer">Should I apply if I feel underqualified? What would help me get the role in the future?</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1969s" target="_blank" rel="noopener noreferrer">How well can Stately support neurodivergent people?</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-timezones-and-locations">About timezones and locations<a href="#about-timezones-and-locations" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><ul><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=806s" target="_blank" rel="noopener noreferrer">Are these jobs remote? Yes!</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1753s" target="_blank" rel="noopener noreferrer">Which timezones do Stately currently work within?</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1802s" target="_blank" rel="noopener noreferrer">Where are you folks based?</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="about-the-day-to-day-at-stately">About the day-to-day at Stately<a href="#about-the-day-to-day-at-stately" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><ul><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1364s" target="_blank" rel="noopener noreferrer">What does team collaboration look like at Stately?</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1845s" target="_blank" rel="noopener noreferrer">What is the work culture like from an insider perspective?</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1441s" target="_blank" rel="noopener noreferrer">Are there a lot of video calls at Stately?</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=1508s" target="_blank" rel="noopener noreferrer">What is the balance of sync vs. async collaboration at Stately?</a></li><li><a href="https://www.youtube.com/watch?v=zYCnVkaUT3w&amp;t=2029s" target="_blank" rel="noopener noreferrer">What is a good day at Stately vs. a bad day at Stately?</a></li></ul>]]></content:encoded>
            <category>stately</category>
            <category>hiring</category>
        </item>
        <item>
            <title><![CDATA[Stately Changelog #1 - Snap To Elements]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-03-23-stately-changelog-1</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-03-23-stately-changelog-1</guid>
            <pubDate>Wed, 23 Mar 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[The Stately Editor changelog is where we discuss new features released to the Stately Editor beta.]]></description>
            <content:encoded><![CDATA[<p>Happy Wednesday! Time for our first Editor Changelog blog, where we’ll talk about the new updates we’ve shipped in the editor.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="snap-to-elements">Snap To Elements<a href="#snap-to-elements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>When you’re placing states and events in the canvas, you’ll now be able to snap them to surrounding elements.</p><p>Snapping is a hugely requested feature and should help make your charts neater and more legible.</p><p>So far, we’ve implemented snapping to the <em>center</em> of elements only. We’re keen to <a href="https://github.com/statelyai/editor-feedback/issues" target="_blank" rel="noopener noreferrer">hear your feedback</a> if you want more snapping!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="right-click-menu">Right-click menu<a href="#right-click-menu" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You can now right-click events and states to perform actions including:</p><ul><li>Renaming states/events</li><li>Making states the 'initial' state</li><li>Adding guards</li><li>Turning events into self-transitions</li></ul><p>And many more.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="visual-update-for-events">Visual update for events<a href="#visual-update-for-events" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve streamlined the way our events look to make them more visually distinct from states. This new look keeps the focus on the arrow, the direction of travel, and the flow of the chart.</p><p><img loading="lazy" alt="Statechart depicting the states of a Matt machine. The states are displayed as large rectangles with slightly rounded corners and lighter grey backgrounds. The events are displayed as smaller pill-shaped rounded rectangles with darker grey backgrounds." src="/statelyai-docs/assets/images/changelog-1-events-f27173d07e35f9824173c3e8f492037e.png" width="1201" height="589" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements-to-vscode-output">Improvements to VSCode output<a href="#improvements-to-vscode-output" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve massively improved the way we handle transition targets in VSCode. Instead of every transition having an ugly <code>#(machine).state1.state2</code>, the VSCode extension will now make the most idiomatic choice out of <code>targetState</code>, <code>.targetState</code>, or <code>targetState.child</code>.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"a"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">EVENT</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// Before</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"#(machine).b"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"a"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">EVENT</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// After</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"b"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As part of this work, we’ve also improved how we handle <code>internal</code> - you’ll now get proper warnings inside the visual editor when you use <code>internal</code> incorrectly.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="other-improvements">Other Improvements<a href="#other-improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’ve been hard at work fixing bugs in the VSCode extension and the CLI. You can keep up to date with those changes in our <a href="https://github.com/statelyai/xstate-tools/releases" target="_blank" rel="noopener noreferrer"><code>xstate-tools</code></a> repo.</p>]]></content:encoded>
            <category>stately</category>
            <category>announcement</category>
            <category>editor</category>
            <category>beta</category>
            <category>changelog</category>
        </item>
        <item>
            <title><![CDATA[Introducing the new Stately homepage]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-03-16-introducing-the-new-stately-homepage</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-03-16-introducing-the-new-stately-homepage</guid>
            <pubDate>Wed, 16 Mar 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Last week we launched the new Stately homepage, which we hope will make it easy to understand what Stately and XState are and help you convince your team to use state machines.]]></description>
            <content:encoded><![CDATA[<p>Last week we launched <a href="https://stately.ai" target="_blank" rel="noopener noreferrer">the new Stately homepage</a>, which we hope will make it easy to understand what Stately and XState are and help you convince your team to use state machines.</p><p>You can watch us talk about the new design and its implementation during <a href="https://youtu.be/WoPCd4D--Gk?t=771" target="_blank" rel="noopener noreferrer">last week’s office hours</a>. I’m particularly impressed by David’s SVG arrows!</p><p>And if you have any feedback about the homepage, please let us know on <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">our Discord</a>. We always appreciate your thoughts.</p>]]></content:encoded>
            <category>stately</category>
            <category>homepage</category>
            <category>introduction</category>
        </item>
        <item>
            <title><![CDATA[Open VSX XState VSCode extension now available]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022/03/11/xstate-vscode-extension-now-available-on-the-open-vsx-registry</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022/03/11/xstate-vscode-extension-now-available-on-the-open-vsx-registry</guid>
            <pubDate>Tue, 15 Mar 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[If you use VSCodium, Coder, Gitpod or another editor with VSCode-compatible extensions, you can now install the XState VSCode extension.]]></description>
            <content:encoded><![CDATA[<p>If you use VSCodium, Coder, Gitpod or another editor with VSCode-compatible extensions, you can now <a href="https://open-vsx.org/extension/statelyai/stately-vscode" target="_blank" rel="noopener noreferrer">install the XState VSCode extension from the Open VSX Registry</a>.</p><p>We released our <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">XState VSCode extension</a> a few weeks ago, which gives you visual editing, autocomplete, typegen and linting for XState. The same extension is now available for VSCodium, Coder and Gitpod, and any other editors with VSCode-compatible extensions through the Open VSX Registry.</p><p>We had many requests to distribute the extension on the Open VSX Registry. As a person who uses <a href="https://vscodium.com" target="_blank" rel="noopener noreferrer">VSCodium</a> myself, it was exciting to install the extension from inside VSCodium.</p><ol><li>Open the command palette in VSCodium with <code>shift</code> + <code>cmd/ctrl</code> + <code>p</code>.</li><li>Search for the <strong>Install Extensions</strong> command and hit enter to open the Extensions search.</li><li>Search for <strong>XState</strong> to find the XState VSCode extension and install the extension using the <strong>Install</strong> button.</li><li>Once you have installed the extension, you can find the extension commands by searching for <strong>XState</strong> in the command palette.</li></ol><p>You can also <a href="https://open-vsx.org/extension/statelyai/stately-vscode" target="_blank" rel="noopener noreferrer">download the XState VSCode extension directly from the Open VSX Registry</a>.</p><p>Please give us your feedback and let us know if you encounter any issues in <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">our Discord</a> or <a href="https://github.com/statelyai/xstate-tools/issues" target="_blank" rel="noopener noreferrer">our xstate-tools repository</a>.</p>]]></content:encoded>
            <category>extension</category>
            <category>open source</category>
            <category>xstate</category>
            <category>vscode</category>
        </item>
        <item>
            <title><![CDATA[Introducing: The XState CLI]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-03-03-introducing-the-xstate-cli</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-03-03-introducing-the-xstate-cli</guid>
            <pubDate>Thu, 03 Mar 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Get ready to run XState’s typegen commands outside of VSCode in our all-new CLI.]]></description>
            <content:encoded><![CDATA[<p>Around a month ago, we released <a href="/statelyai-docs/blog/2022-01-27-introducing-typegen">TypeScript Typegen</a> - an enormous upgrade to the TypeScript experience for XState.</p><p>We’ve had a great response to it so far, but it’s only been available for VSCode users.</p><p>Until now. With our new XState CLI, <strong>you can get Typegen from the command line</strong>.</p><ul><li>Read the full documentation on the <a href="https://xstate.js.org/docs/packages/xstate-cli" target="_blank" rel="noopener noreferrer"><code>@xstate/cli</code> docs</a>.</li><li>Check out <a href="https://xstate.js.org/docs/guides/typescript.html#typegen" target="_blank" rel="noopener noreferrer">our updated TypeScript Typegen guide</a>. </li><li>Find the code on the <a href="https://github.com/statelyai/xstate-tools/tree/main/apps/cli" target="_blank" rel="noopener noreferrer">@xstate/cli GitHub repo</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">install</span><span class="token plain"> @xstate/cli</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>OR</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">add</span><span class="token plain"> @xstate/cli</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="commands">Commands<a href="#commands" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="xstate-typegen-files"><code>xstate typegen &lt;files&gt;</code><a href="#xstate-typegen-files" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">xstate typegen </span><span class="token string" style="color:rgb(163, 21, 21)">"src/**/*.tsx?"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Run the typegen against a glob of files. This will scan every targeted file and generate a typegen file accompanying it. It will also import the typegen into your file, as described in <a href="https://xstate.js.org/docs/guides/typescript.html#typegen" target="_blank" rel="noopener noreferrer">our typegen documentation</a>.</p><p>Ensure you wrap your glob in quotes so that it executes correctly. Otherwise, you’ll get unexpected results.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="options">Options<a href="#options" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">xstate typegen </span><span class="token string" style="color:rgb(163, 21, 21)">"src/**/*.tsx?"</span><span class="token plain"> --watch</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Runs the task on a watch, monitoring for changed files and running the typegen script against them.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-future">The Future<a href="#the-future" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’re really excited about the CLI, and all the cool things it’ll enable. The typegen really is just the surface. If you’ve got ideas for what we could do with it, don’t hesitate to add a feature request to the <a href="https://github.com/statelyai/xstate-tools/issues" target="_blank" rel="noopener noreferrer"><code>xstate-tools</code> repo</a>.</p>]]></content:encoded>
            <category>cli</category>
            <category>xstate</category>
            <category>announcement</category>
            <category>typescript</category>
        </item>
        <item>
            <title><![CDATA[Modelling 101: How to build a statechart from scratch]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-02-15-modelling-101-how-to-build-a-statechart-from-scratch</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-02-15-modelling-101-how-to-build-a-statechart-from-scratch</guid>
            <pubDate>Thu, 17 Feb 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Stately dev Matt Pocock takes you through a step-by-step guide on modelling statecharts]]></description>
            <content:encoded><![CDATA[<p>Modelling using statecharts changed my career as a dev. Of all the state management solutions I’ve tried, it feels the most complete, logical and robust. Even if you don’t use them in your app’s code, statecharts let you break down complex features into states, events, services, actions and guards.</p><p>It took me a long time to get comfortable modelling with statecharts. Even when I’d learned all the terms, it took time to work out a step-by-step process for building statecharts from scratch.</p><p>Today, I’m going to share <strong>an opinionated, step-by-step guide for building statecharts from scratch</strong>. This process <em>works for me</em>, but it might not work for you. Feel free to tweak it as you go.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-youll-need">What you’ll need<a href="#what-youll-need" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><ol><li>A pen and paper, or a digital notepad of some kind</li><li>A statechart builder, such as <a href="https://stately.ai/editor" target="_blank" rel="noopener noreferrer">our visual editor</a> or an XState machine in our <a href="https://stately.ai/viz" target="_blank" rel="noopener noreferrer">XState visualizer</a></li><li>A clear idea of what you’re building. Maybe something you’ve implemented at work? You could also pick something from <a href="https://xstate-catalogue.com" target="_blank" rel="noopener noreferrer">XState Catalogue</a>.</li></ol><p>I’ve also built this <a href="https://stately.ai/registry/editor/d24479eb-ac20-44ae-a7b7-c0910e6247ad" target="_blank" rel="noopener noreferrer">process as a statechart</a> using our visual editor.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-list-all-the-possible-events">1. List all the possible events<a href="#1-list-all-the-possible-events" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The first step in this process is to work out all the events that can be received by your statechart. You can think of an event as ‘something that happens’ in your app. There are plenty of examples even on this page:</p><ol><li>Press the escape key</li><li>Press the space bar</li><li>Select some text</li><li>Click on an image</li></ol><p>You don’t need to list <em>all</em> possible events that the user can perform. You only need to <strong>list the events that your statechart cares about</strong>. Here are some examples:</p><p>For a submit form:</p><ul><li>User changes the value of an input</li><li>User submits form</li></ul><p>For a spreadsheet:</p><ul><li>User clicks a cell on the spreadsheet</li><li>User holds down the <code>shift</code>/<code>ctrl</code> key</li><li>User presses <code>escape</code></li><li>User scrolls up or down</li></ul><p>Seeing all the events in a big list may start giving you an idea of what is possible in your statechart. You might start thinking in terms of <em>sequences of events</em> — i.e. <code>User changes input</code> -&gt; <code>User submits form</code>. Write down any sequences that pop into your head, they’ll be useful later.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-list-all-the-possible-tasks">2. List all the possible tasks<a href="#2-list-all-the-possible-tasks" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Next, it’s important to consider the <em>tasks</em> your app needs to perform. These tasks could be called ‘side effects’ — things that happen as a result of your statechart running. These could be as diverse as:</p><ol><li><strong>Adding an item to a todo list (in local state)</strong></li><li><strong>Sending a request to the API to load some data</strong></li><li><strong>Focusing an input</strong></li><li><strong>Waiting for a video to load</strong></li><li><strong>Subscribing to something for updates</strong> (perhaps via <code>window.addEventListener()</code>)</li></ol><p><em>NOTE: I’m using ‘tasks’ loosely. This isn’t an official term in the XState docs — but ‘services’ and ‘actions’ are.</em></p><p>Once you have a list of tasks, you need to divide them into two groups.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2a-services">2a. Services<a href="#2a-services" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The first group is for services, tasks where you need to <em>do something when they finish</em>. I wrote a <a href="/statelyai-docs/blog/2021-04-30-should-this-be-an-action-or-a-service">longer guide about the distinction between actions and services here</a>.</p><p>From our list above, these are services:</p><ol start="2"><li><strong>Sending a request to the API to load some data</strong></li></ol><p>We need to get something from the API, meaning that we need to wait until we receive the data. This task can also fail — if we’re having network trouble or the API method fails. That means we care whether it succeeds or fails.</p><ol start="4"><li><strong>Waiting for a video to load</strong></li></ol><p>Same as above — we need to wait for the video to be loaded, and we care if it fails to load.</p><ol start="5"><li><strong>Subscribing to something for updates</strong></li></ol><p>Here, it’s a little different — when you subscribe to something, you need to clean up the listener to prevent a memory leak. For instance:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">listener</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token builtin" style="color:rgb(0, 112, 193)">console</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"Hello!"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Subscribe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">addEventListener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"focus"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> listener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Unsubscribe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">removeEventListener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"focus"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> listener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, we care about the outcome because we need to <em>run something at the end of the process</em> — i.e. unsubscribe from the listener.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="adding-ondoneonerror-events">Adding onDone/onError events<a href="#adding-ondoneonerror-events" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>Service completions/errors are handled <em>as events</em> in your statechart, meaning they’re on the same level as your user clicking buttons.</p><p>When you’ve got your list of services, note down two things:</p><p>For each service that we need to wait for it to complete, add a <code>serviceName.onDone</code> event to your list.</p><p>For each service that might reasonably be expected to error, add a <code>serviceName.onError</code> event to your list.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2b-actions">2b. Actions<a href="#2b-actions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The second group is for actions, tasks that you can ‘fire and forget’. Unlike services, the statechart forgets about actions as soon as they’re fired.</p><p>From our list above, these are actions:</p><ol><li><strong>Adding an item to a todo list (in local state)</strong></li></ol><p>Changes to local state are pretty much always fire-and-forget. The reason is that, since we manage the local state ourselves, updating it is instant. <a href="https://xstate.js.org/docs/guides/context.html#assign-action" target="_blank" rel="noopener noreferrer">XState’s assign action</a> is a good example.</p><ol start="2"><li><strong>Focusing an input</strong></li></ol><p>Focusing an input, in the same vein, is fire-and-forget. We don’t care about the outcome, and it’s unlikely to fail.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-work-out-the-very-first-state">3. Work out the very first state<a href="#3-work-out-the-very-first-state" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Now that you know <em>what can happen</em> (events) and <em>what can be done</em> (actions &amp; services) in your statechart, it’s time to start adding some states.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3a-know-your-statecharts-lifecycle">3a. Know your statechart’s lifecycle<a href="#3a-know-your-statecharts-lifecycle" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>It’s always easiest to start at the beginning. Before you add your first state, consider the moment that your statechart gets initiated. What causes your statechart to run? Some examples:</p><p>An <strong>authentication</strong> statechart, which manages the state for whether the user is logged in to a website or not. This would be started the <em>first moment</em> the user clicks on to any page of your app, and finished when they close your app.</p><p>A <strong>sign up form</strong> statechart, which handles a user signing up to your app. This might be started when the user visits the <code>/sign-up</code> route, and stopped when they exit it.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3b-write-down-your-first-state">3b. Write down your first state<a href="#3b-write-down-your-first-state" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Now that you know what your app looks like when your statechart gets initiated, it’s time to name its initial state. Consider what the statechart is doing at that time. It could be <code>Loading data</code>, or <code>Waiting for user to submit form</code>, or even just <code>Idle</code>, waiting for something to happen.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-initial-states">Dynamic initial states<a href="#dynamic-initial-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>Every statechart <em>must</em> have an initial state, and it can’t be dynamic — it must be the same every time your statechart runs.</p><p>If you feel your statechart <em>does</em> have more than one initial state (for instance it could start in two different modes) consider using a ‘checking’ state via an <a href="https://xstate.js.org/docs/guides/transitions.html#eventless-always-transitions" target="_blank" rel="noopener noreferrer">eventless transition</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-build-out-the-states">4. Build out the states<a href="#4-build-out-the-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Now that you have your first state, you can start the process of building out the states. Every state represents a length of time, so consider <em>what is happening</em> during that state.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4a-work-out-if-any-tasks-are-running">4a. Work out if any tasks are running<a href="#4a-work-out-if-any-tasks-are-running" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Do you have any services running? If so, <em>invoke</em> those services using <a href="https://xstate.js.org/docs/guides/communication.html#invoking-services" target="_blank" rel="noopener noreferrer">XState’s invoke property</a>.</p><p>Does an action need to happen when you enter or exit the state? If so, add it as an <a href="https://xstate.js.org/docs/guides/actions.html#actions" target="_blank" rel="noopener noreferrer">entry or exit action</a>.</p><p>Remember, the <em>statechart itself</em> is also a state. We often call it the ‘root state’. This means that you can run services or listen to events for the <em>entire duration of your statechart</em>. You can also run entry actions when your statechart starts, and exit actions when it stops.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4b-work-out-which-events-can-happen-in-that-state">4b. Work out which events can happen in that state<a href="#4b-work-out-which-events-can-happen-in-that-state" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Consider the period of time your state represents. Which events should <em>do</em> something, and what should they do?</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="events-that-change-state">Events that change state<a href="#events-that-change-state" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>If an event results in:</p><ol><li>A new service running</li><li>Something new appearing on screen</li><li>Other types of events becoming possible</li><li>A current service stopping</li></ol><p>Then it might need to move to a new state. A great example is a <strong>data fetcher</strong>. Your app is in two distinct states:</p><ul><li><strong>Fetching data</strong>: it doesn’t yet have the data, and the ‘fetch data’ service is running.</li><li><strong>Showing data</strong>: it has the data, and is showing it on screen. The ‘fetch data’ service has stopped.</li></ul><p>If you have an event like this, draw out the new event and either create a new state, or make it target an existing one if needed.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="events-that-dont-change-state">Events that don’t change state<a href="#events-that-dont-change-state" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>Sometimes, <a href="https://xstate.js.org/docs/guides/actions.html#api" target="_blank" rel="noopener noreferrer">events can be used to fire an action</a> instead of changing state. A good example of this is when a form input changes, and you need to save the new value to local state.</p><p>This is called a <a href="https://xstate.js.org/docs/guides/transitions.html#self-transitions" target="_blank" rel="noopener noreferrer">self-transition</a>, where the event doesn’t change the state — the state transitions to itself.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="events-that-do-nothing">Events that do nothing<a href="#events-that-do-nothing" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>It’s important to bear in mind that when your statechart is in a certain state, <em>only the events that you specify</em> will be handled. In other words, any event you don’t specify will do <em>nothing</em> when it’s sent to the statechart.</p><p>A classic example of this is a form. When you submit the form, you go to the ‘submitting’ state. It’s important that you don’t allow the ‘submit’ event to be received while in the ‘submitting’ state — otherwise the form might get sent twice!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-keep-going">5. Keep going!<a href="#5-keep-going" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Once you’ve figured out which actions/services are running in which states, and what all the events do, you’ve modelled your first state! You’ll likely have states which branch off your initial state — so go through those one-by-one and build them out.</p><p>You can also leave parts of your statechart unimplemented, and dive into building the frontend/actions/services before returning to modelling again.</p><p>I’ve found this approach really useful when getting to grips with what my app does. You can even use a statechart as an early validation tool to confirm that what you’re building is correct.</p><p>If you’ve got any more questions, do <a href="https://discord.gg/invite/xstate" target="_blank" rel="noopener noreferrer">join our Discord</a> and ask in the ‘modelling-help’ channel.</p>]]></content:encoded>
            <category>xstate</category>
            <category>tutorial</category>
            <category>statechart</category>
            <category>modelling</category>
        </item>
        <item>
            <title><![CDATA[Stately Editor public beta]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-02-08-join-the-stately-editor-public-beta</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-02-08-join-the-stately-editor-public-beta</guid>
            <pubDate>Tue, 08 Feb 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[We’re excited to announce the public beta of the Stately Editor! The Stately Editor is a tool for creating and editing state diagrams. We’ve received a lot of great feedback from the private beta testers, and now we’re delighted to share it with everyone.]]></description>
            <content:encoded><![CDATA[<p>We’re excited to announce the public beta of the Stately Editor! The Stately Editor is a tool for creating and editing state diagrams. We’ve received a lot of great feedback from the private beta testers, and now we’re delighted to share it with everyone.</p><p><strong><a href="https://stately.ai/editor?source=blog" target="_blank" rel="noopener noreferrer">Try the Stately Editor beta now</a></strong></p><p><img loading="lazy" alt="Visualize your application logic with the Stately Editor" src="/statelyai-docs/assets/images/stately-editor-public-beta-a2f21290647bb3deaf97561c12343928.png" width="2540" height="1520" class="img_ev3q"></p><p>The software development lifecycle today is a bit fragmented. It’s very difficult for user stories, designs, code, tests, and documentation to stay in sync, leading to parts going out-of-date or even missing entirely. Bugs increase, and adding or modifying features becomes increasingly complex. And even understanding all the features and use-cases of an app becomes a daunting task.</p><p>Our mission is to <strong>make app logic accessible to the entire team</strong>, including developers, designers, and stakeholders. Using state machines and statecharts as a common visual language, the software development cycle becomes more collaborative, eliminating handoff and tightening the feedback loop.</p><p>The Stately Editor aims to be that collaborative visual app logic tool. Before, developers could build state machines and statecharts in code using <a href="https://github.com/statelyai/xstate" target="_blank" rel="noopener noreferrer">XState</a>. Now, you can create those same state diagrams visually.</p><p>And yes, it goes both ways: edit the code and see the updated state diagram. Edit the state diagram and see the updated code in real-time. All this is possible with the <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">XState VS Code extension</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="features">Features<a href="#features" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The editor supports everything you need to build state machines and statecharts:</p><ul><li>Atomic, compound, parallel, history, and final states</li><li>Normal, guarded, and delayed events/transitions</li><li>Entry, exit, and transition actions</li><li>Invocations</li><li>Done and error transitions for states and invocations</li><li>State and event descriptions</li></ul><p>There are currently two modes:</p><ul><li><strong>Editor mode</strong>: add, modify, and delete states, events, and transitions, as well as data like actions, descriptions, and invocations.</li><li><strong>Simulation mode</strong>: run the statechart, trigger events, and see the active state nodes.</li></ul><p>You can also <strong>export machines to JSON</strong>, ready to be used in your codebase with XState.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="roadmap">Roadmap<a href="#roadmap" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We have a long list of features planned for the editor, including:</p><ul><li>Parameterized actions, guards, and invocations</li><li>Built-in actions, such as <code>assign</code> and <code>raise</code></li><li>Schema editing for <code>context</code> and <code>events</code></li><li>More granular simulation control, such as specifying event payload and simulating delays</li><li>Visualizing systems of actors, including spawned and invoked machines</li><li>Warnings and errors for invalid machine definitions</li><li>Customizable state node, event, and transition colors</li><li>Rich text editing and content for state descriptions</li><li>Markdown generation</li><li>Event recording and playback</li><li>Machine versioning and diffing</li><li>Autolayout and smart layout controls</li><li>Teams and private machines/systems</li><li><em>And so much more.</em></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="join-the-public-beta">Join the public beta<a href="#join-the-public-beta" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Excited to see what the Stately Editor can do? <a href="https://stately.ai/registry?source=blog" target="_blank" rel="noopener noreferrer">Join the public beta by registering for free</a> and <a href="https://stately.ai/editor?source=blog" target="_blank" rel="noopener noreferrer">create your first machine</a>, or <a href="https://stately.ai/registry/discover?source=blog" target="_blank" rel="noopener noreferrer">discover other people’s machines</a> and get inspired.</p><p>Please <a href="https://github.com/statelyai/editor-feedback/issues/new" target="_blank" rel="noopener noreferrer">let us know</a> if you have any feedback, feature requests or bug reports.</p><section style="background-color:RGBA(144, 205, 244, .15);margin-block:16px;margin-inline:-16px;padding-inline:16px;padding-block:16px;margin-top:32px;display:flex;flex-direction:column;gap:5px;align-items:center"><p style="margin:0!important;text-align:left">Try the Stately Editor beta and start modeling your app logic visually.</p><a style="justify-content:center;background-color:#0b6dff;transition:background-color 0.2s ease-in-out;padding:8px 16px;border-radius:8px;color:white;text-decoration:none;width:max-content" href="https://stately.ai/editor?source=blog">Try the beta</a></section><h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next steps<a href="#next-steps" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The editor is the initial state towards making the ultimate collaborative tool for visually editing even the most complex app logic. We’re excited to share the Stately Editor with the world, and we’re looking forward to hearing your reactions.</p><p><a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">Join our Discord community</a> to get help, ask questions, and give us your feedback.</p>]]></content:encoded>
            <category>editor</category>
            <category>announcement</category>
            <category>beta</category>
        </item>
        <item>
            <title><![CDATA[Introducing: TypeScript typegen for XState]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2022-01-27-introducing-typegen</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2022-01-27-introducing-typegen</guid>
            <pubDate>Thu, 27 Jan 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[XState’s TypeScript experience just got an enormous upgrade - Typescript typegen, integrated with VS Code.]]></description>
            <content:encoded><![CDATA[<div style="position:relative;height:0px;padding-bottom:56.25%"><iframe src="https://www.loom.com/embed/1f90a1a454c7495ea755f044c394c54d" frameborder="0" allowfullscreen="" style="position:absolute;top:0;left:0;width:100%;height:100%"></iframe></div><p><strong>XState and TypeScript are a match made in heaven</strong>. TypeScript gives you type safety, and XState gives you logical safety. Together, they give you confidence that your code will do what you expect.</p><p>However, we’ve been hearing from the community for some time that the <em>experience</em> of using TypeScript with XState needed improving.</p><p>Today's your lucky day. <strong>XState’s TypeScript experience just got an <em>enormous</em> upgrade</strong>.</p><p>We have brought type generation into XState v4.29.0, and we’re aiming for <strong>perfect types on all parts of XState’s API</strong>.</p><p>We’re releasing typegen today as an opt-in beta. Be sure to check out the <a href="https://xstate.js.org/docs/guides/typescript.html#known-limitations" target="_blank" rel="noopener noreferrer">known limitations</a> section of the docs.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting Started<a href="#getting-started" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You can visit the <a href="https://xstate.js.org/docs/guides/typescript.html#typegen" target="_blank" rel="noopener noreferrer">official docs</a> for the full guide, or follow the instructions:</p><ol><li><p>Download and install the <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">VS Code extension</a>.</p></li><li><p>Open a new file and create a new machine, passing the schema attributes:</p></li></ol><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  schema</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> value</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    events</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"FOO"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> value</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"BAR"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"a"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    a</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">FOO</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"consoleLogValue"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"b"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    b</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      entry</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"consoleLogValueAgain"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Add <code>tsTypes: {}</code> to the machine and save the file:</li></ol><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">const machine = createMachine({</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(9, 134, 88)">+</span><span class="token inserted-sign inserted line" style="color:rgb(9, 134, 88)"> tsTypes: {},</span><br></span><span class="token-line" style="color:#000000"><span class="token inserted-sign inserted line" style="color:rgb(9, 134, 88)"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> schema: {</span><br></span><span class="token-line" style="color:#000000"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   context: {} as { value: string },</span><br></span><span class="token-line" style="color:#000000"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   events: {} as { type: "FOO"; value: string } | { type: "BAR" },</span><br></span><span class="token-line" style="color:#000000"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> },</span><br></span><span class="token-line" style="color:#000000"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> initial: "a",</span><br></span><span class="token-line" style="color:#000000"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> states: {</span><br></span><span class="token-line" style="color:#000000"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">   /* ... */</span><br></span><span class="token-line" style="color:#000000"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"> },</span><br></span><span class="token-line" style="color:#000000"><span class="token unchanged line"></span><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>The extension should automatically add a generic to the machine:</li></ol><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// This generic just got added!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  tsTypes</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"./filename.typegen"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Typegen0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>Add a second parameter into the <code>createMachine</code> call - this is where you implement the actions, services, guards and delays for the machine.</li></ol><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">consoleLogValue</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// Wow! event is typed to { type: 'FOO' }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token builtin" style="color:rgb(0, 112, 193)">console</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">consoleLogValueAgain</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// Wow! event is typed to { type: 'FOO' }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token builtin" style="color:rgb(0, 112, 193)">console</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="typing-improvements">Typing improvements<a href="#typing-improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Let’s get into the nitty-gritty and show you exactly what’s improved.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="events-in-machine-options">Events in machine options<a href="#events-in-machine-options" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>One of the most common pain points we heard from our community was using named actions, services and guards with TypeScript. The main reason is that you needed to write code like this:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    schema</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      events</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"FOO"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> value</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"BAR"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token constant" style="color:rgb(129, 31, 63)">FOO</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"myAction"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">myAction</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">         * TS don't know if the event is FOO or BAR,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">         * so we have to defensively check here</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">         */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">type </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"FOO"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">           * Now we know that event.value</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">           * is present on FOO, because</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">           * we checked</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">           */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token builtin" style="color:rgb(0, 112, 193)">console</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The VS Code extension <strong>statically analyzes your machine</strong>, and knows which events lead to which actions.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">/* config */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">myAction</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">         * No more defensive check needed! event</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">         * is typed to only the events that cause</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">         * the action</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">         */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token builtin" style="color:rgb(0, 112, 193)">console</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This works for actions, services, guards and delays. It even works for <strong>entry actions</strong>, another big pain point from the community.</p><p>We’re hoping this lets you cut hundreds of lines of useless defensive code.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="autocomplete-on-machine-options">Autocomplete on machine options<a href="#autocomplete-on-machine-options" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Another thing we’ve been hearing from the community is that it’s easy to make typos on machine options.</p><p>Now, with typegen, you get <strong>autocomplete on all machine options</strong>. The following code will error:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    entry</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"sayHello"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">/*</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">       * This will error, because sayhello does not</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">       * exist in the machine declaration above</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">       */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">sayhello</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We’ve also made it so any <em>missing</em> machine options will error when
you implement them later. So, in a React component:</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  entry</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"sayHello"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">App</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">   * This will error, because you haven't implemented</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">   * sayHello in your actions object</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>That gives you 100% confidence that your machine has all the things it needs to work.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="typing-of-promise-services">Typing of promise-services<a href="#typing-of-promise-services" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Using promise-based services might be the single biggest pain point with XState and TypeScript. We used to have an entire troubleshooting section in our docs dedicated to them.</p><p>Now, you can <strong>strongly type the results of promise-based services</strong>. Here’s how:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    schema</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">       * Pass the 'services' attribute to schema,</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">       * with all the names of your services and</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">       * the data they return</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">       */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      services</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        myService</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// The data that gets returned from the service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          data</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"myService"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      onDone</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"consoleLogId"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    services</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">       * This service will now type error if it</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">       * returns anything other than { id: string }</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">       */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">myService</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"1"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">consoleLogId</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">         * This event now knows that it will</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">         * receive a data attribute with { id: string }</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">         */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token builtin" style="color:rgb(0, 112, 193)">console</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">log</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This makes handling data return types in XState intuitive, easy and type-safe.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="acknowledgements">Acknowledgements<a href="#acknowledgements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>I want to thank my Stately colleague <a href="https://twitter.com/AndaristRake" target="_blank" rel="noopener noreferrer">Andarist</a>. His TypeScript wizardry, incredible attention to detail and deep love of open source helped make this possible. We’ve literally been talking about this for 18 months - and it’s finally here.</p>]]></content:encoded>
            <category>announcement</category>
            <category>xstate</category>
            <category>community</category>
            <category>typescript</category>
            <category>tutorial</category>
            <category>vscode</category>
        </item>
        <item>
            <title><![CDATA[What are the biggest benefits of state machines?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-12-14-what-are-the-biggest-benefits-youve-had-from-using-state-machines</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-12-14-what-are-the-biggest-benefits-youve-had-from-using-state-machines</guid>
            <pubDate>Tue, 14 Dec 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[At Stately we’re fans of state machines, but we wanted to ask our community… what are the benefits you’ve experienced from using state machines?]]></description>
            <content:encoded><![CDATA[<p>Last week we asked our community, “What are the biggest benefits you’ve had from using state machines?”</p><p>At Stately, we’re obviously fans of state machines. Still, we wanted to ask our community the benefits they’ve experienced, whether they were working on a specific project or incorporating state machines into their everyday workflow.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reusability">Reusability<a href="#reusability" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Nowadays, so much of tech is component-oriented, so it was fascinating to hear from Martin that he reused the same state machines across different frameworks.</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><blockquote><p>I think that <strong>the biggest benefit comes from being able to use the same state machine across different frameworks</strong>. With XState, even if you just use React on your projects, you can share your state machine with your <!-- -->[insert framework name here]<!-- --> friends.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="maintaining-complex-app-logic">Maintaining complex app logic<a href="#maintaining-complex-app-logic" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>Pat’s blog post goes into fascinating depth on his work with Crucible. The section on XState starts with Pat’s realization that he needed a state machine and ends with him moving much of their application logic into statecharts.</p><blockquote><p><strong>We didn't start Crucible using XState but by the end of the project it was one of our most valuable tools…</strong></p><p>…</p><p>I was still new to statecharts and sort of overwhelmed by the whole idea so I needed to find a small feature I could prototype XState with where it would make sense and add recognizable value to a flow/process that could use more structure to it…</p><p>…</p><p>I built out the flow based on the services’ state and UI state, I defined all the valid transitions and where they’d go, I wired up the inputs/outputs to it, and then I turned it loose on matchmaking in an actual client and it worked beautifully.</p><p><strong>I could look at the statechart and see the entire flow through the states</strong>, I could see every valid transition that the statechart could take and where it would go, I could paste it into the XState visualizer and actually see a DIAGRAM OF ALL THE STATES AND WALK THROUGH THEM INTERACTIVELY.</p></blockquote><p><a href="https://tivac.com/2020/10/19/crucible-rip/" target="_blank" rel="noopener noreferrer">Read all of Pat’s post on his blog</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="maintainability">Maintainability<a href="#maintainability" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Maintainability is a popular feature of state machines, and Joshua is a fan.</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>Matt’s article on ‘<a href="/statelyai-docs/blog/2021-07-28-usestate-vs-usereducer-vs-xstate-part-1-modals">useState vs useReducer vs XState - Part 1: Modals</a>’ shares examples of these different approaches and their maintainability. And he followed it up with his <a href="https://www.youtube.com/watch?v=zll9uDQOOq0" target="_blank" rel="noopener noreferrer">React Finland talk, ‘Make legacy code delightful with statecharts’</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-to-the-core-of-your-logic">Getting to the core of your logic<a href="#getting-to-the-core-of-your-logic" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The <a href="https://discord.com/channels/795785288994652170/795785288994652174/918546073268670534" target="_blank" rel="noopener noreferrer">discussion on our Discord</a> focused on mindset and how state machines can help us better understand our app logic. Jan got the conversation started.</p><blockquote><p>Certainly for me it must be that <strong>it allows me to very quickly get to the essence and core behaviour of what I'm building</strong>. Playing with boxes and arrows allow me to not get caught up in implementation details while figuring out how I want stuff to work.</p><p>Afterwards, implementing actions and services just feels like filling in the blanks. Likewise hooking the machine up with my component is equally trivial: throw some <code>state.hasTag</code>, <code>state.context</code> and <code>send</code> in there, and you’ve got a stew going</p></blockquote><p>And Steve continued.</p><blockquote><p>State machines make complex behaviors tractable; they help you think about the problem.</p><p>State machines reveal complexities in ostensibly simple behaviors; they make you think about the problem.</p><p>Yin and yang. Good cop, bad cop. <strong>Thinking about your application behavior as a set of state machines focuses your mind on what's really going on inside that tangled mass of behaviors</strong>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="robustness">Robustness<a href="#robustness" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Horacio also explained how the robustness of apps built with state machines could give us more faith in our work.</p><blockquote><p>Programming is all about confidence, and for me, <strong>working with state machines gives me the same confidence on my code as writing tests</strong>, with the addition to have a visual representation of my system that I can discuss, show and modify with all my teammates.</p><p>Also having the confidence of refactoring code without the fear of breaking other parts of my app!!</p><p>Definitely XState is one of my top additions of 2021 to my dev toolbelt! 💪</p></blockquote><p>That’s just what we like to hear!</p><p>Thank you, everyone, for your responses. We love to hear about how you’re using state machines in your projects. If you’ve got any feedback you want to share with the Stately team, you can <a href="https://twitter.com/statelyai" target="_blank" rel="noopener noreferrer">find us on Twitter</a> and join the community on <a href="https://discord.gg" target="_blank" rel="noopener noreferrer">our Discord server</a>.</p><p><em>Note: quotes have been minimally edited to add emphasis and clarity.</em></p>]]></content:encoded>
            <category>weekly question</category>
            <category>community</category>
            <category>state machine</category>
        </item>
        <item>
            <title><![CDATA[How do you convince your teammates to use XState?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-10-11-convince-teammates</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-10-11-convince-teammates</guid>
            <pubDate>Mon, 11 Oct 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Last week our question of the week was how do you convince your teammates to use XState? Here are some suggestions]]></description>
            <content:encoded><![CDATA[<p>Last week our question of the week was “<em>how do you convince your teammates to use XState?</em>”</p><p>One of our most frequent requests for the documentation is more advice on how to convince others to use XState. Many people <a href="https://dev.to/mpocock1/how-to-manage-global-state-with-xstate-and-react-3if5" target="_blank" rel="noopener noreferrer">read an article</a>, <a href="https://www.youtube.com/watch?v=9k1ZHHJWt7k" target="_blank" rel="noopener noreferrer">watch a talk</a> or <a href="https://frontendmasters.com/courses/xstate/" target="_blank" rel="noopener noreferrer">participate in a workshop</a> about XState and are sold on using XState themselves. But when it comes to getting their team on board, they often need more.</p><p>Thanks to all the wonderful folks who answered our question <a href="https://twitter.com/statelyai/status/1446035499777462274" target="_blank" rel="noopener noreferrer">posted to Twitter</a> and in our #office-hours <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">Discord</a> channel, we’ve got some fantastic suggestions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="present-using-the-visualizer">Present using the Visualizer<a href="#present-using-the-visualizer" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Many people immediately understand the benefits of statecharts as they’re familiar with diagrams using “boxes and arrows.” The Visualizer gives you an instant, recognisable overview of your application logic, which is often enough to get them on board.</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="give-examples-using-their-own-work">Give examples using their own work<a href="#give-examples-using-their-own-work" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Nick Hehr takes it step-by-step, utilizing the Visualizer.</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>And Farzad successfully convinced his team. We discussed his success in <a href="https://www.youtube.com/watch?v=GCWZ-froHKo" target="_blank" rel="noopener noreferrer">our office hours last week</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="give-them-side-by-side-examples">Give them side-by-side examples<a href="#give-them-side-by-side-examples" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Amy Pellegrini recommended many complementary approaches, starting with comparing XState to other types of state management.</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>This might be an intensive approach, but it’s the ultimate way to show the benefits of XState.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="show-existing-projects-that-are-using-xstate">Show existing projects that are using XState<a href="#show-existing-projects-that-are-using-xstate" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We’re all more convinced by a technology when we know it’s already being used by projects or organisations whose work we admire. Amy Pellegrini suggests taking advantage of that:</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dictate-the-use-as-team-lead">Dictate the use as team lead<a href="#dictate-the-use-as-team-lead" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>A few people are fortunate enough to be leading their teams, and of course adoption is much easier when you can just tell your team to use XState from the top.</p><p><a href="https://discord.com/channels/795785288994652170/895591583586598943/895730595378913390" target="_blank" rel="noopener noreferrer">Cédric</a>:</p><blockquote><p>I have said: "We will use XState" 😂</p></blockquote><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="become-the-expert-so-you-can-answer-their-questions-and-help-them-progress">Become the expert so you can answer their questions and help them progress<a href="#become-the-expert-so-you-can-answer-their-questions-and-help-them-progress" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>But not everyone can be the boss. Amy Pellegrini recommends becoming the XState subject matter expert, so you’re better prepared to support the rest of your team.</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>And Josh Ferrell suggests collaborating with your product team, showing them how to model with the Visualizer, enabling them to do the modeling themselves in the future.</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tell-them-that-the-stately-team-is-fast-and-responsive">Tell them that the Stately team is fast and responsive<a href="#tell-them-that-the-stately-team-is-fast-and-responsive" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Knowing a technology is under frequent development, and the developers are likely to respond to your feedback, is important to most of us when we’re embedding a new tool into a key part of our workflow. <a href="https://discord.com/channels/795785288994652170/895591583586598943/895738949635551273" target="_blank" rel="noopener noreferrer">Cédric on our Discord</a> uses this as a way to convince his team to work with XState.</p><blockquote><p>Xstate team improve the project really quickly, office hours give a good idea of the roadmap and features, when something is propose there are a real discussion and project improvement from only “an idea” on discord</p></blockquote><p>Thanks Cédric!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="promoting-the-collaboration-benefits">Promoting the collaboration benefits<a href="#promoting-the-collaboration-benefits" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>At Stately, we’re excited about the potential for collaboration with our Visualizer and Editor. We want to shrink the space between planning, design and development, helping the whole team work together on their application logic. <a href="https://discord.com/channels/795785288994652170/895591583586598943/895738949635551273" target="_blank" rel="noopener noreferrer">Cédric agrees with those benefits</a>.</p><blockquote><p>The Viz is a real support to share business logic between product and tech team, this could be add<!-- -->[ed]<!-- --> into a specifications and of course with the futur<!-- -->[e]<!-- --> way to create machine by a simple drag and drop this offer<!-- -->[s]<!-- --> the possibility for the product team to create themselves a real machine useful <!-- -->[for]<!-- --> the tech team</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="timing-it-right-with-a-good-use-case-for-the-team">Timing it right with a good use case for the team<a href="#timing-it-right-with-a-good-use-case-for-the-team" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>On our Discord, <a href="https://discord.com/channels/795785288994652170/895591583586598943/895754626689814578" target="_blank" rel="noopener noreferrer">Jan has a carefully planned approach</a>:</p><blockquote><p>I received the task to build some pretty complicated UI components, and I opted to build them with simple state machines, implemented as good ol' <code>switch</code>-based reducers. Since we're using Redux, this approach didn't alienate my team entirely, and so the seed had been planted.</p><p>Fast-forward a bit, and we're currently rewriting some of the core of our application as a state machine (or something of a Frankenstein statechart), after receiving new requirements would make it completely unmaintainable if we had continued in the same tracks. We're still doing it with <code>switch</code> (with nested states, even!), which isn't optimal, but it's way better than where we came from.</p><p>For now it does the job, but my plan is to note any pains which could easily be solved with XState, and propose a rewrite if/when the time is right. I figure it will be a much easier sell if my team is already somewhat familiar with the concepts of state machines, and we have a really good use-case on our hands.</p></blockquote><p>Finding the right timing for your team is key for introducing any new technology.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="make-them-less-intimidated-by-the-terminology">Make them less intimidated by the terminology<a href="#make-them-less-intimidated-by-the-terminology" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>And sometimes a team is rightfully cautious of trying a technology that comes across as new. It’s all about how you frame it…</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>😂</p><p>In the future we hope to provide more documentation and advice to help you convince your team to use XState. If you have any suggestions or requests, please <a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">let us know on our Discord</a>. We want to make our tools work for you.</p>]]></content:encoded>
            <category>blog</category>
            <category>team</category>
        </item>
        <item>
            <title><![CDATA[Introduction to state machines and statecharts]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-10-02-intro-fsm-sc</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-10-02-intro-fsm-sc</guid>
            <pubDate>Sat, 02 Oct 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Introduction to state machines and statecharts]]></description>
            <content:encoded><![CDATA[<p>Statecharts are a visual language used to describe the states in a process.</p><p>You may have used similar diagrams in the past to design user flows, plan databases or map app architecture. Statecharts are another way of using boxes and arrows to represent flows, but with XState these flows are also executable code that can be used to control the logic in your applications.</p><p>This guide covers the basics of statecharts in a beginner-friendly way, including:</p><ul><li><a href="#states">states</a></li><li><a href="#transitions-and-events">transitions and events</a></li><li><a href="#initial-state">initial states</a></li><li><a href="#final-state">final states</a></li><li><a href="#compound-states">compound states</a></li><li><a href="#parallel-states">parallel states</a></li><li><a href="#self-transition">self-transitions</a></li><li><a href="#planning-statecharts">planning statecharts</a></li><li><a href="#delayed-transitions">delayed transitions</a></li><li><a href="#actions">actions</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="states">States<a href="#states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The <em>states</em> are represented by rounded rectangle boxes. To draw a statechart for the process of a dog, there are two states that would first come to mind:</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/asleep-awake.svg" class="img_ev3q"></p><p>A dog is always <strong>asleep</strong> or <strong>awake</strong>. The dog can’t be asleep and awake at the same time, and it’s impossible for the dog to be neither asleep nor awake. There’s only these two states, a precisely limited, <em>finite</em> number of states.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="transitions-and-events">Transitions and events<a href="#transitions-and-events" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>How the dog goes between <strong>asleep</strong> and <strong>awake</strong> is through <em>transitions</em>, which are symbolised by an arrow pointing from one state to the next state in the process’s sequence.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/transitions-events.svg" class="img_ev3q"></p><p>A transition is caused by an <em>event</em> that results in the change of state. Transitions are labelled with their events.</p><p>Transitions and events are <em>deterministic</em>. Deterministic means that each transition and event always points to the same next state, and always produces the same result from their given starting condition, every time the process is run. Dogs never <strong>wake up</strong> to become <strong>asleep</strong> or <strong>fall asleep</strong> to become <strong>awake</strong>.</p><p>This tiny dog process, with its two finite states and two transitions is a <em>Finite State Machine.</em> A state machine is used to describe the behavior of something. The machine describes the thing’s states and the transitions between those states. It’s a Finite State Machine because it has a finite number of states. (Sometimes abbreviated to FSM by folks who love jargon).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="initial-state">Initial state<a href="#initial-state" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Any process that has states will have an <em>initial state</em>, the default state the process exists in until an event happens to change the process’s state.</p><p>The initial state is represented by a filled circle with an arrow pointing from the circle to the initial state.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/initial-state.svg" class="img_ev3q"></p><p>Using a statechart to describe the process of walking the dog, the initial state would be <strong>waiting</strong> to walk.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="final-state">Final state<a href="#final-state" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Most processes with states will have a <em>final state</em>, the last state when the process is finished. The final state is represented by a double border on the state’s rounded rectangle box.</p><p>In the dog walking statechart, the final state would be <strong>walk complete</strong>.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/final-state.svg" alt="Dog walking statechart showing waiting state transitioning through the leave home event to the on a walk state, then transitioning through the arrive home event to the final state of walk complete." class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="compound-states">Compound states<a href="#compound-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>A compound state is a state that can contain more states, also known as child states. These child states can only happen when the parent compound state is happening. Inside the <strong>on a walk</strong> state, there could be the child states of <strong>walking</strong>, <strong>running</strong> and <strong>stopping to sniff good smells</strong>.</p><p>A compound state is symbolised by a labelled rounded rectangle box that acts as a container for its child states.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/compound-state.svg" class="img_ev3q"></p><p>A compound state should also specify which child state is the initial state. In the <strong>on a walk</strong> compound state, the initial state is <strong>walking</strong>.</p><p>Compound states are what makes statecharts capable of handling more complexity than an everyday state machine.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="atomic-states">Atomic states<a href="#atomic-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>An atomic state is a state that doesn’t have any child states. <strong>Waiting</strong>, <strong>walk complete</strong>, <strong>walking</strong>, <strong>running</strong> and <strong>stopping to sniff good smells</strong> are all atomic states.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="parallel-states">Parallel states<a href="#parallel-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>A parallel state is a compound state where all of its child states, also known as regions, are active simultaneously. The regions are separated inside the compound state container by a dashed line.</p><p>Inside the <strong>on a walk</strong> compound state, there could be two regions. One region contains the dog’s activity child states of <strong>walking</strong>, <strong>running</strong> and <strong>stopping to sniff good smells</strong>, and the other region containing the dog’s tail states of <strong>wagging</strong> and <strong>not wagging</strong>. The dog can walk and wag its tail, run and wag its tail or stop and sniff while wagging its tail, it can also do any of these activities without wagging its tail.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/parallel-states.svg" class="img_ev3q"></p><p>Both regions should also specify which child state is the initial state. In our <strong>tail</strong> region, the initial state is <strong>not wagging</strong>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="self-transition">Self-transition<a href="#self-transition" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>A self-transition is when an event happens, but the transition returns to the same state. The transition arrow exits and re-enters the same state.</p><p>A helpful way to describe a self-transition is “doing something, not going somewhere” in the process.</p><p>In a <strong>dog begging</strong> process, there would be a <strong>begging</strong> state with a <strong>gets treat</strong> event. And for the dogs who love their food, no matter how many times you go through the <strong>gets treat</strong> event, the dog returns to its <strong>begging</strong> state.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/self-transition.svg" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="planning-statecharts">Planning statecharts<a href="#planning-statecharts" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>One of the benefits of statecharts is that, in the process of putting a statechart together, you explore all the possible states in your process. This exploration will help you avoid bugs and errors in your code as you’re more likely to cover all the eventualities.</p><p>And because statecharts are executable, they can behave as both the diagram and the code, making it less likely that you’ll introduce differences or bugs interpreting between the diagramming and coding environments.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="planning-a-statechart-for-a-login-machine">Planning a statechart for a login machine<a href="#planning-a-statechart-for-a-login-machine" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>To draw a statechart for a login machine, start by listing the basic <em>events</em> in the process. Think about what your login process will <em>do</em>:</p><ul><li>log in</li><li>log out</li></ul><p>Then list the <em>states</em> that exist as a result of those events:</p><ul><li>logged in</li><li>logged out</li></ul><p>Once there’s some events and states, there’s the beginnings of a statechart.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/basic-login.svg" alt="Login statechart showing an initial logged out state transitioning through a log in event to a logged in state, then transitioning through a log out event back to the logged out state." class="img_ev3q"></p><p>Don’t forget the <em>initial state</em>. In this case, the <strong>logged out</strong> state is the initial state, as any new user would come to the process logged out.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="delayed-transitions">Delayed transitions<a href="#delayed-transitions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Some login and logout processes will log out an inactive user after a fixed length of time as a security measure.</p><p>The <strong>active</strong> and <strong>idle</strong> states only happen when the user is logged in, so these become child states inside the <strong>logged in</strong> compound state.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/login-compound-state.svg" class="img_ev3q"></p><p>The initial state inside the <strong>logged in</strong> compound state is <strong>active</strong>, as it happens as a direct result of the <strong>log in</strong> event, and logging in is a sign of user activity.</p><p>A <em>delayed transition</em> is a type of transition which happens after being in a state for a specified length of time. The delayed transition is labelled with “after” and a fixed duration to indicate how much time should pass before transitioning to the next indicated state.</p><p>In the login statechart, a delayed transition of <strong>60000</strong> milliseconds, or 1 minute, follows the <strong>active</strong> state to determine whether the user is <strong>idle</strong>. If there is an <strong>activity</strong> event before the transition reaches one minute, the process returns to the <strong>active</strong> state.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/delayed-transition.svg" class="img_ev3q"></p><p>A delayed transition of <strong>180000</strong> milliseconds, or 3 minutes, follows the <strong>idle</strong> state to transition to the <strong>auto logged out</strong> state if the user remains idle.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="actions">Actions<a href="#actions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>A statechart is used to set off <em>actions</em> in the system outside of the statechart. Actions are also commonly known as <em>effects</em> or <em>side-effects</em>. “Side effects” sounds like a negative or unimportant term, but setting off actions is the primary purpose in using statecharts.</p><p>Actions are events that have no impact or consequences for the rest of the sequence, the event is just triggered and the sequence moves on to the next step in the process. For example, the login statechart might execute actions that change the user interface.</p><p>An <em>action</em> can be fired upon entering or exiting a state, or on a transition. An action on a state is included inside the state’s container with an “entry /” or “exit /” label depending on whether the action should be fired on entry or exit from the state.</p><p>In the login statechart, there’s an <em>entry</em> action on the <strong>idle</strong> state to warn the user that they may be logged out.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/statelyai/xstate/d98d948a534b028f4af8b271eb431a8625ab5cb3/docs/guides/introduction-to-state-machines-and-statecharts/entry-action.svg" class="img_ev3q"></p>]]></content:encoded>
            <category>introduction</category>
            <category>state machine</category>
            <category>statechart</category>
            <category>state</category>
        </item>
        <item>
            <title><![CDATA[useState vs useReducer vs XState - Part 1: Modals]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-07-28-usestate-vs-usereducer-vs-xstate-part-1-modals</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-07-28-usestate-vs-usereducer-vs-xstate-part-1-modals</guid>
            <pubDate>Wed, 28 Jul 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Managing state at different levels of complexity is hard. This series of articles should help you make the right choices off the bat. Today we’re starting with modals.]]></description>
            <content:encoded><![CDATA[<p>Managing state at different levels of complexity is hard. Different tools make different trade-offs between readability, complexity and speed of development. The worst part is that as apps get more complex, it’s easy to regret choices that were made early on.</p><p>This series of articles should help you make the right choice off the bat. The plan is to cover a bunch of state use cases, starting with the simple and graduating to more complexity as we go. We’ll see how easy they are to write, and also how they survive changing requirements.</p><p>Today, we’re starting with <a href="https://material-ui.com/components/modal/" target="_blank" rel="noopener noreferrer">modals</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="usestate">useState<a href="#usestate" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>For modals, the key piece of state is whether or not the modal is open. <code>useState</code> lets us capture that single piece of state pretty succinctly.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">isOpen</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setIsOpen</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">open</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">setIsOpen</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">close</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">setIsOpen</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">setIsOpen</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain">isOpen</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Highly readable, simple enough, fast to write, bug-proof. For a simple toggle like this, <code>useState</code> is great.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="usereducer">useReducer<a href="#usereducer" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">reducer</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"OPEN"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"CLOSE"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">isOpen</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">default</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">reducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">open</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"OPEN"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">close</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"CLOSE"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>useReducer</code> gives us a reducer, a powerful centralized spot in our code where we can visualise the changes happening. However, it took us quite a few more lines of code to reach the same result as <code>useState</code>. For now, I’d say <code>useState</code> has the edge.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="usemachine">useMachine<a href="#usemachine" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><code>useMachine</code> is a hook from XState, which allows us to use the power of state machines in our code. Let’s see how it looks.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"modalMachine"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    closed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    open</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">open</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"OPEN"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">close</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"CLOSE"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>You can see the state machine on the <a href="https://xstate.js.org/viz/?gist=cf1578f5baa04cf9408ef6e48695f04c" target="_blank" rel="noopener noreferrer">XState visualiser here</a>.</em></p><p>It’s remarkably similar in structure to the reducer above. Similar amount of lines, nearly the same event handlers. The state machine takes the edge over the reducer because of being able to easily visualise its logic - that’s something the reducer can’t match.</p><p>However, the <code>useState</code> implementation still has the edge for me. The simplicity of execution, the elegance. It’s hard to see how it could be beaten...</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="alert-requirements-changing">Alert: requirements changing<a href="#alert-requirements-changing" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Oh no. Requirements have changed. Now, instead of immediately closing, the modal needs to animate out. This means we need to insert a third state, <code>closing</code>, which we automatically leave after 500ms. Let’s see how our implementations hold up.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="usestate-1">useState<a href="#usestate-1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p><strong>Refactor 1</strong>: Our initial <code>isOpen</code> boolean won't handle all the states we need it to any more. Let’s change it to an enum: <code>closed</code>, <code>closing</code> and <code>open</code>.</p><p><strong>Refactor 2</strong>: <code>isOpen</code> is no longer a descriptive variable name, so we need to rename it to <code>modalState</code> and <code>setModalState</code>.</p><p><strong>Refactor 3</strong>: <code>useState</code> doesn’t handle async changes by itself, so we need to bring in <code>useEffect</code> to run a timeout when the state is in the <code>closing</code> state. We also need to clear the timeout if the state is no longer <code>closing</code>.</p><p><strong>Refactor 4</strong>: We need to change the toggle event handler to add logic to ensure it only triggers on the <code>closed</code> and <code>open</code> states. Toggles work great for booleans, but become much harder to manage with enums.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 1, 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">modalState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setModalState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">useEffect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">modalState </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closing"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> timeout </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">setTimeout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function" style="color:rgb(0, 0, 255)">setModalState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">500</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function" style="color:rgb(0, 0, 255)">clearTimeout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">timeout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">modalState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 1, 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">open</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">setModalState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 1, 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">close</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">setModalState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"closing"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 1, 2, 4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">modalState </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">setModalState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">modalState </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">setModalState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"closing"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Yuck. That was an enormous amount of refactoring to do just to add a simple, single requirement. On code that might be subject to changing requirements, think twice before using <code>useState</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="usereducer-1">useReducer<a href="#usereducer-1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p><strong>Refactor 1</strong>: Same as above - we turn the <code>isOpen</code> boolean to the same enum.</p><p><strong>Refactor 2</strong>: Same as above, <code>isOpen</code> is now improperly named, so we need to change it to <code>status</code>. This is changed in fewer places than <code>useState</code>, but there are still some changes to make.</p><p><strong>Refactor 3</strong>: The same as above, we use <code>useEffect</code> to manage the timeout. An additional wrinkle is that we need a new action type in the reducer, <code>REPORT_ANIMATION_FINISHED</code>, to cover this.</p><p><strong>Refactor 4</strong>: The same as above, but instead of the logic being in the event handler, we can actually change the logic inside the reducer. This is a cleaner change, but is still similar in the amount of lines it produces.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 1, 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> reducer </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"OPEN"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"CLOSE"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closing"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"REPORT_ANIMATION_FINISHED"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closing"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">break</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">default</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">reducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">useEffect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">status </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closing"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> timeout </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">setTimeout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"REPORT_ANIMATION_FINISHED"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">500</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function" style="color:rgb(0, 0, 255)">clearTimeout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">timeout</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">open</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"OPEN"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">close</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"CLOSE"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This file required the same number of refactors as the <code>useState</code> implementation. One crucial advantage is that these refactors were mostly located together: most changes occurred inside the reducer, and the event handlers went largely untouched. For me, this gives <code>useReducer</code> the edge over <code>useState</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="usemachine-1">useMachine<a href="#usemachine-1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p><strong>Refactor 1</strong>: Add a new closing state, which after 500 milliseconds goes to the closed state.</p><p><strong>Refactor 2</strong>: Changed the targets of the <code>TOGGLE</code> and <code>CLOSE</code> actions to point at <code>closing</code> instead of <code>closed</code>.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"modalMachine"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    closed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    closing</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      after</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">500</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    open</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// Refactor 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">TOGGLE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closing"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closing"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">open</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"OPEN"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">close</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"CLOSE"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><a href="https://xstate.js.org/viz/?gist=61bbac74d69894c9472571e44c98f765" target="_blank" rel="noopener noreferrer">See the changed machine here</a>.</p></blockquote><p>The difference here is stark. A minimal number of refactors, all within the state machine itself. The amount of lines has hardly changed. None of the event handlers changed. AND we have a working visualisation of the new implementation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Before the requirements changed, <code>useState</code> was the champion. It’s faster, easier to implement, and fairly clear. <code>useReducer</code> and <code>useMachine</code> were too verbose, but <code>useMachine</code> took the edge by being easier to visualise.</p><p>But after the requirements changed, <code>useState</code> hit the floor. It quickly became the <em>worst</em> implementation. It was the hardest to refactor, and its refactors were in the most diverse places. <code>useReducer</code> was equally hard to refactor, with the same set of changes. <code>useMachine</code> emerged as the champion, with a minimal diff required to build in new, complex functionality.</p><p>So if you’re looking to build a modal fast, use <code>useState</code>. If you want to build it right, use <code>useMachine</code>.</p><p>I’m excited to work on this set of articles - I’m looking forward to tackling the toughest state models out there. What would you like to see covered in the next one? Some ideas:</p><ul><li>Data fetching</li><li>Form state</li><li>Multi-step sequences (checkout flows, signup flows)</li></ul><p>Let me know in the comments below, and follow me for the next article!</p>]]></content:encoded>
            <category>modal</category>
            <category>react</category>
            <category>useState</category>
            <category>useReducer</category>
            <category>xstate</category>
        </item>
        <item>
            <title><![CDATA[How to manage global state with XState and React]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-05-27-global-state-xstate-react</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-05-27-global-state-xstate-react</guid>
            <pubDate>Thu, 27 May 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Everything you need to know to manage global state with XState and React.]]></description>
            <content:encoded><![CDATA[<p>Many React applications follow the Flux architecture popularised by <a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer">Redux</a>. This setup can be characterised by a few key ideas:</p><ol><li>It uses a single object at the top of your app which stores all application state, often called the <strong>store</strong>.</li><li>It provides a single <code>dispatch</code> function which can be used to send messages up to the store. Redux calls these <code>action</code>s, but I'll be calling them <code>events</code> - as they're known in XState.</li><li>How the store responds to these messages from the app are expressed in pure functions - most often in <strong>reducers</strong>.</li></ol><p>This article won't go into depth on whether the Flux architecture is a good idea. David Khourshid's article <a href="https://dev.to/davidkpiano/redux-is-half-of-a-pattern-1-2-1hd7" target="_blank" rel="noopener noreferrer">Redux is half a pattern</a> goes into great detail here. For the purposes of this article, we're going to assume that you like having a global store, and you want to replicate it in XState.</p><p>There are many reasons for wanting to do so. XState is second-to-none when it comes to managing complex asynchronous behaviour and modelling difficult problems. Managing this in Redux apps usually involves middleware: either <a href="https://github.com/reduxjs/redux-thunk" target="_blank" rel="noopener noreferrer">redux-thunk</a>, <a href="https://github.com/redux-loop/redux-loop" target="_blank" rel="noopener noreferrer">redux-loop</a> or <a href="https://github.com/redux-saga/redux-saga" target="_blank" rel="noopener noreferrer">redux-saga</a>. Choosing XState gives you a first-class way to manage complexity.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-globally-available-store">A globally available store<a href="#a-globally-available-store" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>To mimic Redux's globally-available store, we're going to use React context. React context can be a tricky tool to work with - if you pass in values which change too often, in can result in re-renders all the way down the tree. That means we need to pass in values which change as little as possible.</p><p>Luckily, XState gives us a first-class way to do that.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createContext </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useInterpret </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> authMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"./authMachine"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> ActorRefFrom </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">GlobalStateContextType</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  authService</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> ActorRefFrom</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token keyword" style="color:rgb(0, 0, 255)">typeof</span><span class="token plain"> authMachine</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> GlobalStateContext </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Typed this way to avoid TS errors,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// looks odd I know</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> GlobalStateContextType</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">GlobalStateProvider</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> authService </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useInterpret</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">authMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">GlobalStateContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Provider value</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> authService </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">children</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">GlobalStateContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Provider</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Using <code>useInterpret</code> returns a <code>service</code>, which is a static reference to the running machine which can be subscribed to. This value never changes, so we don't need to worry about wasted re-renders.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="utilising-context">Utilising context<a href="#utilising-context" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Further down the tree, you can subscribe to the service like this:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useContext </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> GlobalStateContext </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"./globalState"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useActor </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">SomeComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> globalServices </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">GlobalStateContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useActor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">globalServices</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"loggedIn"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Logged In"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Logged Out"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>useActor</code> hook listens for whenever the service changes, and updates the <code>state</code> value.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="improving-performance">Improving Performance<a href="#improving-performance" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>There's an issue with the implementation above - this will update the component for any change to the service. Redux offers tools for deriving state using selectors - functions which restrict which parts of the state can result in components re-rendering.</p><p>Luckily, XState provides that too.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useContext </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> GlobalStateContext </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"./globalState"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useSelector </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">selector</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"loggedIn"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">SomeComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> globalServices </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">GlobalStateContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> isLoggedIn </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useSelector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">globalServices</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> selector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> isLoggedIn </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Logged In"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Logged Out"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, this component will only re-render when <code>state.matches('loggedIn')</code> returns a different value. This is my recommended approach over <code>useActor</code> for when you want to optimise performance.
Dispatching events</p><p>For dispatching events to the global store, you can call a service's send function directly.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useContext </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> GlobalStateContext </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"./globalState"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">SomeComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> globalServices </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">GlobalStateContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> globalServices</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">authService</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"LOG_OUT"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      Log Out</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that you don't need to call useActor for this, it's available right on the context.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deviations-from-flux">Deviations from Flux<a href="#deviations-from-flux" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Keen-eyed readers may spot that this implementation is slightly different from Flux. For instance - instead of a single global store, one might have several running machines at once: <code>authService</code>, <code>dataCacheService</code>, and <code>globalTimeoutService</code>. Each of them have their own <code>send</code> attributes, too - so you're not calling a global dispatch.</p><p>These changes can be worked around. One could create a synthetic send inside the global store which called all the services' <code>send</code> function manually. But personally, I prefer knowing exactly which services my messages are being passed to, and it avoids having to keep events globally namespaced.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>XState can work beautifully as a global store for a React application. It keeps application logic co-located, treats side effects as first-class citizens, and offers good performance with <code>useSelector</code>. You should choose this approach if you're keen on the Flux architecture but feel your app's logic is getting out of hand.</p>]]></content:encoded>
            <category>xstate</category>
            <category>react</category>
            <category>redux</category>
            <category>webdev</category>
        </item>
        <item>
            <title><![CDATA[Why I love invoked callbacks]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-05-13-why-i-love-invoked-callbacks</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-05-13-why-i-love-invoked-callbacks</guid>
            <pubDate>Thu, 13 May 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[I’ve written a bit about services, but today I wanted to talk about my favourite way of expressing services: the Invoked Callback.]]></description>
            <content:encoded><![CDATA[<p>XState offers several primitives for representing long-running application processes. These are usually expressed as <a href="https://xstate.js.org/docs/guides/communication.html" target="_blank" rel="noopener noreferrer">services</a>. I’ve written a bit about services <a href="https://dev.to/mpocock1/xstate-should-this-be-an-action-or-a-service-2cp0" target="_blank" rel="noopener noreferrer">here</a> - but today I wanted to talk about my favourite way of expressing services: the Invoked Callback.</p><p>The <a href="https://xstate.js.org/docs/guides/communication.html#invoking-callbacks" target="_blank" rel="noopener noreferrer">Invoked Callback</a> combines immense flexibility with good readability and a solid Typescript experience. They look like this:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> onReceive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// Run any code you like inside here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// Any code inside here will be called when</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// you leave this state, or the machine is stopped</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let’s break this down. You get access to <code>context</code> and <code>event</code>, just like promise-based services. But <code>send</code> is where things really get interesting. Let’s break down what makes <code>send</code> useful with an example.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-uploads">File Uploads<a href="#file-uploads" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Imagine you need to build a file uploader, and you have a handy function called <code>startUpload</code> that uploads some data, and exposes an <code>onProgressUpdate</code> parameter to update the progress.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    progress</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    idle</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">START</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"pending"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    pending</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">PROGRESS_UPDATED</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          assign</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">progress</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">progress</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">CANCEL</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> uploader </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">startUpload</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">onProgressUpdate</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">progress</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"PROGRESS_UPDATED"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">                progress</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            uploader</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">cancel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This machine starts in the <code>idle</code> state, but on the <code>START</code> event begins its invoked service, which uploads the file. It then listens for <code>PROGRESS_UPDATED</code> events, and updates the context based on its updates.</p><p>The <code>CANCEL</code> event will trigger the <code>uploader.cancel()</code> function, which gets called when the state is left. React users may recognise this syntax - it’s the same as the cleanup function in the <a href="https://reactjs.org/docs/hooks-reference.html#cleaning-up-an-effect" target="_blank" rel="noopener noreferrer">useEffect hook</a>.</p><p>Note how simple and idiomatic it is to cancel the uploader - just exit the state, and the service gets cleaned up.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="event-listeners">Event Listeners<a href="#event-listeners" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The invoked callback’s cleanup function makes it very useful for event listeners, for instance <code>window.addEventListener()</code>. XState Catalogue’s <a href="https://xstate-catalogue.com/machines/tab-focus" target="_blank" rel="noopener noreferrer">Tab Focus Machine</a> is a perfect example of this - copied here for ease:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"userIsOnTab"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      userIsOnTab</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"checkForDocumentBlur"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">REPORT_TAB_BLUR</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"userIsNotOnTab"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      userIsNotOnTab</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"checkForDocumentFocus"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">REPORT_TAB_FOCUS</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"userIsOnTab"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    services</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">checkForDocumentBlur</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">listener</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"REPORT_TAB_BLUR"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">addEventListener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"blur"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> listener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">removeEventListener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"blur"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> listener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">checkForDocumentFocus</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">listener</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"REPORT_TAB_FOCUS"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">addEventListener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"focus"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> listener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          window</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">removeEventListener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"focus"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> listener</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When in the <code>userIsOnTab</code> state, we listen for the window’s <code>blur</code> event. When that happens, and <code>REPORT_TAB_BLUR</code> is fired, we clean up the event listener and head right on over to <code>userIsNotOnTab</code>, where we fire up the other service.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="websockets">Websockets<a href="#websockets" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Invoked callbacks can also receive events via the <code>onReceive</code> function. This is perfect when you need to communicate to your service, such as sending events to websockets.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> forwardTo </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token constant" style="color:rgb(129, 31, 63)">SEND</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">forwardTo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"websocket"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"websocket"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> onReceive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> websocket </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">connectWebsocket</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function" style="color:rgb(0, 0, 255)">onReceive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">type </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"SEND"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          websocket</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        websocket</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">disconnect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In order to receive events, services need an <code>id</code>. Not all events are forwarded to the invoked service, only those which we select via the <code>forwardTo</code> action.</p><p>Here, we can connect to the websocket, establish two-way communication, and clean it up all in a few lines of code.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="my-love-letter">My Love Letter<a href="#my-love-letter" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Invoked callbacks are a concise, flexible method of invoking services in XState. There isn’t a case they can’t cover - and they’re one of my favourite parts of the XState API.</p>]]></content:encoded>
            <category>services</category>
            <category>invoked callback</category>
            <category>state machine</category>
            <category>xstate</category>
        </item>
        <item>
            <title><![CDATA[Should this be an action, or a service?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-04-30-should-this-be-an-action-or-a-service</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-04-30-should-this-be-an-action-or-a-service</guid>
            <pubDate>Fri, 30 Apr 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Whether to use an action or a service in XState.]]></description>
            <content:encoded><![CDATA[<p>XState offers several ways of orchestrating side effects. Since it’s a statechart tool, <a href="https://dev.to/mpocock1/usestate-vs-usereducer-vs-xstate-part-1-modals-569e" target="_blank" rel="noopener noreferrer">with significantly more power than a reducer</a>, side effects are treated as a first-class concept.</p><p>‘Side effects’ as a concept spring from the idea of ‘pure’ functions. I.e. a function is at its best when it takes an input and returns an output. Pure functions don’t tend to involve:</p><ul><li>Waiting a set amount of time</li><li>Making an API call to an external service</li><li>Logging things to an external service</li></ul><p>So we can think of all of the above as ‘side effects’ of our programme running. The name gives them a negative, medical, connotation - but really, they’re the meat of your app. Apps that don’t have side effects don’t talk to anything external, don’t worry about time, and don’t react to unexpected errors.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="actions">Actions<a href="#actions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><blockquote><p>“Thank u, next.” - Ariana Grande</p></blockquote><p>Side effects can be expressed in two ways in XState. First, as a fire-and-forget <code>action</code>. Let’s imagine that when the user opens this modal, we want to report to a logging service that this happened.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> modalMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      closed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      open</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        entry</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"reportThatUserOpenedTheModal"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// Note that I'm declaring the action name above, but implementing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// it here. This keeps the logic and implementation separate,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// which I like</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">reportThatUserOpenedTheModal</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"/external-service/user-opened-modal"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Actions are fire-and-forget, which means you can fire them off without worrying about consequences. If the action I declared above errors, my state machine won’t react - it’s already forgotten about it.</p><p>Actions represent a single point in time, like a dot on a graph. This means that you can place them very flexibly. Above, I’ve placed them on the <code>entry</code> attribute of the state, meaning that action will be fired when we enter the state. I could also place them on the transition:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> modalMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      closed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"reportThatUserOpenedTheModal"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      open</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">reportThatUserOpenedTheModal</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// implementation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This means that whenever <code>OPEN</code> is called from the <code>closed</code> state, that action will be fired. In this modal, we could also fire the action whenever the user leaves the <code>closed</code> state, since we know they’ll be going to the <code>open</code> state.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> modalMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      closed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        exit</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token string" style="color:rgb(163, 21, 21)">"reportThatUserOpenedTheModal"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      open</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">reportThatUserOpenedTheModal</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// implementation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Actions are flexible precisely because we don’t care about their outcome. We can hang them on the hooks our state machine gives us: transitions between states, exiting states and entering states.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="services">Services<a href="#services" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><blockquote><p>“And I plan to be forgotten when I’m gone…” - The Tallest Man on Earth</p></blockquote><p>But actions have a specific limitation - they are designed to be forgotten. Let’s imagine that you wanted to track whether the analytics call you made was successful, and only open the modal if it was. We’ll add an <code>opening</code> state which handles that check.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> modalMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    closed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"opening"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    opening</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      entry</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"/external-service/user-opened-modal"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// OK, this was successful - how do I get to the open state?!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    open</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This isn’t possible in an action. We can’t fire back an event to the machine, because it’s already forgotten about us.</p><p>When you care about the result of an action, put it in a service. This is how this would be expressed as a service:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> modalMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    closed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"opening"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    opening</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// This uses the invoked callback syntax - my favourite</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// syntax for expressing services</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"/external-service/user-opened-modal"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"OPENED_SUCCESSFULLY"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        onError</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">OPENED_SUCCESSFULLY</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    open</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If actions are a dot on the graph, services represent a line - a continuous process which takes some amount of time. If the service errors, it’ll trigger an event called <code>error.platform.serviceName</code>, which you can listen for with the <code>onError</code> attribute, as above.</p><p>Crucially, they can also send events back to the machine, using the <code>send</code> function above. Notice that we’re both sending back the <code>OPENED_SUCCESSFULLY</code> event <em>and</em> listening to it in the <code>on: {}</code> attribute of the <code>opening</code> state.</p><p>Services are less flexible than actions, because they demand more from you. You can’t hang them on every hook your machine offers. They must be contained within one state, and they’re cancelled when you leave that state. (Note: they can also be at the root of the machine definition, meaning they run for the lifetime of the machine.)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="guidelines">Guidelines<a href="#guidelines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Actions are the ‘thank u, next’ of the XState world. They represent points in time. Use them for fire-and-forget actions. Actions are great for:</p><ul><li><code>console.log</code></li><li>Showing ephemeral error or success messages (toasts)</li><li>Navigating between pages</li><li>Firing off events to external services or parents of your machine</li></ul><p>Services are like a ‘phase’ your machine goes through. They represent a length of time. Use them for processes where you care about the outcome, or you want the process to run for a long time. Services are great for:</p><ul><li>API calls</li><li>Event listeners (<code>window.addEventListener</code>)</li></ul>]]></content:encoded>
            <category>action</category>
            <category>state machine</category>
            <category>xstate</category>
            <category>service</category>
        </item>
        <item>
            <title><![CDATA[Should this be a state, or in context?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-04-29-should-this-be-a-state-or-in-context</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-04-29-should-this-be-a-state-or-in-context</guid>
            <pubDate>Thu, 29 Apr 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[How to decide when to use state or context.]]></description>
            <content:encoded><![CDATA[<p>State machines offer several API’s for expressing state. Like other tools, you can keep arbitrary values in a store (usually expressed as an object) called <code>context</code>.</p><p>This is handy for values which change over time and you need to keep updated, like the value of a form input:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> assign </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    name</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">""</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token constant" style="color:rgb(129, 31, 63)">CHANGE_NAME</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          name</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Every time the <code>CHANGE_NAME</code> event is sent to the machine, we'll update the value in <code>context</code>. We can then use that value to display the value in our UI or send it to an API.</p><p>XState also gives you another way of expressing state - through finite states. Let's imagine a modal:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    closed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    open</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"close"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here, the modal's state is expressed through the <code>states: {}</code> attribute, which also defines which events can be received during each state. You can only <code>CLOSE</code> the modal when it's <code>open</code>, and vice versa.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="which-should-i-choose">Which should I choose?<a href="#which-should-i-choose" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The choice between using <code>context</code> and <code>states</code> isn't always clear. For instance, the modal machine above could be expressed using <code>context</code>:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This gives you exactly the same functionality as the states-based one above - you can track when the modal is open and closed, and send the same events.</p><p>The reason this can be expressed using both <code>states</code> and <code>context</code> is because <em>all of the events do the same thing no matter what state you’re in</em>. There are no events you need to declare as impossible in certain states.</p><p>To show you what I mean, let’s imagine a form input inside a modal. We only want to allow changes to the form input while the modal is open.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    name</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">""</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    closed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    open</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"close"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">CHANGE_NAME</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              name</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When the modal is in the <code>closed</code> state, the <code>CHANGE_NAME</code> event will not change the value in <code>context</code>. State machines are great at this - only allowing the things you want to happen to happen. Some other examples might be:</p><ul><li>Not allowing users to submit a form while the previous API call is loading</li><li>Only allowing users to log in if they’re not already logged in</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="putting-things-in-context">Putting things in context<a href="#putting-things-in-context" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You might be wondering - but, I <em>can</em> express the above in <code>context</code>!</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    name</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">""</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token constant" style="color:rgb(129, 31, 63)">OPEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token constant" style="color:rgb(129, 31, 63)">CLOSE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token constant" style="color:rgb(129, 31, 63)">CHANGE_NAME</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// This acts as the guard to prevent editing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// the name while it's open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">isOpen</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          name</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I think this is incorrect for two reasons. First, as requirements grow, so will the complexity of your logic. Let’s imagine that the modal can now be either <code>closing</code> (i.e. animating out) or <code>closed</code>. We’ll soon see an explosion of booleans, as I discussed in <a href="https://dev.to/mpocock1/usestate-vs-usereducer-vs-xstate-part-1-modals-569e" target="_blank" rel="noopener noreferrer">this article on useState/useReducer</a>.</p><p>Second, XState is auto-documenting via the <a href="https://xstate.js.org/viz/" target="_blank" rel="noopener noreferrer">XState visualiser</a>. The more your logic is expressed in <code>states</code>, the easier it’s going to be to visualise. The machine above is basically a single state with its logic expressed in ways that XState can’t visualise.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="rules-to-live-by">Rules to live by<a href="#rules-to-live-by" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You should be keeping most of your state in context. That includes form values, API data - anything which cannot be expressed finitely.</p><p>But state machines are powerful <em>because</em> of their states. Use states when you want to express your logic visually, or gate events to certain states.</p>]]></content:encoded>
            <category>context</category>
            <category>state machine</category>
            <category>xstate</category>
            <category>state</category>
        </item>
        <item>
            <title><![CDATA[What’s the difference between Machine and createMachine?]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-04-28-whats-the-difference-between-machine-and-createmachine</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-04-28-whats-the-difference-between-machine-and-createmachine</guid>
            <pubDate>Wed, 28 Apr 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[XState offers two options for declaring machine definitions. This can be confusing for beginners. Why are there two very similar-looking methods? What’s the difference?]]></description>
            <content:encoded><![CDATA[<p>XState offers two options for declaring machine definitions:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> Machine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">config </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>…or…</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">config </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This can be confusing for beginners. Why are there two very similar-looking methods? What’s the difference?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-difference">The Difference<a href="#the-difference" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In Javascript, there is no difference between the two. You can use them completely interchangeably.</p><p>In Typescript, there is only a small difference between them - it’s to do with the ordering of the generics you can pass to the machine. <code>Machine</code> allows you to pass a generic called <a href="https://xstate.js.org/docs/guides/typescript.html#typestates" target="_blank" rel="noopener noreferrer">'Typestates'</a> in the middle of the <code>Context</code> and <code>Event</code> generics.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> Machine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Context</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Event</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"EVENT_NAME"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">States</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">Machine</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">Context</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> States</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> Event</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">config </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Whereas <code>createMachine</code> asks you to insert it at the end:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Context</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Event</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"EVENT_NAME"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">States</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">Context</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> Event</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> States</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">config </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Whichever you choose, there is <em>no functional difference in the created machine</em>. The two functions reference the same code, and create the machine in the same way.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-should-i-choose">What should I choose?<a href="#what-should-i-choose" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Going forward, you should use <code>createMachine</code>. That’s the syntax that will be preferred when v5 releases. But if you're happy with Machine, you can keep using it.</p>]]></content:encoded>
            <category>typescript</category>
            <category>state machine</category>
        </item>
        <item>
            <title><![CDATA[You don’t need a library for state machines]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-01-20-you-dont-need-a-library-for-state-machines</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-01-20-you-dont-need-a-library-for-state-machines</guid>
            <pubDate>Wed, 20 Jan 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Do you need a library to create and interpret state machines in your programs? No. But there are more things to consider.]]></description>
            <content:encoded><![CDATA[<p>The finite state machine is one of the oldest models of computation in computer science. It’s older than the web, older than any programming language you can think of, and probably older than you. Just ask <a href="https://en.wikipedia.org/wiki/Mealy_machine" target="_blank" rel="noopener noreferrer">Mealy (1955)</a> or <a href="https://en.wikipedia.org/wiki/Moore_machine" target="_blank" rel="noopener noreferrer">Moore (1956)</a>. Finite state machines (FSMs) can be implemented in any modern language using control-flow statements, yet there’s most likely a state machine library (if not many) in all of those languages.</p><p>So do you need a library to create and interpret state machines in your programs?</p><p><strong>No.</strong> But there are more things to consider.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="you-probably-need-state-machines">You probably need state machines<a href="#you-probably-need-state-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you’re unfamiliar with <a href="https://en.wikipedia.org/wiki/Finite-state_machine" target="_blank" rel="noopener noreferrer">finite state machines (FSMs)</a>, they are a visual and mathematical way of modeling stateful logic using 3 main building blocks:</p><ul><li><strong>Finite states</strong>, which represent different <em>behaviors</em></li><li><strong>Events</strong>, which represent something that happened that can change state</li><li><strong>Transitions</strong>, which represent how the state can change and what actions are executed when an event is received</li></ul><p><img loading="lazy" src="https://res.cloudinary.com/practicaldev/image/fetch/s--NRBTk8Po--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/7ri5sbbrufj26cq3u026.png" alt="States, events, and transitions" class="img_ev3q"></p><p>Anything that can be described as changes in state over time due to events, from component-specific logic to application flows and even the orchestration of multiple services can be described with state machines, to some extent.</p><p>A state machine might be a different, unfamiliar way of thinking about your application logic, but they’re extremely useful. Instead of approaching logic from a "bottom-up" perspective (imperatively doing things based on events), they take a "top-down" approach and primarily consider <em>behaviors</em>, which describe how the logic will react to events in a given finite state (such as <code>loading</code>, <code>editing</code>, <code>disabled</code>, etc.).</p><p>Because of their explicit, declarative nature, state machines force you to think about the entire flow of your logic (including all the edge-cases), and make it virtually impossible to end up in an ”impossible state”, as long as your model doesn’t allow it. Only defined transitions can happen; and if an unexpected transition happens, it means there is an implicit state machine where that transition <em>does</em> exist. The goal of state machines is to eliminate the implicit transitions so that we can know exactly what can happen in any state for any potential event.</p><p>State machines are <strong>not a solution for everything</strong> - just like anything else, they make sense for some use-cases (workflows, processes, modes, statuses, etc.) but not all use-cases. You shouldn’t use state machines everywhere, or even implement them explicitly all of the time (that’s what abstractions are for). They make a good refactor target, and they’re great for visually modeling your logic with pencil and paper, even if you ultimately decide not to use them in your code. But when working with logic that deals with explicit states, events, and transitions (which, surprise, tends to be the majority of app logic), state machines are a brilliant, natural solution.</p><p>There are so many other benefits to thinking in terms of states, events, and transitions, but that’s not the point of this post (but it is the point of <a href="https://dev.to/davidkpiano/no-disabling-a-button-is-not-app-logic-598i" target="_blank" rel="noopener noreferrer">another post I wrote</a>). Let’s say you’re already convinced in using state machines in parts of your app. Should you reach for a library?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="you-dont-need-a-library-for-state-machines">You don’t need a library for state machines<a href="#you-dont-need-a-library-for-state-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Since state machines are not a new concept and can be implemented in any modern language using built-in language features, it follows that state machine libraries are not necessary. Again, all you need are the 3 building blocks:</p><ul><li><strong>Finite states</strong></li><li><strong>Events</strong></li><li><strong>Transitions</strong></li></ul><p>The transitions are what tie everything together. Transitions are represented by a <a href="https://en.wikipedia.org/wiki/Finite-state_machine#Mathematical_model" target="_blank" rel="noopener noreferrer">state-transition function</a> that looks like this, mathematically:</p><blockquote><p>𝛅 : 𝑆 𝗑 𝛴 → 𝑆</p></blockquote><p>…which might not make sense (even if you do speak Greek). This might be more understandable:</p><blockquote><p>transition : (state, event) =&gt; nextState</p></blockquote><p>In JavaScript, we can represent this as a <em>reducer</em>, which is a function that reduces values (events) to a single accumulated value (state):</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">transition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// state machine goes here, which</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// determines the next state based on the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// current state + received event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, let’s draw the rest of the owl implement the rest of the state machine!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-switch-statements">Using <code>switch</code> statements<a href="#using-switch-statements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Typically, when we’re determining <em>behavior</em> ("what happens next"), we tend to decide what should happen next based on the <em>event</em>. The finite state is an after-thought, if it’s even a consideration at all. This leads to fragile logic, with <code>if</code>-<!-- -->statements strewn all over the place:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ❌ Event-first approach</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'DATA_RECEIVED'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// defensive programming</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">isLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// do something</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In contrast, state machines group behavior by <strong>finite state</strong> and narrow down what happens next based on the event received:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// ✅ Finite-state-first approach</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// narrow based on event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"DATA_RECEIVED"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// do something, and possibly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// change the finite state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As the author of the code, the event-first (bottom-up) approach might seem fine to you; after all, if it works, it works. One of the main advantages of taking a ”finite-state-first” (top-down) approach and using state machines is that the logic is not only more clear (since it’s grouped by finite state), it’s more robust: you can ensure that an event won’t be improperly handled in a state that it shouldn’t be handled in. In other words, you prevent <em>impossible states</em> and <em>impossible transitions</em> without having to litter your code with <code>if</code>-<!-- -->statements and excessive defensive programming.</p><p>I also like to think of state machines as a formal way of communicating logic. If you were describing the above logic, here’s how it would sound with an event-first approach:</p><blockquote><p>When data is received, do something, but only if the "loading" flag is true.</p></blockquote><p>And with a finite-state-first approach:</p><blockquote><p>In the ”loading” state, when data is received, do something.</p></blockquote><p>Which one sounds more natural and easy to understand? To me, there is less cognitive load with the 2nd statement. Reactions to events are grouped by <em>behavior</em> (finite state) rather than being ungrouped.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-switch-statements-with-functions">Using <code>switch</code> statements with functions<a href="#using-switch-statements-with-functions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Since finite states can be considered a way to group behavior, another way you can organize your <code>switch</code> statements is by “grouping” each finite state’s behavior into a function:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// 'loading' behavior</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">loadingState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// switch only on the event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'DATA_RECEIVED'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'success'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dataMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'loading'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// handle the event with 'loading' behavior</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">loadingState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This approach is outlined in the <a href="https://redux.js.org/style-guide/style-guide/#treat-reducers-as-state-machines" target="_blank" rel="noopener noreferrer">Redux style guide recommendation: Treat Reducers as State Machines</a>. It’s a very organized approach, and each “behavior function” can be individually tested, since they are isolated, pure reducers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-objects">Using objects<a href="#using-objects" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Using nested <code>switch</code> statements may feel verbose, and while using functions to organize these <code>switch</code> statements may look cleaner, it’s more tedious. After all, a state transition can be considered a configuration of (at least) 2 things based on the event received:</p><ul><li>The next <strong>finite state</strong>, if it changes</li><li>Any <strong>action(s)</strong> executed, if any</li></ul><p>A simple, built-in way to represent such a configuration is an object. We can create an object structure where each ”state node” represents a finite state with transitions for each event accepted by the state:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// A finite "state node"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">loading</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token literal-property property">on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// event types</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">DATA_RECEIVED</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token literal-property property">target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"success"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// actions: [...]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is much more succinct than the nested <code>switch</code> statements! From here, determining the next state based on the current finite state and received event is two key lookups (the finite state and the event type):</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">transition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> nextStateNode </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// lookup next finite state based on event type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// lookup configuration for current finite state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">states</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">on</span><span class="token operator" style="color:rgb(0, 0, 0)">?.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">??</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// if not handled, stay on current state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> nextStateNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">transition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"DATA_RECEIVED"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// =&gt; { status: 'success', ... }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You might be wondering why I didn’t use an even simpler object here, which you definitely can do:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> transitions </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">loading</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token constant" style="color:rgb(129, 31, 63)">DATA_RECEIVED</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"success"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">success</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">transition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> nextStateTarget </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> transitions</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">??</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> nextStateTarget</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In fact, I would encourage the above implementation as sort of a “transition table lookup”; it works, and it’s simple enough. However, state machines deal with more than just the next finite state; if we want to encode <strong>actions</strong> (state machine terminology for effects), we need a place to put them, so a little bit more structure is necessary.</p><p>For instance, if our <code>DATA_RECEIVED</code> event returns data that we want to save in our overall state, it might be convenient to place that “assign to state” action directly in the machine:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">loading</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token literal-property property">on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// event types</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">DATA_RECEIVED</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token literal-property property">target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"success"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// represents what "effects" should happen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// as a result of taking this transition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token literal-property property">actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"saveData"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">transition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> nextStateNode </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">states</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">on</span><span class="token operator" style="color:rgb(0, 0, 0)">?.</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">??</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> nextState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> nextStateNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// go through the actions to determine</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// what should be done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  nextStateNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">actions</span><span class="token operator" style="color:rgb(0, 0, 0)">?.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">forEach</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"saveData"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      nextState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">data</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The implementation above is very small, accomplishes everything we want from a state machine (for this use-case, at least), and as a bonus, you can copy-paste the <code>machine</code> object code directly into the <a href="https://xstate.js.org/viz" target="_blank" rel="noopener noreferrer">XState Visualizer</a>, even though it's not using XState, or any libraries, at all! (Tip: wrap the object in <code>Machine({ ... })</code> to get it working).</p><p>Kent C. Dodds made a similar implementation is his post <a href="https://kentcdodds.com/blog/implementing-a-simple-state-machine-library-in-javascript" target="_blank" rel="noopener noreferrer">Implementing a Simple State Machine Library in JavaScript</a>. It also takes advantage of using objects for describing the state machine structure.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="state-machines-arent-enough">State machines aren't enough<a href="#state-machines-arent-enough" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>So if we can get our basic state management needs met with a small, declarative, library-free state machine implementation (either using <code>switch</code> statements or objects), why do we need libraries such as <a href="https://github.com/davidkpiano/xstate" target="_blank" rel="noopener noreferrer">XState</a>?</p><p>This might be a bit of a shock coming from me, but I’ll say it: <em>state machines are not sufficient</em> for managing and orchestrating state at scale. State machines suffer from a fundamental problem called <a href="https://statecharts.github.io/state-machine-state-explosion.html" target="_blank" rel="noopener noreferrer">state explosion</a>: when the number of states in a state machine grow, the transitions between states also tend to grow, <em>exponentially</em>.</p><p>Thankfully, an extension to the traditional formalism of state machines, known as <strong>statecharts</strong>, was invented by Prof. David Harel and published in his paper <a href="https://www.sciencedirect.com/science/article/pii/0167642387900359/pdf" target="_blank" rel="noopener noreferrer">Statecharts: A Visual Formalism for Complex Systems</a>. The paper is full of diagrams and is quite readable; I strongly encourage you to read it.</p><p>You can think of statecharts as essentially being state machines (statecharts can be decomposed into FSMs) with some essential features for better state organization and real-world use-cases:</p><ul><li><strong>Hierarchy</strong> (nested states)</li><li><strong>Orthogonality</strong> (parallel states)</li><li><strong>History</strong> (remembered states)</li><li><strong>State actions</strong> (entry, exit)</li><li><strong>Guarded transitions</strong></li><li><strong>Extended state</strong> (contextual data)</li></ul><p>Notably, the first two features (hierarchy and orthogonality) mitigate the state explosion problem by allowing state nodes to be grouped in a way that reduces the number of transitions necessary to fully express all possible transitions.</p><p>For example, if you were creating a state machine to represent editing and asynchronously saving some data, and you wanted to have shared behavior between some ”idle” (before saving) and “error” (failure after saving) state (e.g., <code>SUBMIT</code> to try/retry), then instead of having a flat state machine:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token literal-property property">idleNormal</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token literal-property property">on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">SAVE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token literal-property property">target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'saving'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token literal-property property">actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'saveAsync'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token literal-property property">saving</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token literal-property property">idleError</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token literal-property property">on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">SAVE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token literal-property property">target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'saving'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token literal-property property">actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'saveAsync'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can represent the shared behavior under the same parent state:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token literal-property property">idle</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// if child states don't handle these events,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// handle it here, in the parent state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token literal-property property">on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token constant" style="color:rgb(129, 31, 63)">SAVE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token literal-property property">target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'saving'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token literal-property property">actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'saveAsync'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token literal-property property">initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'normal'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token literal-property property">states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token literal-property property">normal</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token literal-property property">error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token literal-property property">saving</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Overall, the features of statecharts are very useful in many different situations:</p><ul><li><strong>Nested states</strong> are useful for grouping and refining behavior. Different ”finite states” can all share behavior, while all having their own specific behavior.</li><li><strong>Parallel states</strong> are useful for representing behaviors that can occur simultaneously, without directly affecting each other.</li><li><strong>History states</strong> are useful for recalling which nested state the machine was previously in without having to specify all the possible ”remembering” transitions.</li><li><strong>State actions</strong> are useful for specifying actions that should always be executed on any transition that enters/exits a state without having to specify those actions in all incoming/outgoing transitions.</li><li><strong>Guarded transitions</strong> are very important for conditionally taking transitions based on more than just the state and event type. They can take other data (extended state) and/or event data into consideration, as well.</li><li><strong>Extended state</strong> is absolutely necessary. Not all state is finite; ”infinite” state also needs to be quantified. Statecharts allow you to distinguish between finite and extended state.</li></ul><p>There's even more features of classic statecharts, such as ”activities” (actions that occur <em>throughout</em> a state), delays, eventless transitions, wildcard transitions, and more. And the more you work with statecharts, the more you realize just how essential most of these features actually are.</p><p>Sounds like it would be fun to implement these features on top of our state machines, right?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementing-statecharts">Implementing statecharts<a href="#implementing-statecharts" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>I hope you have a <em>lot</em> of free time.</p><p>Since statecharts are more powerful than state machines, they’re also harder to implement. If you’re really curious and/or eager to implement them yourself, I strongly recommend following the <a href="https://www.w3.org/TR/scxml" target="_blank" rel="noopener noreferrer">W3 SCXML (Statechart XML) spec</a>. They even include <a href="https://www.w3.org/TR/scxml/#AlgorithmforSCXMLInterpretation" target="_blank" rel="noopener noreferrer">an algorithm in pseudocode</a> for proper SCXML interpretation.</p><p>Even implementing something as seemingly straightforward as nested states is a daunting task. There are many rules about selecting transitions, resolving conflicting transitions, traversing the state node tree to determine which nodes are being exited/entered, selecting transitions in compound states if leaf nodes don't handle the event, determining action order, etc. etc.</p><p>It’s not easy, and just like you would use a date library to deal with timezones, you definitely want to use a statechart library to deal with all the excellent features that statecharts support.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="so-do-you-need-a-library-for-statecharts">So do you need a library for statecharts?<a href="#so-do-you-need-a-library-for-statecharts" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Yes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="closing-thoughts">Closing thoughts<a href="#closing-thoughts" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you’re satisfied manipulating state at any time and sprinkling <code>if</code>-<!-- -->statements to patch up edge-cases, you probably don’t need explicit state machines.</p><p>If you want to use simple state machines to help organize app behavior and logic, you don’t need a library.</p><p>If you have complex logic and want to take advantage of more powerful state machine features to better manage this logic, you need statecharts.</p><p>And you <em>definitely</em> need a library for statecharts. 😉</p>]]></content:encoded>
            <category>finite state machine</category>
            <category>statechart</category>
            <category>xstate</category>
            <category>state machine</category>
        </item>
        <item>
            <title><![CDATA[“Just use props”: An opinionated guide to React and XState]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2021-01-11-just-use-props-an-opinionated-guide-to-react-and-xstate</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2021-01-11-just-use-props-an-opinionated-guide-to-react-and-xstate</guid>
            <pubDate>Mon, 11 Jan 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[XState is the most powerful tool available for managing complex state. The challenge comes when integrating XState with React…]]></description>
            <content:encoded><![CDATA[<p>XState can feel overwhelming. Once you’ve gone through <a href="https://egghead.io/courses/introduction-to-state-machines-using-xstate" target="_blank" rel="noopener noreferrer">Kyle</a> or <a href="https://frontendmasters.com/courses/xstate/" target="_blank" rel="noopener noreferrer">David’s</a> courses and read through the <a href="https://xstate.js.org/docs" target="_blank" rel="noopener noreferrer">docs</a>, you’ll get a thorough understanding of the API. You’ll see that XState is the most powerful tool available for managing complex state.</p><p>The challenge comes when integrating XState with React. Where should state machines live in my React tree? How should I manage parent and child machines?</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="just-use-props">Just Use Props<a href="#just-use-props" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>I’d like to propose an architecture for XState and React which prioritises simplicity, readability and type-safety. It’s incrementally adoptable, and gives you a base for exploring more complex solutions. We’ve used it at <a href="https://www.yozobi.com/" target="_blank" rel="noopener noreferrer">Yozobi</a> in production, and we’re planning to use it for every project moving forward.</p><p>It’s called <strong>just use props</strong>. It’s got a few simple rules:</p><ol><li>Create machines. Not too many. Mostly useMachine</li><li>Let React handle the tree</li><li>Keep state as local as possible</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-machines-not-too-many-mostly-usemachine">Create machines. Not too many. Mostly useMachine<a href="#create-machines-not-too-many-mostly-usemachine" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>The simplest way to integrate a state machine in your app is with <code>useMachine</code>.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> interpret </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    open</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    closed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">Component</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Open"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that this puts React in charge of the machine. The machine is tied to the component, and it obeys all the normal React rules of the <a href="https://reactjs.org/docs/state-and-lifecycle.html#the-data-flows-down" target="_blank" rel="noopener noreferrer">data flowing down</a>. In other words, you can think of it just like <code>useState</code> or <code>useReducer</code>, but a <a href="https://dev.to/mpocock1/usestate-vs-usereducer-vs-xstate-part-1-modals-569e" target="_blank" rel="noopener noreferrer">vastly improved version</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="let-react-handle-the-tree">Let React handle the tree<a href="#let-react-handle-the-tree" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Let’s say you have a parent component and a child component. The parent has some state which it needs to pass to the child. There are several ways to do this.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="passing-services-through-props">Passing services through props<a href="#passing-services-through-props" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>The first is to pass a running service to the child which the child can subscribe to:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> useService </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> Interpreter </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> * Types for the machine declaration</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">MachineContext</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">MachineEvent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">MachineContext</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> MachineEvent</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">ParentComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">   * We instantiate the service here...</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> service</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">ChildComponent service</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">service</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ChildComponentProps</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  service</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> Interpreter</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">MachineContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">any</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> MachineEvent</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">ChildComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">props</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> ChildComponentProps</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">   * ...and receive it here</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useService</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">service</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Open"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I don’t like this pattern. For someone not used to XState, it’s unclear what a ‘service’ is. We don’t get clarity from reading the types, which is a particularly ugly <code>Interpreter</code> with multiple generics.</p><p>The machine appears to bleed across multiple components. Its service seems to have a life of its own, outside of React's tree. To a newbie, this feels like misdirection.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="just-pass-props">Just pass props<a href="#just-pass-props" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h4><p>This can be expressed much more cleanly using props:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> * Types for the machine declaration</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">MachineContext</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">MachineEvent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">MachineContext</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> MachineEvent</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">ParentComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">ChildComponent</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      toggle</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> * Note that the props declarations are</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> * much more specific</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ChildComponentProps</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">boolean</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">void</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">ChildComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">props</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> ChildComponentProps</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> props</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">toggle</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">isOpen </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Open"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Closed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Much better. We get several improvements in clarity in the <code>ChildComponent</code> - the types are much easier to read. We get to ditch the use of <code>Interpreter</code> and <code>useService</code> entirely.</p><p>The best improvement, though, is in the <code>ParentComponent</code>. In the previous example, the machine crossed multiple components by passing its service around. In this example, it’s scoped to the component, and props are derived from its state. This is far easier to grok for someone unused to XState.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="keep-state-as-local-as-possible">Keep state as local as possible<a href="#keep-state-as-local-as-possible" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Unlike tools which require a global store, XState has no opinion on where you keep your state. If you have a piece of state which belongs near the root of your app, you can use React Context to make it globally available:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createContext </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> globalMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">GlobalContextType</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">boolean</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">void</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> GlobalContext </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">createContext</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">GlobalContextType</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> Provider</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function-variable function" style="color:rgb(0, 0, 255)">FC</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> children </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">globalMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">GlobalContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Provider</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      value</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">toggle</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"TOGGLE"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">GlobalContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">Provider</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Just as above, we’re not passing a service, but props, into context.</em></p><p>If you have a piece of state which needs to belong lower in your tree, then obey the usual rules by <a href="https://reactjs.org/docs/lifting-state-up.html" target="_blank" rel="noopener noreferrer">lifting state up</a> to where it’s needed.</p><p>If that feels familiar, you’re right. You’re making the same decisions you’re used to: where to store state and how to pass it around.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples-and-challenges">Examples and challenges<a href="#examples-and-challenges" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="syncing-parents-and-children">Syncing parents and children<a href="#syncing-parents-and-children" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h3><p>Sometimes, you need to use a parent machine <em>and</em> a child machine. Let’s say that you need the child to pay attention to when a prop changes from the parent - for instance to sync some data. Here’s how you can do it:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"open"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    numberToStore</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">     * When REPORT_NEW_NUMBER occurs, sync</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">     * the new number to context</span><br></span><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token constant" style="color:rgb(129, 31, 63)">REPORT_NEW_NUMBER</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            numberToStore</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">newNumber</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ChildComponentProps</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  someNumber</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">number</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">ChildComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">props</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> ChildComponentProps</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">useEffect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"REPORT_NEW_NUMBER"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      newNumber</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> props</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">someNumber</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">props</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">someNumber</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This can also be used to sync data from other sources, such as query hooks:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">ChildComponent</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useSomeDataHook</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetchNumber</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">useEffect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"REPORT_NEW_NUMBER"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      newNumber</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">someNumber</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">someNumber</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In the “just use props” approach, XState lets React take charge. We stick to idiomatic React by passing props, not services. We keep machines scoped to components. And we put state at the level it’s needed, just like you’re used to.</p><p>This article isn’t finished. I’m sure there will be many more questions about integrating XState with React. My plan is to come back to this article again with more examples and clarifications. Thanks for your time, and I’m looking forward to seeing what you build with XState.</p>]]></content:encoded>
            <category>prop</category>
            <category>xstate</category>
            <category>state machine</category>
            <category>react</category>
        </item>
        <item>
            <title><![CDATA[State machines: How to stop making Horcruxes in your code]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2020-07-27-state-machines-how-to-stop-making-horcruxes-in-your-code</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2020-07-27-state-machines-how-to-stop-making-horcruxes-in-your-code</guid>
            <pubDate>Mon, 27 Jul 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[There are several ways of mitigating horcruxes. But visualisations can prevent bugs, so why not go further?]]></description>
            <content:encoded><![CDATA[<p>My code contains <a href="https://harrypotter.fandom.com/wiki/Horcrux" target="_blank" rel="noopener noreferrer">Horcruxes</a>. I’m not proud to admit it, since to make a Horcrux you need to commit a murder. The murders seemed intuitive at the time, and were usually for expedience. But nonetheless, I am a murderer.</p><p>Let’s talk about how I got here.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-soul-of-your-apps-logic">The Soul of your app’s logic<a href="#the-soul-of-your-apps-logic" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>For an app to remain maintainable, its soul must remain intact. For many apps, logic is usually expressed in changes to state and behaviour.</p><p>For instance, some logic for a modal might be expressed like this:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">modalReducer</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"CLOSE"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"OPEN"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        isOpen</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">default</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is the reducer pattern, popularised by libraries like <a href="https://redux.js.org/introduction/getting-started" target="_blank" rel="noopener noreferrer">Redux</a>. In <a href="https://reactjs.org/" target="_blank" rel="noopener noreferrer">React</a>, we'd use this reducer in a <code>useReducer</code> hook:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">modalReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"OPEN"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">Open Modal</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you want to know what happens when you dispatch the <code>OPEN</code> action, you only need look in one place: the <code>modalReducer</code>. This part of your app is easy to keep bug-free, because all the logic for how it works is contained in one place.</p><p>But let’s say that requirements change. Now, before you open the modal you’ll need to fetch something from the API to check if you can open it. This seems intuitive enough:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">modalReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> canOpenTheModal </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">checkIfUserCanOpenIt</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">canOpenTheModal</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'OPEN'</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      Open Modal</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>onClick</code> handler is now making the API check to see if it should open the modal. If there’s a bug with the way the modal opens, there are now two places you need to check, the reducer and the event handler.</p><p>The soul of your business logic has been split. Just like that, you made a Horcrux.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="going-beyond-usual-evil">Going beyond usual evil<a href="#going-beyond-usual-evil" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The first Horcrux is never really the issue. You can survive one or two splits in your business logic. The trouble comes when you reach six or seven, split out over several 800-line files. I have wept over classes with dozens of methods, sequences with dozens of asynchronous steps.</p><p>Logic split into more than one place cannot be visualised. If it can’t be visualised, it can’t be modified, deleted or extended safely.</p><p>Let me make this plain: <strong>Any code that cannot be concretely visualised will, at some point, result in a bug.</strong></p><p>There are several ways of mitigating horcruxes. You can push to make your code more readable, writing clean event handlers which don’t contain any logic. You can try to colocate as much as your logic as possible, for instance using <a href="https://github.com/erikras/ducks-modular-redux" target="_blank" rel="noopener noreferrer">ducks</a> patterns.</p><p>But now we know that visualisation can prevent bugs, why not go further?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="statecharts">Statecharts<a href="#statecharts" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>I recently embarked on the most complex task I’d ever attempted as a developer - building a video chat app with multiple third-party integrations. Most of the business logic would take place on a single page - the chat portal. I needed to handle multiple user types, chat, notifications, input changes... And many more things.</p><p>I’d been using <a href="https://github.com/davidkpiano/xstate" target="_blank" rel="noopener noreferrer">XState</a>, and read that it could be used for visualising complex behaviours, such as Ryan Florence’s checkout:</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>It produces clickable visualisations which you can share and walk through. For instance, the modal reducer above could be expressed in <a href="https://xstate.js.org/viz/?gist=56c56d2be397c4d5bea934c6d89e788d" target="_blank" rel="noopener noreferrer">this statechart</a>.</p><p><img loading="lazy" src="https://res.cloudinary.com/practicaldev/image/fetch/s--XmLhsdr5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/2lb0ctiu7s207t9w44mg.png" alt="A statechart describing a modal which opens and closes" class="img_ev3q"></p><p>I knew that if I wasn’t careful, I’d end up with 25-30 horcruxes under my belt, logic carried in dozens of event handlers. So I wrote the machine in XState. I even wrote a VSCode extension so I could have the visualiser inline as I went along. Here’s what I ended up with:</p><p><img loading="lazy" src="https://res.cloudinary.com/practicaldev/image/fetch/s--oY3xYHhl--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/33vxe2bcsxn8uvfzlgva.png" alt="An XState diagram of my video chat app" class="img_ev3q"></p><p>Every part of this crazy complex app can now be visualised. I can see which conditions lead to which states. I can which actions are called on which events.</p><p>At an early stage of the process, I was even able to ask the client about complex interactions in the logic, just by walking them through the statechart. Weeks later, when it needed extending, I was able to insert a new piece of state without breaking anything else.</p><p>Any time someone needs to see how the viewing page works, they can fire up the visualiser. Their usual first reaction is one of terror. State machines don't create complexity, they reveal it. But by clicking through the machine, they can concretely see how the app works, and feel comfortable making changes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="make-a-bet-on-xstate">Make a bet on XState<a href="#make-a-bet-on-xstate" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><hr><p>If you’re having trouble deciphering the logic of a legacy app, try visualising it in XState. Try working through a problem with a fellow dev. At <a href="http://yozobi.com/" target="_blank" rel="noopener noreferrer">Yozobi</a>, we’re making a bet that state machines are going to change web development. If you want to learn more about them, follow me and we can try to heal our Horcruxes together.</p>]]></content:encoded>
            <category>business logic</category>
            <category>xstate</category>
            <category>statechart</category>
            <category>useReducer</category>
        </item>
        <item>
            <title><![CDATA[How to tell a bad boolean from a good boolean]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2020-05-27-state-management-bad-bolean-good-boolean</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2020-05-27-state-management-bad-bolean-good-boolean</guid>
            <pubDate>Wed, 27 May 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[TL;DR: Bad booleans represent state. Good booleans are derived from state]]></description>
            <content:encoded><![CDATA[<p><strong>TL;DR</strong>: Bad booleans represent state. Good booleans are derived from state.</p><p>When you’re managing state in your app, it’s easy to fall prey to bad booleans. Bad booleans look like this:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> isLoading </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> isComplete </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> hasErrored </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On the surface, this looks like good code. It appears as though you’ve represented three separate states with proper boolean names. In the ‘model’ you’ve pictured for your state, only one of these states can be true at any one time.</p><p>In a fetch request, you might model the state like this:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">makeFetch</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  isLoading </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"/users"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    isComplete </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    hasErrored </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  isLoading </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Again, this looks nice. We’re orchestrating our booleans as we move through the async request.</p><p>But there’s a bug here. What happens if we make the fetch, it succeeds, and we make the fetch again? We’ll end up with:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> isLoading </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> isComplete </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> hasErrored </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="implicit-states">Implicit states<a href="#implicit-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>You probably hadn’t considered this when you made your initial model. You may have frontend components which are checking for <code>isComplete === </code> true or <code>isLoading === true</code>. You might end up with a loading spinner and the previous data showing at the same time.</p><p>How is this possible? Well, you’ve created some implicit states. Let’s imagine you considered 3 states as ones you actually wanted to handle:</p><ol><li><code>loading</code>: Loading the data</li><li><code>complete</code>: Showing the data</li><li><code>errored</code>: Erroring if the data doesn't turn up</li></ol><p>Well, you’ve actually allowed 8 states! That’s 2 for the first boolean, times 2 for the second, times 2 for the third.</p><p>This is what's known as boolean explosion - I learned about this from <a href="https://egghead.io/lessons/javascript-eliminate-boolean-explosion-by-enumerating-states" target="_blank" rel="noopener noreferrer">Kyle Shevlin's egghead course</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="making-states-explicit">Making states explicit<a href="#making-states-explicit" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>How do you get around this? Instead of a system with 8 possible values, we need a system with three possible values. We can do this in Typescript with an enum.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Status</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"complete"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"errored"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> Status </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We’d implement this in a fetch like this:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">makeFetch</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  status </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"/users"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    status </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"complete"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    status </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"errored"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It’s now impossible to be in the 'loading' and 'complete' state at once - we’ve fixed our bug. We’ve turned our bad booleans into a good enum.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="making-good-booleans">Making good booleans<a href="#making-good-booleans" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>But not all booleans are bad. Many popular libraries, such as <em>react-query</em>, <em>apollo</em> and <em>urql</em> use booleans in their state. An example implementation:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useQuery</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">isLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token maybe-class-name">Loading</span><span class="token spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The reason these are good booleans is that their underlying mechanism is based on an enum. Bad booleans represent state. Good booleans are derived from state:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Status</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// Derived from the status above</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> isLoading </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> status </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can safely use this <code>isLoading</code> to display your loading spinner, happy in the knowledge that you've removed all impossible states.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="addendum-enums-in-javascript">Addendum: Enums in Javascript<a href="#addendum-enums-in-javascript" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>We can represent a state enum in Javascript as well. While the above code will work without typings, you can represent enums as an object type.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> statusEnum </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  loading</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  complete</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"complete"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  errored</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"errored"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> status </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> statusEnum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">makeFetch</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  status </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> statusEnum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">loading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"/users"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    status </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> statusEnum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">complete</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    status </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> statusEnum</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">errored</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>tutorial</category>
        </item>
        <item>
            <title><![CDATA[Redux is half of a pattern (2/2)]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2020-05-22-redux-is-half-a-pattern-2-2</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2020-05-22-redux-is-half-a-pattern-2-2</guid>
            <pubDate>Fri, 22 May 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[Learn how Redux, and all other state management libraries, have one thing in common - they are all partial implementations of state machines - and how we can improve the way we model app state and logic.]]></description>
            <content:encoded><![CDATA[<p>I wrote a form library once.</p><p><em>Once.</em></p><p>It was called <a href="https://github.com/davidkpiano/react-redux-form" target="_blank" rel="noopener noreferrer">React Redux Form</a>, and using Redux for forms was a good idea, at the time (don't use it). In fact, my library was written as a response to <a href="https://github.com/redux-form/redux-form" target="_blank" rel="noopener noreferrer">Redux Form</a>, and both libraries soon discovered that the idea of using a <em>single global store</em> to store all of your application state is a really, really bad idea.</p><p>When all of your forms live in one single store, state is easy to manage at first. And then, every single keypress starts to lag. It's a terrible user experience.</p><p>So what do you do?</p><ul><li>Blur inputs</li><li>Add debounced updates</li><li>Memoize <em>everything</em></li><li>Optimize selectors everywhere</li><li>Make controlled components uncontrolled</li><li>Use <code>React.memo()</code> on components</li><li>Use <code>PureComponent</code> for good measure</li><li>Use Suspense (??)</li><li>etc. etc.</li></ul><p>In short, you go into panic mode and try to contain the spread of the global updates affecting every single connected component, even if those components don't need to rerender.</p><p>Some of you have gotten really good at solving this, and have become expert "selector, caching, and memoization" developers. That's fantastic.</p><p>But let's examine if those tactics should even be necessary. What if all state <em>wasn't</em> global?</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="local-vs-global-state">Local vs. global state<a href="#local-vs-global-state" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The first of <a href="https://redux.js.org/introduction/three-principles" target="_blank" rel="noopener noreferrer">Redux's three principles</a> is that there is essentially a <em>single source of truth</em> for your whole application state:</p><blockquote><p>The state of your whole application is stored in an object tree within a single store.</p><p><em>Source: <a href="https://redux.js.org/introduction/three-principles#single-source-of-truth" target="_blank" rel="noopener noreferrer">Redux's three principles: single source of truth</a></em></p></blockquote><p>The primary reason for this is that it makes many things <em>easier</em>, such as sharing data, rehydrating state, "time-travel debugging", etc. But it suffers from a fundamental disconnect: <em>there is no such thing as a single source of truth</em> in any non-trivial application. All applications, even front-end apps, are distributed at some level:</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>And, in a contradictory way, even the Redux Style Guide advises against putting the entire state of your application in a single store:</p><blockquote><p>[...]<!-- --> Instead, there should be a single place to find all values that you consider to be global and app-wide. Values that are "local" should generally be kept in the nearest UI component instead.</p><p><em>Source: <a href="https://redux.js.org/style-guide/style-guide/#evaluate-where-each-piece-of-state-should-live" target="_blank" rel="noopener noreferrer">Redux Style Guide</a></em></p></blockquote><p>Whenever something is done for the sole purpose of making something easy, it almost always makes some other use-case more difficult. Redux and its single-source-of-truth is no exception, as there are many problems that arise from fighting against the nature of front-end apps being "distributed" instead of an idealistic atomic, global unit:</p><ul><li>Multiple orthogonal concerns that need to be represented in the state somehow.</li></ul><p>This is "solved" by using <a href="https://redux.js.org/recipes/structuring-reducers/using-combinereducers" target="_blank" rel="noopener noreferrer"><code>combineReducers</code></a>.</p><ul><li>Multiple separate concerns that need to share data, communicate with each other, or are otherwise tangentially related.</li></ul><p>This is "solved" by <a href="https://redux.js.org/recipes/structuring-reducers/beyond-combinereducers" target="_blank" rel="noopener noreferrer">more complex, custom reducers</a> that orchestrate events through these otherwise separate reducers.</p><ul><li>Irrelevant state updates: when separate concerns are combined (using <code>combineReducers</code> or similar) into a single store, whenever any part of the state updates, the <em>entire</em> state is updated, and every "connected" component (every subscriber to the Redux store) is notified.</li></ul><p>This is "solved" by using <a href="https://redux.js.org/introduction/learning-resources#selectors" target="_blank" rel="noopener noreferrer">selectors</a>, and perhaps by using another library like <a href="https://blog.isquaredsoftware.com/2017/12/idiomatic-redux-using-reselect-selectors/" target="_blank" rel="noopener noreferrer"><code>reselect</code></a> for memoized selectors.</p><p>I put "solved" in quotes because these are all solutions that are all but necessary due to problems that are caused solely by using a global, atomic store. In short, having a single global store is unrealistic, even for apps that are already using global stores. Whenever you use a 3rd-party component, or local state, or local storage, or query parameters, or a router, etc., you have already shattered the illusion of a single global store. App data is always distributed at some level, so the natural solution should be to embrace the distribution (by using local state) rather than fighting against it just for the sake of making some use-cases easier to develop in the short run.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="acting-differently">Acting differently<a href="#acting-differently" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>So how can we address this global state problem? To answer that, we need to go back in time a little bit and take some inspiration from another old, well-established model: <a href="https://en.wikipedia.org/wiki/Actor_model" target="_blank" rel="noopener noreferrer">the actor model</a>.</p><p>The actor model is a surprisingly simple model that can be extended slightly beyond its original purpose (concurrent computation). In short, an actor is an entity that can do three things:</p><ul><li>It can receive messages (events)</li><li>It can change its state/behavior as a reaction to a received message, including spawning other actors</li><li>It can send messages to other actors</li></ul><p>If you thought "hmm... so a Redux store is sort of an actor", congratulations, you already have a basic grasp of the model! A Redux store, which is based on some single combined-reducer thing:</p><ul><li>✅ Can receive events</li><li>✅ Changes its state (and thus its behavior, <a href="https://dev.to/davidkpiano/redux-is-half-of-a-pattern-1-2-1hd7" target="_blank" rel="noopener noreferrer">if you're doing it right</a>) as a reaction to those events</li><li>❌ Can't send messages to other stores (there's only one store) or between reducers (dispatching only happens outside-in).</li></ul><p>It also can't really spawn other "actors", which makes the <a href="https://redux.js.org/advanced/async-actions" target="_blank" rel="noopener noreferrer">Reddit example in the official Redux advanced tutorial</a> more awkward than it needs to be:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">postsBySubreddit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state </span><span class="token parameter operator" style="color:rgb(0, 0, 0)">=</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">INVALIDATE_SUBREDDIT</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">RECEIVE_POSTS</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">REQUEST_POSTS</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(38, 127, 153)">Object</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">subreddit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">posts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">subreddit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword module" style="color:rgb(0, 0, 255)">default</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Source: <a href="https://redux.js.org/advanced/async-actions#reducersjs" target="_blank" rel="noopener noreferrer">https://redux.js.org/advanced/async-actions#reducersjs</a></em></p><p>Let's dissect what is happening here:</p><ol><li>We're taking only the relevant slice of state we need (<code>state[action.subreddit]</code>), which should ideally be its own entity</li><li>We are determining what the next state of only this slice should be, via <code>posts(state[action.subreddit], action)</code></li><li>We are surgically replacing that slice with the updated slice, via <code>Object.assign(...)</code>.</li></ol><p>In other words, there is no way we can dispatch or forward an event directly to a specific "entity" (or <em>actor</em>); we only have a single actor and have to manually update only the relevant part of it. Also, every other reducer in <code>combineReducers(...)</code> will get the entity-specific event, and even if they don't update, every single one of them will still be called for every single event. There's no easy way to optimize that. A function that isn't called is still much more optimal than a function that is called and ultimately does nothing (i.e., returns the same state), which happens most of the time in Redux.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reducers-and-actors">Reducers and actors<a href="#reducers-and-actors" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>So how do reducers and actors fit together? Simply put, a reducer describes the behavior of an individual actor:</p><ul><li>Events are sent to a reducer</li><li>A reducer's state/behavior can change due to a received event</li><li>A reducer can spawn actors and/or send messages to other actors (via executed declarative actions)</li></ul><p>This isn't a cutting-edge, groundbreaking model; in fact, you've probably been using the actor model (to some extent) without even knowing it! Consider a simple input component:</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:rgb(0, 0, 255)">MyInput</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token parameter"> onChange</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> disabled </span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setValue</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">""</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">input</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">      </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">disabled</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">disabled</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">      </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">value</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">value</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">      </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">onChange</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript parameter" style="color:rgb(128, 0, 0)">e</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript function" style="color:rgb(0, 0, 255)">setValue</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">e</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token tag script language-javascript property-access" style="color:rgb(128, 0, 0)">target</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token tag script language-javascript property-access" style="color:rgb(128, 0, 0)">value</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">      </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">onBlur</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript function" style="color:rgb(0, 0, 255)">onChange</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">value</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This component, in an implicit way, is sort of like an actor!</p><ul><li>It "receives events" using React's slightly awkward parent-to-child communication mechanism - prop updates</li><li>It changes state/behavior when an event is "received", such as when the <code>disabled</code> prop changes to <code>true</code> (which you can interpret as some event)</li><li>It can send events to other "actors", such as sending a "change" event to the parent by calling the <code>onChange</code> callback (again, using React's slightly awkward child-to-parent communication mechanism)</li><li>In theory, it can "spawn" other "actors" by rendering different components, each with their own local state.</li></ul><p>Reducers make the behavior and business logic more explicit, especially when "implicit events" become concrete, dispatched events:</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">inputReducer</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:rgb(0, 0, 255)">MyInput</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token parameter"> onChange</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> disabled </span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">inputReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">value</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">""</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">effects</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Transform prop changes into events</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">useEffect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"DISABLED"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">value</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> disabled </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">disabled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Execute declarative effects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">useEffect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">effects</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">forEach</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">effect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">effect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"notifyChange"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// "Send" a message back up to the parent "actor"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">onChange</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">effects</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">input</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">      </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">disabled</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">disabled</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">      </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">value</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">state</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token tag script language-javascript property-access" style="color:rgb(128, 0, 0)">value</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">      </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">onChange</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript parameter" style="color:rgb(128, 0, 0)">e</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">        </span><span class="token tag script language-javascript function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">          </span><span class="token tag script language-javascript literal-property property" style="color:rgb(128, 0, 0)">type</span><span class="token tag script language-javascript operator" style="color:rgb(0, 0, 0)">:</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript string" style="color:rgb(163, 21, 21)">"CHANGE"</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">          </span><span class="token tag script language-javascript literal-property property" style="color:rgb(128, 0, 0)">value</span><span class="token tag script language-javascript operator" style="color:rgb(0, 0, 0)">:</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> e</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token tag script language-javascript property-access" style="color:rgb(128, 0, 0)">target</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token tag script language-javascript property-access" style="color:rgb(128, 0, 0)">value</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">        </span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">      </span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">      </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">onBlur</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript literal-property property" style="color:rgb(128, 0, 0)">type</span><span class="token tag script language-javascript operator" style="color:rgb(0, 0, 0)">:</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript string" style="color:rgb(163, 21, 21)">"BLUR"</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> </span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"></span><br></span><span class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="multi-redux">Multi-Redux?<a href="#multi-redux" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Again, one of Redux's three main principles is that Redux exists in a single, global, atomic source of truth. All of the events are routed through that store, and the single huge state object is updated and permeates through all connected components, which use their selectors and memoization and other tricks to ensure that they are only updated when they need to be, especially when dealing with excessive, irrelevant state updates.</p><p>And using a single global store has worked pretty well when using Redux, right? Well... not exactly, to the point that there are entire libraries dedicated to providing the ability to use Redux on a more distributed level, e.g., for <a href="https://redux.js.org/introduction/ecosystem#component-state-and-encapsulation" target="_blank" rel="noopener noreferrer">component state and encapsulation</a>. It is possible to use Redux at a local component level, but that was not its main purpose, and the official <code>react-redux</code> integration does not naturally provide that ability.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="no-redux">No Redux?<a href="#no-redux" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>There are other libraries that embrace the idea of "state locality", such as <a href="https://mobx.js.org/README.html" target="_blank" rel="noopener noreferrer">MobX</a> and <a href="https://xstate.js.org/docs/" target="_blank" rel="noopener noreferrer">XState</a>. For React specifically, there is <a href="http://recoiljs.org/" target="_blank" rel="noopener noreferrer">Recoil</a> for "distributed" state and the built-in <a href="https://reactjs.org/docs/hooks-reference.html#usereducer" target="_blank" rel="noopener noreferrer"><code>useReducer</code> hook</a> that feels a lot like a local Redux, specifically for your component. For declarative effects, I created <a href="https://github.com/davidkpiano/useeffectreducer" target="_blank" rel="noopener noreferrer"><code>useEffectReducer</code></a> which looks and feels just like <code>useReducer</code>, but also gives you a way to manage effects.</p><p>For state that needs to be shared (not globally), you can use a pattern that is very similar to what React-Redux already uses, by making an object that can be subscribed to (i.e., "listened" to) and passed down through <a href="https://reactjs.org/docs/hooks-reference.html#usecontext" target="_blank" rel="noopener noreferrer">context</a>:</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>That will give you the best performance, as that "subscribable" object will seldom/never change. If that feels a bit boilerplatey for you and performance is not a huge concern, you can combine <code>useContext</code> and <code>useReducer</code> with not too much effort:</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token maybe-class-name">CartContext</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">cartReducer</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// reducer logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// try using a state machine here! they're pretty neat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> initialCartState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:rgb(0, 0, 255)">CartContextProvider</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token parameter"> children </span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">cartReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> initialCartState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">CartContext.Provider</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">value</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">state</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)"> dispatch</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">CartContext.Provider</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword module" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">useCartContext</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token maybe-class-name">CartContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And then use it in your components:</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:rgb(0, 0, 255)">CartView</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useCartContext</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Not too bad, right? In general, this is not a problem that can be solved in Redux without going against-the-grain, since Redux is fundamentally a single, atomic global store.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-do-others-think">What do others think?<a href="#what-do-others-think" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>I ran a non-scientific poll on Twitter to see where most app state lives, and how developers feel about it:</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p><img loading="lazy" src="https://dev-to-uploads.s3.amazonaws.com/i/lioo56gpviopcy2ccwqf.png" alt="Global vs. Local State poll" class="img_ev3q"></p><p>From this, I gather two things:</p><ul><li>Whether you distribute state locally, or contain all state in a single store, you will be able to accomplish app state requirements successfully.</li><li>However, more developers are discontent with the majority of app state being global instead of local, which also might hint to why the majority of developers are happy using local state instead.</li></ul><p>What do you think? Share your thoughts in the comments!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Thinking in terms of "actors", in which your application is organized by lots of smaller actors that all talk to each other by passing messages/events to each other, can encourage separation of concerns and make you think differently about how state should be localized (distributed) and connected. My goal for this post is to help you realize that not <em>all</em> state needs to be global, and that other patterns (such as the Actor Model) exist for modeling distributed state and communication flow.</p><p>The Actor Model is not a panacea, though. If you're not careful, you can end up having a spaghetti-like state management problem, where you have completely lost track of which actor is talking to another actor. Anti-patterns are present in any solution that you choose, so it helps to research best practices and actually model your app before you start coding.</p><p>If you want to learn more about the Actor Model, check out <a href="https://www.brianstorti.com/the-actor-model/" target="_blank" rel="noopener noreferrer">The Actor Model in 10 Minutes</a> by <a href="https://twitter.com/brianstorti" target="_blank" rel="noopener noreferrer">Brian Storti</a>, or any of these videos:</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div><p>Please keep in mind that this is post reflects my opinions based on what I've researched, and is in no way meant to be authoritative on the way you should do things. I want to make you <em>think</em>, and I hope that this post accomplished that goal. Thanks for reading!</p><p>If you enjoyed this post (or even if you didn't and just want to hear more of my state management ramblings), <a href="https://www.stately.dev/" target="_blank" rel="noopener noreferrer">subscribe to the Stately Newsletter</a> for more content, thoughts, and discussion 📬</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div>]]></content:encoded>
            <category>redux</category>
            <category>actor</category>
            <category>react</category>
            <category>state</category>
        </item>
        <item>
            <title><![CDATA[Redux is half of a pattern (1/2)]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2020-01-20-redux-is-half-a-pattern-1-2</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2020-01-20-redux-is-half-a-pattern-1-2</guid>
            <pubDate>Mon, 20 Jan 2020 00:00:00 GMT</pubDate>
            <description><![CDATA[Learn how Redux, and all other state management libraries, have one thing in common - they are all partial implementations of state machines - and how we can improve the way we model app state and logic.]]></description>
            <content:encoded><![CDATA[<p>Redux is fantastic.</p><p>Some of you might disagree, so let me tell you why.</p><p>Over the last few years, Redux has popularized the idea of using message-passing (also known as <a href="https://en.wikipedia.org/wiki/Event-driven_programming" target="_blank" rel="noopener noreferrer">event-driven programming</a>) to manage application state. Instead of making arbitrary method calls to various class instances or mutating data structures, we now can think of state as being in a "predictable container" that only changes as a reaction to these "events".</p><p>This simple idea and implementation is universal enough to be used with any framework (or no framework at all), and has inspired libraries for other popular frameworks such as:</p><ul><li><a href="https://vuex.vuejs.org/" target="_blank" rel="noopener noreferrer">Vuex</a> for Vue</li><li><a href="https://ngrx.io/" target="_blank" rel="noopener noreferrer">NgRx</a> for Angular</li></ul><p>However, Redux has recently come under scrutiny by some prominent developers in the web community:</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>If you don't know these developers, they are the co-creators of Redux themselves. So why have Dan and Andrew, and many other developers, all but forsaken the use of Redux in applications?</p><p>The ideas and patterns in Redux appear sound and reasonable, and Redux is still used in many large-scale production apps today. However, it forces a certain architecture in your application:</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>As it turns out, this kind of single-atom immutable architecture is <em>not natural</em> nor does it represent how any software application works (nor should work) in the real-world.</p><p>Redux is an alternative implementation of Facebook's <a href="https://facebook.github.io/flux" target="_blank" rel="noopener noreferrer">Flux "pattern"</a>. Many sticking points and hardships with Facebook's implementation have led developers to seek out alternative, nicer, more developer-friendly APIs such as Redux, Alt, Reflux, Flummox, <a href="https://github.com/kriasoft/react-starter-kit/issues/22" target="_blank" rel="noopener noreferrer">and many more.</a>. Redux emerged as a <a href="https://facebook.github.io/flux/docs/related-libraries/#redux---alternative-state-management" target="_blank" rel="noopener noreferrer">clear winner</a>, and it is stated that Redux combines the ideas from:</p><ul><li><a href="https://www.wikiwand.com/en/Command_pattern" target="_blank" rel="noopener noreferrer">The Command pattern</a></li><li><a href="https://guide.elm-lang.org/architecture/" target="_blank" rel="noopener noreferrer">The Elm Architecture</a></li></ul><p>However, not even the Elm architecture is a standalone architecture/pattern, as it is based on fundamental patterns, whether developers know it or not:</p><blockquote><p>Rather than someone inventing it, early Elm programmers kept discovering the same basic patterns in their code. It was kind of spooky to see people ending up with well-architected code without planning ahead!</p></blockquote><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>In this post, I will highlight some of the reasons that Redux is <em>not</em> a standalone pattern by comparing it to a fundamental, well-established pattern: the <strong>finite state machine</strong>. This is not an arbitrary choice; every single application that we write is basically a state machine, whether we know it or not. The difference is that the state machines we write are implicitly defined.</p><p>I hope that some of these comparisons and differences will help you realize how some of the common pain points in Redux-driven applications materialize, and how you can use this existing pattern to help you craft a better state management architecture, whether you're using Redux, another library, or no library at all.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-a-finite-state-machine">What is a finite state machine?<a href="#what-is-a-finite-state-machine" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>(Taken from another article I wrote, <a href="https://medium.com/@DavidKPiano/the-facetime-bug-and-the-dangers-of-implicit-state-machines-a5f0f61bdaa2" target="_blank" rel="noopener noreferrer">The FaceTime Bug and the Dangers of Implicit State Machines</a>):</p><p>Wikipedia has a <a href="https://en.wikipedia.org/wiki/Finite-state_machine" target="_blank" rel="noopener noreferrer">useful but technical description</a> on what a finite state machine is. In essence, a finite state machine is a computational model centered around states, events, and transitions between states. To make it simpler, think of it this way:</p><ul><li>Any software you make can be described in a <strong>finite number of states</strong> (e.g., <code>idle</code>, <code>loading</code>, <code>success</code>, <code>error</code>)</li><li>You can only be in <strong>one</strong> of those states at any given time (e.g., you can’t be in the <code>success</code> and <code>error</code> states at the same time)</li><li>You always start at some <strong>initial state</strong> (e.g., <code>idle</code>)</li><li>You move from state to state, or <strong>transition</strong>, based on events (e.g., from the <code>idle</code> state, when the <code>LOAD</code> event occurs, you immediately transition to the <code>loading</code> state)</li></ul><p>It’s like the software that you’re used to writing, but with more explicit rules. You might have been used to writing <code>isLoading</code> or <code>isSuccess</code> as Boolean flags before, but state machines make it so that you’re not allowed to have <code>isLoading === true &amp;&amp; isSuccess === true</code> at the same time.</p><p>It also makes it <em>visually clear</em> that event handlers can only do one main thing: forward their events to a state machine. They’re not allowed to “escape” the state machine and execute business logic, just like real-world physical devices: buttons on calculators or ATMs don’t actually do operations or execute actions; rather, they send "signals" to some central unit that manages (or <em>orchestrates</em>) state, and that unit decides what should happen when it receives that "signal".</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-about-state-that-is-not-finite">What about state that is not finite?<a href="#what-about-state-that-is-not-finite" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>With state machines, especially <a href="https://en.wikipedia.org/wiki/UML_state_machine" target="_blank" rel="noopener noreferrer">UML state machines (a.k.a. statecharts)</a>, "state" refers to something different than the data that doesn't fit neatly into finite states, but both "state" and what's known as <a href="https://en.wikipedia.org/wiki/UML_state_machine#Extended_states" target="_blank" rel="noopener noreferrer">"extended state"</a> work together.</p><p>For example, let's consider water 🚰. It can fit into one of four phases, and we consider these the <em>states</em> of water:</p><ul><li><code>liquid</code></li><li><code>solid</code> (e.g., ice, frost)</li><li><code>gas</code> (e.g., vapor, steam)</li><li><code>plasma</code></li></ul><p><a href="https://www.uml-diagrams.org/examples/water-phase-uml-state-machine-diagram-example.html" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://www.uml-diagrams.org/examples/state-machine-example-water.png" alt="Water phase UML state machine diagram" class="img_ev3q"></a></p><blockquote><p>Water phase UML state machine diagram from <a href="https://www.uml-diagrams.org/examples/water-phase-uml-state-machine-diagram-example.html" target="_blank" rel="noopener noreferrer">uml-diagrams.com</a></p></blockquote><p>However, the temperature of water is a <em>continuous</em> measurement, not a discrete one, and it can't be represented in a finite way. Despite this, water temperature can be represented alongside the finite state of water, e.g.:</p><ul><li><code>liquid</code> where <code>temperature === 90</code> (celsius)</li><li><code>solid</code> where <code>temperature === -5</code></li><li><code>gas</code> where <code>temperature === 500</code></li></ul><p>There's many ways to represent the combination of finite and extended state in your application. For the water example, I would personally call the finite state <code>value</code> (as in the "finite state value") and the extended state <code>context</code> (as in "<em>contextual</em> data"):</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> waterState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">value</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"liquid"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// finite state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// extended state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">temperature</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">90</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But you're free to represent it in other ways:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> waterState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">phase</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"liquid"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// finite state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">data</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// extended state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">temperature</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">90</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// or...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> waterState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"liquid"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// finite state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">temperature</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">90</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// anything not 'status' is extended state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The key point is that there is a clear distinction between <strong>finite</strong> and <strong>extended</strong> state, and there is logic that prevents the application from reaching an <em>impossible state</em>, e.g.:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> waterState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">isLiquid</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">isGas</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// 🚱 Water can't be both liquid and gas simultaneously!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">temperature</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token number" style="color:rgb(9, 134, 88)">50</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// ❄️ This is ice!! What's going on??</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And we can extend these examples to realistic code, such as changing this:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> userState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">isLoading</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">isSuccess</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">user</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To something like this:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> userState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// or 'idle' or 'error' or 'success'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">user</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This prevents impossible states like <code>userState.isLoading === true</code> and <code>userState.isSuccess === true</code> happening simultaneously.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-redux-compare-to-a-finite-state-machine">How does Redux compare to a finite state machine?<a href="#how-does-redux-compare-to-a-finite-state-machine" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The reason I'm comparing Redux to a state machine is because, from a birds-eye view, their state management models look pretty similar. For Redux:</p><blockquote><p><code>state</code> + <code>action</code> = <code>newState</code></p></blockquote><p>For state machines:</p><blockquote><p><code>state</code> + <code>event</code> = <code>newState</code> + <code>effects</code></p></blockquote><p>In code, these can even be represented the same way, by using a <a href="https://redux.js.org/basics/reducers/" target="_blank" rel="noopener noreferrer">reducer</a>:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">userReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// Return the next state, which is</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// determined based on the current `state`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// and the received `event` object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// This nextState may contain a "finite"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// state value, as well as "extended"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// state values.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// It may also contain side-effects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// to be executed by some interpreter.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are already some subtle differences, such as "action" vs. "event" or how extended state machines model side-effects (<a href="https://en.wikipedia.org/wiki/UML_state_machine#Actions_and_transitions" target="_blank" rel="noopener noreferrer">they do</a>). Dan Abramov even recognizes some of the differences:</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><p>A reducer can be used to implement a finite state machine, but most reducers are <em>not</em> modeled as finite state machines. Let's change that by learning some of the differences between Redux and state machines.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="difference-finite--extended-states">Difference: finite &amp; extended states<a href="#difference-finite--extended-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Typically, a Redux reducer's state will not make a clear distinction between "finite" and "extended" states, as previously mentioned above. This is an important concept in state machines: an application is always in <em>exactly one</em> of a finite number of "states", and the rest of its data is represented as its extended state.</p><p>Finite states can be introduced to a reducer by making an explicit property that represents exactly one of the many possible states:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> initialUserState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// explicit finite state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">user</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>What's great about this is that, if you're using TypeScript, you can take advantage of using <a href="https://basarat.gitbooks.io/typescript/docs/types/discriminated-unions.html" target="_blank" rel="noopener noreferrer">discriminated unions</a> to make impossible states impossible:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">User</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">name</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token literal-property property">avatar</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">type </span><span class="token maybe-class-name">UserState</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">user</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">user</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"success"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">user</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token maybe-class-name">User</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"failure"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">user</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> string </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="difference-events-vs-actions">Difference: events vs. actions<a href="#difference-events-vs-actions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In <a href="https://en.wikipedia.org/wiki/UML_state_machine#Actions_and_transitions" target="_blank" rel="noopener noreferrer">state machine terminology</a>, an "action" is a side-effect that occurs as the result of a transition:</p><blockquote><p>When an event instance is dispatched, the state machine responds by <strong>performing actions</strong>, such as changing a variable, performing I/O, invoking a function, generating another event instance, or changing to another state.</p></blockquote><p>This isn't the only reason that using the term "action" to describe something that causes a state transition is confusing; "action" also suggests something that needs to be done (i.e., a command), rather than something that just happened (i.e., an event).</p><p>So keep the following terminology in mind when we talk about state machines:</p><ul><li>An <strong>event</strong> describes something that occurred. Events trigger state transitions.</li><li>An <strong>action</strong> describes a side-effect that should occur as a <em>response</em> to a state transition.</li></ul><p>The <a href="https://redux.js.org/style-guide/style-guide/" target="_blank" rel="noopener noreferrer">Redux style guide</a> also directly suggests modeling actions as events:</p><blockquote><p>However, we recommend trying to treat actions more as "describing events that occurred", rather than "setters". Treating actions as "events" generally leads to more meaningful action names, fewer total actions being dispatched, and a more meaningful action log history.</p><p><em>Source: <a href="https://redux.js.org/style-guide/style-guide/#model-actions-as-events-not-setters" target="_blank" rel="noopener noreferrer">Redux style guide: Model actions as events, not setters</a></em></p></blockquote><p>When the word "event" is used in this article, that has the same meaning as a conventional Redux action object. For side-effects, the word "effect" will be used.</p><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="difference-explicit-transitions">Difference: explicit transitions<a href="#difference-explicit-transitions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Another fundamental part of how state machines work are <strong>transitions</strong>. A transition describes how one finite state transitions to another finite state due to an event. This can be represented using boxes and arrows:</p><p><img loading="lazy" src="https://thepracticaldev.s3.amazonaws.com/i/9cerj02qg66buqdmjrmq.png" alt="State machine describing login flow" class="img_ev3q"></p><p>This diagram makes it clear that it's impossible to transition directly from, e.g., <code>idle</code> to <code>success</code> or from <code>success</code> to <code>error</code>. There are clear sequences of events that need to occur to transition from one state to another.</p><p>However, the way that developers tend to model reducers is by determining the next state solely on the received event:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">userReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"FETCH"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// go to some 'loading' state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"RESOLVE"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// go to some 'success' state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"REJECT"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// go to some 'error' state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword module" style="color:rgb(0, 0, 255)">default</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The problem with managing state this way is that it does not prevent <em>impossible transitions</em>. Have you ever seen a screen that briefly displays an error, and then shows some success view? If you haven't, browse <a href="https://reddit.com" target="_blank" rel="noopener noreferrer">Reddit</a>, and do the following steps:</p><ol><li>Search for anything.</li><li>Click on the "Posts" tab while the search is happening.</li><li>Say "aha!" and wait a couple seconds.</li></ol><p>In step 3, you'll probably see something like this (visible at the time of publishing this article):</p><p><img loading="lazy" src="https://i.imgur.com/NJnApBV.gif" alt="Reddit bug showing no search results" class="img_ev3q"></p><p>After a couple seconds, this unexpected view will disappear and you will finally see search results. This bug has been present for a while, and even though it's innocuous, it's not the best user experience, and it can definitely be considered faulty logic.</p><p>However it is implemented (Reddit <em>does</em> use Redux...), something is definitely wrong: <em>an impossible state transition happened</em>. It makes absolutely no sense to transition directly from the "error" view to the "success" view, and in this case, the user shouldn't see an "error" view anyway because it's not an error; it's still loading!</p><p>You might be looking through your existing Redux reducers and realize where this potential bug may surface, because by basing state transitions only on events, these impossible transitions become possible to occur. Sprinkling if-statements all over your reducer might alleviate the symptoms of this:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">userReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"FETCH"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">!==</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// go to some 'loading' state...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// but ONLY if we're not already loading</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But that only makes your state logic harder to follow because the state transitions are <em>not explicit</em>. Even though it might be a little more verbose, it's better to determine the next state based on both the current finite state and the event, rather than just on the event:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">userReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"FETCH"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// go to some 'loading' state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can even split this up into individual "finite state" reducers, to make things cleaner:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">idleUserReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'FETCH'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// go to some 'loading' state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword module" style="color:rgb(0, 0, 255)">default</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">userReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'idle'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">idleUserReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But don't just take my word for it. The Redux style guide also strongly recommends treating your reducers as state machines:</p><blockquote><p>[...]<!-- --> treat reducers as "state machines", where the combination of both the current state and the dispatched action determines whether a new state value is actually calculated, not just the action itself unconditionally.</p><p><em>Source: <a href="https://redux.js.org/style-guide/style-guide/#treat-reducers-as-state-machines" target="_blank" rel="noopener noreferrer">Redux style guide: treat reducers as state machines</a></em></p></blockquote><p>I also talk about this idea in length in my post: <a href="https://dev.to/davidkpiano/no-disabling-a-button-is-not-app-logic-598i" target="_blank" rel="noopener noreferrer">No, disabling a button is not app logic.</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="difference-declarative-effects">Difference: declarative effects<a href="#difference-declarative-effects" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you look at Redux in isolation, its strategy for managing and executing side-effects is this:</p><blockquote><p>¯<!-- -->\<!-- -->_<!-- -->(ツ)<!-- -->_<!-- -->/¯</p></blockquote><p>That's right; Redux has no built-in way of handling side-effects. In any non-trivial application, you <em>will</em> have side-effects if you want to do anything useful, such as make a network request or kick off some sort of async process. Importantly enough, side-effects should <em>not</em> be considered an afterthought; they should be treated as a first-class citizen and uncompromisingly represented in your application logic.</p><p>Unfortunately, with Redux, they are, and the only solution is to use <a href="https://redux.js.org/advanced/middleware" target="_blank" rel="noopener noreferrer">middleware</a>, which is inexplicably an advanced topic, despite being required for any non-trivial app logic:</p><blockquote><p>Without middleware, Redux store only supports synchronous data flow.</p><p><em>Source: <a href="https://redux.js.org/advanced/async-flow" target="_blank" rel="noopener noreferrer">Redux docs: Async Flow</a></em></p></blockquote><p>With extended/UML state machines (also known as statecharts), these side-effects are known as <strong>actions</strong> (and will be referred to as actions for the rest of this post) and are declaratively modeled. Actions are the direct result of a transition:</p><blockquote><p>When an event instance is dispatched, the state machine responds by <strong>performing actions</strong>, such as changing a variable, performing I/O, invoking a function, generating another event instance, or changing to another state.</p><p>_<!-- -->Source: <a href="https://en.wikipedia.org/wiki/UML_state_machine#Actions_and_transitions" target="_blank" rel="noopener noreferrer">(Wikipedia) UML State Machine: Actions and Transitions</a></p></blockquote><p>This means that when an event changes state, actions (effects) may be executed as a result, even if the state stays the same (known as a "self-transition"). Just like Newton said:</p><blockquote><p>For every action, there is an equal and opposite reaction.</p><p><em>Source: Newton's Third Law of Motion</em></p></blockquote><p>Actions <em>never</em> occur spontaneously, without cause; not in software, not in hardware, not in real life, never. There is <em>always</em> a cause for an action to occur, and with state machines, that cause is a state transition, due to a received event.</p><p>Statecharts distinguish how actions are determined in three possible ways:</p><ul><li><strong>Entry actions</strong> are effects that are executed whenever a specific finite state is entered</li><li><strong>Exit actions</strong> are effects that are executed whenever a specific finite state is exited</li><li><strong>Transition actions</strong> are effects that are executed whenever a specific transition between two finite states is taken.</li></ul><p>Fun fact: this is why statecharts are said to have the characteristic of both <a href="https://en.wikipedia.org/wiki/Mealy_machine" target="_blank" rel="noopener noreferrer">Mealy machines</a> and <a href="https://en.wikipedia.org/wiki/Moore_machine" target="_blank" rel="noopener noreferrer">Moore machines</a>:</p><ul><li>With Mealy machines, "output" (actions) depends on the state and the event (transition actions)</li><li>With Moore machines, "output" (actions) depends on just the state (entry &amp; exit actions)</li></ul><p>The original philosophy of Redux is that it did not want to be opinionated on how these side-effects are executed, which is why middleware such as <a href="https://github.com/reduxjs/redux-thunk" target="_blank" rel="noopener noreferrer">redux-thunk</a> and <a href="https://github.com/redux-utilities/redux-promise" target="_blank" rel="noopener noreferrer">redux-promise</a> exist. These libraries work around the fact that Redux is side-effect-agnostic by having third-party, use-case specific "solutions" for handling different types of effects.</p><p>So how can this be solved? It may seem weird, but just like you can use a property to specify finite state, you can also use a property to specify <em>actions that should be executed</em> in a declarative way:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'FETCH'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// finite state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'loading'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// actions (effects) to execute</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token literal-property property">actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'fetchUser'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">42</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, your reducer will return useful information that answers the question, "what side-effects (actions) should be executed as a result of this state transition?" The answer is clear and colocated right in your app state: read the <code>actions</code> property for a declarative description of the actions to be executed, and execute them:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// pretend the state came from a Redux React hook</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> actions </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">useEffect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  actions</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">forEach</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">action</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"fetchUser"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token template-string string" style="color:rgb(163, 21, 21)">/api/user/</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(4, 81, 165)">${</span><span class="token template-string interpolation">action</span><span class="token template-string interpolation punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token template-string interpolation property-access">id</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">res</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">json</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token literal-property property">type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"RESOLVE"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token literal-property property">user</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> data </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ... etc. for other action implementations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">actions</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Having side-effects modeled declaratively in some <code>state.actions</code> property (or similar) has some great benefits, such as in predicting/testing or being able to trace when actions will or have been executed, as well as being able to customize the implementation details of executing those actions. For instance, the <code>fetchUser</code> action can be changed to read from a cache instead, all without changing any of the logic in the reducer.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="difference-sync-vs-async-data-flow">Difference: sync vs. async data flow<a href="#difference-sync-vs-async-data-flow" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>The fact is that middleware is indirection. It fragments your application logic by having it present in multiple places (the reducers and the middleware) without a clear, cohesive understanding of how they work together. Furthermore, it makes some use-cases easier but others much more difficult. For example: take this example from the <a href="https://redux.js.org/advanced/example-reddit-api" target="_blank" rel="noopener noreferrer">Redux advanced tutorial</a>, which uses <code>redux-thunk</code> to allow dispatching a "thunk" for making an async request:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetchPosts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">subreddit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">requestPosts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">subreddit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token template-string string" style="color:rgb(163, 21, 21)">https://www.reddit.com/r/</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(4, 81, 165)">${</span><span class="token template-string interpolation">subreddit</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token template-string string" style="color:rgb(163, 21, 21)">.json</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">json</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter">json</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">receivePosts</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">subreddit</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> json</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now ask yourself: <em>how can I cancel this request?</em> With <code>redux-thunk</code>, it simply isn't possible. And if your answer is to "choose a different middleware", you just validated the previous point. Modeling logic should not be a question of which middleware you choose, and middleware shouldn't even be part of the state modeling process.</p><p>As previously mentioned, the only way to model async data flow with Redux is by using middleware. And with all the possible use-cases, from thunks to Promises to sagas (generators) to epics (observables) and more, the ecosystem has plenty of different solutions for these. But the ideal number of solutions is <em>one</em>: the solution provided by the pattern in use.</p><p>Alright, so how do state machines solve the async data flow problem?</p><p><em>They don't.</em></p><p>To clarify, state machines do not distinguish between sync and async data flows, because there is no difference. This is such an important realization to make, because not only does it simplify the idea of data flow, but it also models how things work in real life:</p><ul><li>A state transition (triggered by a received event) always occurs in "zero-time"; that is, states synchronously transition.</li><li>Events can be received at any time.</li></ul><p>There is no such thing as an asynchronous transition. For example, modeling data fetching doesn't look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">idle . . . . . . . . . . . . success</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Instead, it looks like this:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">idle --(FETCH)--&gt; loading --(RESOLVE)--&gt; success</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Everything is the result of some event triggering a state transition. Middleware obscures this fact. If you're curious how async cancellation can be handled in a synchronous state transition manner, here's a couple of guiding points for a potential implementation:</p><ul><li>A cancellation intent is an <em>event</em> (e.g., <code>{ type: 'CANCEL' }</code>)</li><li>Cancelling an in-flight request is an <em>action</em> (i.e., side-effect)</li><li>"Canceled" is a state, whether it's a specific state (e.g., <code>canceled</code>) or a state where a request shouldn't be active (e.g., <code>idle</code>)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="to-be-continued">To be continued<a href="#to-be-continued" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>It is possible to model application state in Redux to be more like a finite state machine, and it is good to do so for many reasons. The applications that we write have different modes, or "behaviors", that vary depending on which "state" it's in. Before, this state might have been implicit. But now, with finite states, you can group behavior by these finite states (such as <code>idle</code>, <code>loading</code>, <code>success</code>, etc.), which makes the overall app logic much more clear, and prevents the app from getting stuck in an impossible state.</p><p>Finite states also make clear what events can do, depending on which state it's in, as well as what all the possible states are in an application. Additionally, they can map one-to-one to views in user interfaces.</p><p>But most importantly, state machines are present in all of the software that you write, and they have been for over half a century. Making finite state machines explicit brings clarity and robustness to complex app logic, and it is possible to implement them in any libraries that you use (or even no library at all).</p><p>In the next post, we'll talk about how the Redux atomic global store is also half of a pattern, the challenges it presents, and how it compares to another well-known model of computation (the Actor model).</p>]]></content:encoded>
            <category>redux</category>
            <category>state machine</category>
            <category>statechart</category>
            <category>state</category>
        </item>
        <item>
            <title><![CDATA[XState: version 4.7 and the future]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2019-12-09-xstate-version-47-and-the-future</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2019-12-09-xstate-version-47-and-the-future</guid>
            <pubDate>Mon, 09 Dec 2019 00:00:00 GMT</pubDate>
            <description><![CDATA[XState version 4.7 has just been released. This is a minor version bump, but a major reworking of the internal algorithms, a lot of new capabilites, bug fixes and a better TypeScript experience.]]></description>
            <content:encoded><![CDATA[<p><a href="https://github.com/davidkpiano/xstate" target="_blank" rel="noopener noreferrer">XState</a> version 4.7 <a href="https://github.com/davidkpiano/xstate/releases/tag/v4.7.0" target="_blank" rel="noopener noreferrer">has just been released</a>. This is a minor version bump, but a major reworking of the internal algorithms, a lot of new capabilities, bug fixes, and a better TypeScript experience. It also paves the road for even more utilities, like <code>@xstate/test</code> and <code>@xstate/react</code>, as well as compatibility with other 3rd-party tools across the ecosystem, and even across languages.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-xstate">What is XState?<a href="#what-is-xstate" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>XState is a JavaScript (and TypeScript) library for creating state machines and statecharts, and interpreting them. State machines enforce a specific set of ”rules“ on logic structure such that:</p><ul><li>There are a finite number of <strong>states</strong> (such as <code>"loading"</code> or <code>"success"</code>), which is different than <em>context</em> (related data with potentially infinite possibilities, such as <code>email</code> or <code>age</code>)</li><li>There are a finite number of <strong>events</strong> (such as <code>{ type: 'FETCH', query: "..." }</code> that can trigger a transition between states.</li><li>Each state has <strong>transitions</strong>, which say, ”Given some <strong>event</strong>, go to this next state and/or do these actions”.</li></ul><p>You don’t need a state machine library to do this, as you can use <code>switch</code> statements instead:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'idle'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// finite state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'FETCH'</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">'loading'</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              query</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">query</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But let’s be honest, writing it like this is arguably a bit cleaner:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    idle</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">FETCH</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">query</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">query </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And it also makes it possible to directly copy-paste this machine code into a visualizer, like <a href="https://xstate.js.org/viz" target="_blank" rel="noopener noreferrer">XState Viz</a>, and visualize it, like was done at the end of the <a href="https://dev.to/davidkpiano/no-disabling-a-button-is-not-app-logic-598i" target="_blank" rel="noopener noreferrer">No, disabling a button is not app logic</a> article:</p><p><img loading="lazy" src="https://res.cloudinary.com/practicaldev/image/fetch/s--o5PbZ3py--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/218tb91ltxrnv988owz0.png" alt="State machine visualization on XState Viz" class="img_ev3q">
<a href="https://xstate.js.org/viz/?gist=414c0e4c40dab1dc80c9218f85605a24" target="_blank" rel="noopener noreferrer">View this viz on XState Viz</a></p><p>Then there are <strong>statecharts</strong>, which are an extension of finite state machines created by <a href="http://www.inf.ed.ac.uk/teaching/courses/seoc/2005_2006/resources/statecharts.pdf" target="_blank" rel="noopener noreferrer">David Harel in 1989 (read the paper 📑)</a>. Statecharts offer many improvements and mitigate many issues of using flat finite state machines, such as:</p><ul><li>Nested states (hierarchy)</li><li>Parallel states (orthogonality)</li><li>History states</li><li>Entry, exit, and transition actions</li><li>Transient states</li><li>Activities (ongoing actions)</li><li>Communication with many machines (invoked services)</li><li>Delayed transitions</li><li>And much more</li></ul><p>These are things that you <em>definitely</em> do not want to implement yourself, which is why libraries like XState exist. And this brings us to…</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-new-in-xstate-47">What is new in XState 4.7?<a href="#what-is-new-in-xstate-47" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>This minor release has been worked on for months, with a huge amount of help from <a href="https://twitter.com/AndaristRake" target="_blank" rel="noopener noreferrer">Mateusz Burzyński (also known as AndaristRake)</a> 👏. The reason it took so long was because we are internally reworking the algorithms to be simpler, fit the <a href="https://www.w3.org/TR/scxml/#InternalStructureofEvents" target="_blank" rel="noopener noreferrer">SCXML spec</a>, and be compatible with a growing number of tools in the ecosystem. This refactoring also makes adding new capabilities much easier, and will hopefully encourage more contributors to help with this project. As a nice side-effect, it also eliminates a few edge-case bugs that had workarounds, but might have caused a suboptimal developer experience in previous versions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="refactored-internal-algorithms">Refactored internal algorithms<a href="#refactored-internal-algorithms" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>How difficult can it be to create a statechart library? A lot more difficult than it seems, especially if you want to conform to the long, but well-established <a href="https://www.w3.org/TR/scxml" target="_blank" rel="noopener noreferrer">SCXML spec</a>. There’s even libraries for integrating SCXML code directly with JavaScript, such as Jacob Beard’s excellent <a href="http://scion.scxml.io/" target="_blank" rel="noopener noreferrer">SCION tools</a>, which I highly recommend you check out. It was a huge inspiration for XState, and XState is tested against much of the same code.</p><p>SCXML specifies an <a href="https://www.w3.org/TR/scxml/#AlgorithmforSCXMLInterpretation" target="_blank" rel="noopener noreferrer">algorithm for SCXML interpretation</a>, which is written in pseudocode, but directly transferable to many popular languages. This algorithm was followed more closely in the refactor, which simplified a lot of the code base and removed the need for ad-hoc data structures such as <code>StateTree</code>, which was used to keep track of which state nodes were "active" for a given transition (now it’s just a set).</p><p>As a result, the core code base is a little smaller, the algorithms are a little bit faster (determining the next state is basically an O(1) lookup, O(n) worst-case), and the code base is a lot nicer to work with and contribute to. We will continue to improve the algorithms used as we move towards 5.0.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="typestates">Typestates<a href="#typestates" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p><a href="https://en.wikipedia.org/wiki/Typestate_analysis" target="_blank" rel="noopener noreferrer">Typestates</a> are really useful for developers. They’re popular in Rust, and this article on <a href="http://cliffle.com/blog/rust-typestate/" target="_blank" rel="noopener noreferrer">The Typestate Pattern in Rust</a> describes them elegantly:</p><blockquote><p>Typestates are a technique for moving <strong>properties of state</strong> (the dynamic information a program is processing) <strong>into the type level</strong> (the static world that the compiler can check ahead-of-time).</p></blockquote><p>Without learning Rust or diving into the Wikipedia article, let’s present a classic example: loading data. You might represent the state’s context in this way:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">User</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  name</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">UserContext</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  user</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> User</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  error</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">string</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This type-safe declaration allows you to defensively program effectively, but it can be a bit annoying when you are 100% sure that <code>user</code> is defined:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"success"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">!</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// this should be impossible!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// the user definitely exists!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"Something weird happened"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In 4.7, XState allows you to <a href="https://xstate.js.org/docs/guides/typescript.html#typestates" target="_blank" rel="noopener noreferrer">represent your states with Typestates</a> so that you can tell the compiler that you know how the <code>context</code> should be in any given state:</p><p><img loading="lazy" src="https://res.cloudinary.com/practicaldev/image/fetch/s--GakogjRY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/64d42j77op89yta9gbi8.gif" alt="GIF showing that the optional user object will be defined in the success state" class="img_ev3q"></p><p>This is very useful and improves the developer experience, but should be used as a strong guide, and not as a guarantee. It works by using <a href="https://basarat.gitbooks.io/typescript/docs/types/discriminated-unions.html" target="_blank" rel="noopener noreferrer">discriminated unions in TypeScript</a> to define your states, but the way it is implemented requires TypeScript version 3.7 and higher. There’s still some quirks to work out, as we’re basically trying to trick TypeScript into knowing some extra information about our state machines that is otherwise difficult/impossible to infer in a statically typed language. (Maybe one day JavaScript will have a dependently-typed flavor.)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="better-service-experience">Better service experience<a href="#better-service-experience" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>XState makes invoking external ”services” a first-class citizen. If this is a foreign concept, for now, just understand that it answers the question “how can many state machines communicate with each other?”, and the answer is by using events as the main communication mechanism. In 4.7, the developer experience for this is improved:</p><ul><li>Invoked services can now be referenced on the <code>state.children</code> object by their ID. So if a state invokes some service with <code>id: 'fetchUser'</code>, then that invocation will be present on <code>state.children.fetchUser</code>.</li><li>The new <code>forwardTo()</code> action creator allows you to forward events to invoked services, which cuts down a lot of boilerplate:</li></ul><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token constant" style="color:rgb(129, 31, 63)">SOME_EVENT</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">forwardTo</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"someService"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>SCXML has this notion of a <code>sessionid</code>, which is a unique identifier for each invoked service. XState 4.7 becomes more SCXML-compatible by keeping a reference of this in <code>state._sessionid</code>, which corresponds to the SCXML <code>_sessionid</code> variable.</li><li>XState can use that <code>_sessionid</code> to determine which service sent an event, so it can respond with an event back, using the new <code>respond()</code> action creator:</li></ul><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> authServerMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"waitingForCode"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    waitingForCode</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">CODE</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">respond</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"TOKEN"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> delay</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> authClientMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    idle</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">AUTH</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"authorizing"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    authorizing</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"auth-server"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> authServerMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      entry</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"CODE"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> to</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"auth-server"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">TOKEN</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"authorized"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    authorized</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"final"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can make your own custom action creators too, and implement patterns that you might be familiar with already if you’ve worked with microservices.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="wildcard-descriptors">Wildcard descriptors<a href="#wildcard-descriptors" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you’ve ever wanted to transition from a state if <em>any</em> (unspecified) event is received? Well, you’re in luck, because XState now supports <a href="https://xstate.js.org/docs/guides/transitions.html#wildcard-descriptors" target="_blank" rel="noopener noreferrer">wildcard descriptors</a>, which are a type of <a href="https://www.w3.org/TR/scxml/#EventDescriptors" target="_blank" rel="noopener noreferrer">event descriptor (SCXML)</a> that describes a transition for any event in a given state:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> quietMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"quiet"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    idle</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token constant" style="color:rgb(129, 31, 63)">WHISPER</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">undefined</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// On any event besides a WHISPER, transition to the 'disturbed' state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token string-property property">"*"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"disturbed"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    disturbed</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">quietMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">transition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">quietMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">initialState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"WHISPER"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// =&gt; State { value: 'idle' }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">quietMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">transition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">quietMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">initialState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"SOME_EVENT"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// =&gt; State { value: 'disturbed' }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="much-much-more">Much, much more<a href="#much-much-more" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>See <a href="https://github.com/davidkpiano/xstate/releases/tag/v4.7.0" target="_blank" rel="noopener noreferrer">https://github.com/davidkpiano/xstate/releases/tag/v4.7.0</a> for an overview of the latest updates in this minor version.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-future-of-xstate">The future of XState<a href="#the-future-of-xstate" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>All this leads to the big question: what are the future plans/goals for XState? The first important thing to realize is that XState is <em>not just another state management library</em>, and state management was never its only goal. XState strives to bring two things to the JavaScript ecosystem:</p><ul><li><strong>State machines/statecharts</strong>, for modeling the logic of any individual component</li><li><strong>Actor model</strong>, for modeling how components communicate with each other and behave in a system</li></ul><p>All of these are very old, very useful, and battle-tested concepts. The benefits they provide cannot be understated, and highlight the future plans for XState and related tooling:</p><ul><li>Better visualization tools, including an updated visualizer, dev tools for Firefox and Chrome (work in progress!), dev tools for VS Code, and integration with other graphical viz tools such as <a href="https://plantuml.com/" target="_blank" rel="noopener noreferrer">PlantUML</a> and <a href="https://www.graphviz.org/" target="_blank" rel="noopener noreferrer">GraphViz</a></li><li>Full <a href="https://www.w3.org/TR/scxml/" target="_blank" rel="noopener noreferrer">SCXML</a> compatibility, which will allow statecharts authored in XState to be reusable in other languages that have SCXML tooling, as it is a truly language-agnostic spec</li><li>A catalog of examples, to demonstrate common patterns and best practices for many use-cases</li><li>Analytics, testing, and simulation tools</li></ul><p>As well as some initial ideas for XState version 5.0:</p><ul><li>Better type safety and a more seamless TypeScript experience</li><li>Static analysis tools for compile-time hints/warnings and run-time optimizations</li><li>A more ”functional”, and completely optional, syntax for defining states and transitions more naturally (developer experience)</li><li>Higher-level state types such as <code>"task"</code> and <code>"choice"</code> to make it easier to define workflows and remove some boilerplate</li></ul><p>We’re also listening to ideas that you present to us in the <a href="https://spectrum.chat/statecharts/general/xstate-wish-list~6f025b10-fcbc-4ab5-ae59-5201112f06f2" target="_blank" rel="noopener noreferrer">XState Wish List</a> thread, so post what you would like to see!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-information">More information<a href="#more-information" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>If you’re curious about XState or statecharts in general, there are many fantastic resources, including:</p><ul><li><a href="https://statecharts.github.io/" target="_blank" rel="noopener noreferrer">The World of Statecharts</a> by Erik Mogensen</li><li><a href="https://spectrum.chat/statecharts" target="_blank" rel="noopener noreferrer">Statecharts community</a> on Spectrum</li><li><a href="https://xstate.js.org/docs" target="_blank" rel="noopener noreferrer">XState docs</a></li><li><a href="https://xstate.js.org/docs/about/tutorials.html" target="_blank" rel="noopener noreferrer">Other tutorials</a> made by many excellent developers in the community</li></ul>]]></content:encoded>
            <category>update</category>
            <category>state machine</category>
            <category>statechart</category>
            <category>xstate</category>
            <category>state</category>
        </item>
        <item>
            <title><![CDATA[No, disabling a button is not app logic.]]></title>
            <link>https://audionerd.github.io/statelyai-docs/blog/2019-11-13-no-disabling-a-button-is-not-app-logic</link>
            <guid>https://audionerd.github.io/statelyai-docs/blog/2019-11-13-no-disabling-a-button-is-not-app-logic</guid>
            <pubDate>Wed, 13 Nov 2019 00:00:00 GMT</pubDate>
            <description><![CDATA[Disabling a button is not logic. Rather, it is a sign that logic is fragile and bug-prone. Let’s explore this with a simple example: fetching data in a React component.]]></description>
            <content:encoded><![CDATA[<p>I’m going to start this post with an excerpt from the book “Constructing the User Interface with Statecharts”, written by Ian Horrocks in 1999:</p><blockquote><p>User interface development tools are very powerful. They can be used to construct large and complex user interfaces, with only a relatively small amount of code written by an application developer. And yet, despite the power of such tools and the relatively small amount of code that is written, user interface software often has the following characteristics:</p><ul><li>the code can be difficult to understand and review thoroughly:</li><li>the code can be difficult to test in a systematic and thorough way;</li><li>the code can contain bugs even after extensive testing and bug fixing;</li><li>the code can be difficult to enhance without introducing unwanted side-effects;</li><li>the quality of the code tends to deteriorate as enhancements are made to it.</li></ul><p>Despite the obvious problems associated with user interface development, <strong>little effort has been made to improve the situation</strong>. Any practitioner who has worked on large user interface projects will be familiar with many of the above characteristics, which are <strong>symptomatic of the way in which the software is constructed</strong>.</p></blockquote><p>In case you didn’t do the math, this was written <em>over 20 years ago</em> and yet it echoes the same sentiments that many developers feel today about the state of app development. Why is that?</p><p>We’ll explore this with a simple example: fetching data in a React component. Keep in mind, the ideas presented in this article are not library-specific, nor framework-specific… in fact, they’re not even language specific!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="trying-to-make-fetch-happen">Trying to make <code>fetch()</code> happen<a href="#trying-to-make-fetch-happen" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Suppose we have a <code>DogFetcher</code> component that has a button that you can click to fetch a random dog. When the button is clicked, a <code>GET</code> request is made to the <a href="https://dog.ceo/dog-api/" target="_blank" rel="noopener noreferrer">Dog API</a>, and when the dog is received, we show it off in an <code>&lt;img /&gt;</code> tag.</p><p>A typical implementation with <a href="https://reactjs.org/docs/hooks-intro.html" target="_blank" rel="noopener noreferrer">React Hooks</a> might look like this:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">DogFetcher</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">isLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">dog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">figure className</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"dog"</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">dog </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">img src</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">dog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> alt</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"doggo"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">figure</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token function" style="color:rgb(0, 0, 255)">setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token template-string string" style="color:rgb(163, 21, 21)">https://dog.ceo/api/breeds/image/random</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">json</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token function" style="color:rgb(0, 0, 255)">setDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">              </span><span class="token function" style="color:rgb(0, 0, 255)">setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">isLoading </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetching..."</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetch dog!"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This works, but there’s one immediate problem: clicking the button more than once (while a dog is loading) will display one dog briefly, and then replace that dog with another dog. That’s not very considerate to the first dog.</p><p>The typical solution to this is to add a <code>disabled={isLoading}</code> attribute to the button:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">DogFetcher</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ... excessive amount of ad-hoc logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    disabled</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">isLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">isLoading </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetching..."</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetch dog!"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This also works; you’re probably satisfied with this solution. Allow me to burst this bubble.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-can-possibly-go-wrong">What can possibly go wrong?<a href="#what-can-possibly-go-wrong" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Currently, the logic reads like this:</p><blockquote><p>When the button is clicked, fetch a new random dog, and set a flag to make sure that the button cannot be clicked again to fetch a dog while one is being fetched.</p></blockquote><p>However, the logic you <em>really</em> want is this:</p><blockquote><p>When a new dog is requested, fetch it and make sure that another dog can’t be fetched at the same time.</p></blockquote><p>See the difference? The desired logic is completely separate from the button being clicked; it doesn’t matter <em>how</em> the request is made; it only matters what logic happens afterwards.</p><p>Suppose that you want to add the feature that double-clicking the image loads a new dog. What would you have to do?</p><p>It’s all too easy to forget to add the same “guard” logic on <code>figure</code> (after all, <code>&lt;figure disabled={isLoading}&gt;</code> won’t work, go figure), but let’s say you’re an astute developer who remembers to add this logic:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">DogFetcher</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">figure</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        onDoubleClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">isLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// copy-paste the fetch logic from the button onClick handler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">figure</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          </span><span class="token comment" style="color:rgb(0, 128, 0)">// fetch logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        disabled</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">isLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In reality, you can think about this as any use-case where some sort of “trigger” can happen from multiple locations, such as:</p><ul><li>a form being able to be submitted by pressing “Enter” in an input or clicking the “Submit” button</li><li>an event being triggered by a user action <em>or</em> a timeout</li><li>any app logic that needs to be shared between different platforms with different event-handling implementations (think React Native)</li></ul><p>But there’s a code smell here. Our same fetch logic is implemented in more than one place, and understanding the app logic requires developers to jump around in multiple parts of the code base, finding all of the event handlers where there are tidbits of logic and connecting them together mentally.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="drying-up-the-splashes-of-logic">DRYing up the splashes of logic<a href="#drying-up-the-splashes-of-logic" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Okay, so putting logic in our event handlers is probably not a good idea, but we can’t exactly put our finger on the reason why yet. Let’s move the fetch logic out into a function:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">DogFetcher</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">isLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">dog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetchDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">isLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">fetch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token template-string string" style="color:rgb(163, 21, 21)">https://dog.ceo/api/breeds/image/random</span><span class="token template-string template-punctuation string" style="color:rgb(163, 21, 21)">`</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">json</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">setDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">figure className</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"dog"</span><span class="token plain"> onDoubleClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">fetchDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">dog </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">img src</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">dog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> alt</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"doggo"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">figure</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">fetchDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">isLoading </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetching..."</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetch dog!"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-features-and-complexity">Adding features and complexity<a href="#adding-features-and-complexity" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Now let’s see what happens when we want to add basic “features”, such as:</p><ul><li>If fetching a dog fails, an error should be shown.</li><li>Fetching a dog should be cancellable.</li></ul><p>I hesitate to call these “features” because these types of behaviors should be naturally enabled by the programming patterns used, but let’s try to add them anyhow:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">DogFetcher</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">isLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setError</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">canceled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setCanceled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">dog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetchDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">setCanceled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">setError</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">fetchRandomDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// This should work... but it doesn't!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">canceled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">setDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">message</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">catch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">setCanceled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">setError</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">cancel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">setIsLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">setCanceled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">error </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">span style</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> color</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"red"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">span</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">figure className</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"dog"</span><span class="token plain"> onDoubleClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">fetchDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">dog </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">img src</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">dog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> alt</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"doggo"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">figure</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">fetchDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">isLoading </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetching..."</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetch dog!"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">cancel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">Cancel</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This <em>looks</em> like it should work -- all of our Boolean flags are being set to the correct values when things happen. However, <strong>it does not work</strong> because of a hard-to-catch bug: <em>stale callbacks</em>. In this case, the <code>canceled</code> flag inside the <code>.then(...)</code> callback will always be the previous value instead of the latest <code>canceled</code> value, so cancelling has no effect until the next time we try to fetch a dog, which isn’t what we want.</p><p>Hopefully you can see that even with these simple use-cases, our logic has quickly gone out-of-hand, and juggling Boolean flags has made the logic buggier and harder to understand.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reducing-complexity-effectively">Reducing complexity effectively<a href="#reducing-complexity-effectively" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Instead of haphazardly adding Boolean flags everywhere, let’s clean this up with the <code>useReducer</code> and <code>useEffect</code> hooks. These hooks are useful because they express some concepts that lead to better logic organization:</p><ul><li>The <code>useReducer</code> hook uses reducers, which return the next state given the current state and some event that just occurred.</li><li>The <code>useEffect</code> hook synchronizes effects with state.</li></ul><p>To help us organize the various app states, let’s define a few and put them under a <code>status</code> property:</p><ul><li>An <code>"idle"</code> status means that nothing happened yet.</li><li>A <code>"loading"</code> status means that the dog is currently being fetched.</li><li>A <code>"success"</code> status means that the dog was successfully fetched.</li><li>A <code>"failure"</code> status means that an error occurred while trying to fetch the dog.</li></ul><p>Now let’s define a few events that can happen in the app. Keep in mind: these events can happen from <strong>anywhere</strong>, whether it’s initiated by the user or somewhere else:</p><ul><li>A <code>"FETCH"</code> event indicates that fetching a dog should occur.</li><li>A <code>"RESOLVE"</code> event with a <code>data</code> property indicates that a dog was successfully fetched.</li><li>A <code>"REJECT"</code> event with an <code>error</code> property indicates that a dog was unable to be fetched for some reason.</li><li>A <code>"CANCEL"</code> event indicates that an in-progress fetch should be canceled.</li></ul><p>Great! Now let’s write our reducer:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dogReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"FETCH"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"RESOLVE"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"success"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        dog</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"REJECT"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"failure"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">case</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"CANCEL"</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">default</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> initialState </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  status</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  dog</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here’s the beautiful thing about this reducer. It is <em>completely framework-agnostic</em> - we can take this and use it in any framework, or no framework at all. And that also makes it much easier to test.</p><p>But also, implementing this in a framework becomes <em>reduced</em> (pun intended) to <em>just dispatching events</em>. No more logic in event handlers:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">DogFetcher</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dogReducer</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> initialState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> dog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> status </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token function" style="color:rgb(0, 0, 255)">useEffect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ... fetchDog?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">error </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">span style</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> color</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"red"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">span</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">figure className</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"dog"</span><span class="token plain"> onDoubleClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"FETCH"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">dog </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">img src</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">dog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> alt</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"doggo"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">figure</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"FETCH"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">status </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetching..."</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetch dog!"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"CANCEL"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">Cancel</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>However, the question remains: how do we execute the side-effect of actually fetching the dog? Well, since the <code>useEffect</code> hook is meant for synchronizing effects with state, we can synchronize the <code>fetchDog()</code> effect with <code>status === 'loading'</code>, since <code>'loading'</code> means that that side-effect is being executed anyway:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">useEffect</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">status </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> canceled </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">fetchRandomDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">then</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">canceled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"RESOLVE"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> data </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">catch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">canceled</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">dispatch</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> type</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"REJECT"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> error </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      canceled </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-fabled-disabled-attribute">The fabled "disabled" attribute<a href="#the-fabled-disabled-attribute" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><hr><p>The logic above works great. We’re able to:</p><ul><li>Click the “Fetch dog” button to fetch a dog</li><li>Display a random dog when fetched</li><li>Show an error if the dog is unable to be fetched</li><li>Cancel an in-flight fetch request by clicking the “Cancel” button</li><li>Prevent more than one dog from being fetched at the same time</li></ul><p>…all without having to put any logic in the <code>&lt;button disabled={...}&gt;</code> attribute. In fact, we completely forgot to do so anyway, and the logic still works!</p><p>This is how you know your logic is robust; when it works, regardless of the UI. Whether the “Fetch dog” button is disabled or not, clicking it multiple times in a row won’t exhibit any unexpected behavior.</p><p>Also, because most of the logic is delegated to a <code>dogReducer</code> function defined <em>outside</em> of your component, it is:</p><ul><li>easy to make into a custom hook</li><li>easy to test</li><li>easy to reuse in other components</li><li>easy to reuse in other <em>frameworks</em></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-final-result">The final result<a href="#the-final-result" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Change the <code>&lt;DogFetcher /&gt;</code> version in the select dropdown to see each of the versions we've explored in this tutorial (even the buggy ones).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pushing-effects-to-the-side">Pushing effects to the side<a href="#pushing-effects-to-the-side" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>There’s one lingering thought, though… is <code>useEffect()</code> the ideal place to put a side effect, such as fetching?</p><p><em>Maybe, maybe not.</em></p><p>Honestly, in most use-cases, it works, and it works fine. But it’s difficult to test or separate that effect from your component code. And with the upcoming Suspense and Concurrent Mode features in React, the recommendation is to execute these side-effects when some action triggers them, rather than in <code>useEffect()</code>. This is because the official React advice is:</p><blockquote><p>If you’re working on a data fetching library, there’s a crucial aspect of Render-as-You-Fetch you don’t want to miss. <strong>We kick off fetching before rendering.</strong></p><p><a href="https://reactjs.org/docs/concurrent-mode-suspense.html#start-fetching-early" target="_blank" rel="noopener noreferrer">https://reactjs.org/docs/concurrent-mode-suspense.html#start-fetching-early</a></p></blockquote><p>This is good advice. Fetching data should not be coupled with rendering. However, they also say this:</p><blockquote><p>The answer to this is we want to start fetching in the event handlers instead.</p></blockquote><p>This is misleading advice. Instead, here's what should happen:</p><ol><li>An event handler should <strong>send a signal</strong> to “something” that indicates that some action just happened (in the form of an event)</li><li>That “something” should <strong>orchestrate</strong> what happens next when it receives that event.</li></ol><p>Two possible things can happen when an event is received by some orchestrator:</p><ul><li>State can be changed</li><li>Effects can be executed</li></ul><p>All of this can happen outside of the component render cycle, because it doesn't necessarily concern the view. Unfortunately, React doesn't have a built-in way (yet?) to handle state management, side-effects, data fetching, caching etc. outside of the components (we all know Relay is not commonly used), so let's explore one way we can accomplish this completely outside of the component.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-a-state-machine">Using a state machine<a href="#using-a-state-machine" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>In this case, we're going to use a state machine to manage and orchestrate state. If you're new to state machines, just know that they feel like your typical Redux reducers with a few more "rules". Those rules have some powerful advantages, and are also the mathematical basis for how literally every computer in existence today works. So they might be worth learning.</p><p>I'm going to use <a href="https://xstate.js.org/docs" target="_blank" rel="noopener noreferrer">XState</a> and <a href="https://xstate.js.org/docs/packages/xstate-react/" target="_blank" rel="noopener noreferrer"><code>@xstate/react</code></a> to create the machine:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> Machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> assign </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"xstate"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> useMachine </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"@xstate/react"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> dogFetcherMachine </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Machine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  id</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"dog fetcher"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  initial</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  context</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    dog</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  states</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    idle</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">FETCH</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    loading</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      invoke</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">src</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">fetchRandomDog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        onDone</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"success"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">dog</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">message </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        onError</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          target</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"failure"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">          actions</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">assign</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">error</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">data </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">CANCEL</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    success</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">FETCH</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    failure</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      on</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">FETCH</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notice how the machine looks like our previous reducer, with a couple of differences:</p><ul><li>It looks like some sort of configuration object instead of a switch statement</li><li>We’re matching on the <em>state</em> first, instead of the <em>event</em> first</li><li>We’re invoking the <code>fetchRandomDog()</code> promise inside the machine! 😱</li></ul><p>Don’t worry; we’re not actually executing any side-effects inside of this machine. In fact, <code>dogFetcherMachine.transition(state, event)</code> is a <em>pure function</em> that tells you the next state given the current state and event. Seems familiar, huh?</p><p>Furthermore, I can copy-paste this exact machine and <a href="https://xstate.js.org/viz" target="_blank" rel="noopener noreferrer">visualize it in XState Viz</a>:</p><p><img loading="lazy" src="https://res.cloudinary.com/practicaldev/image/fetch/s--sSFyyRFI--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/hnsqk07cxbygbjo0h07j.png" alt="Visualization of dog fetching machine" class="img_ev3q"></p><p><a href="https://xstate.js.org/viz/?gist=414c0e4c40dab1dc80c9218f85605a24" target="_blank" rel="noopener noreferrer">View this viz on xstate.js.org/viz</a></p><p>So what does our component code look like now? Take a look:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">DogFetcher</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">current</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">dogFetcherMachine</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> dog </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> current</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">error </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">span style</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> color</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"red"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">span</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">figure className</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"dog"</span><span class="token plain"> onDoubleClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"FETCH"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">dog </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">img src</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">dog</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> alt</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token string" style="color:rgb(163, 21, 21)">"doggo"</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">figure</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"FETCH"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">current</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetching..."</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">current</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"success"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetch another dog!"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">current</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Fetch dog"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">current</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">matches</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"failure"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"Try again"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"CANCEL"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain">Cancel</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">div</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here’s the difference between using a state machine and a reducer:</p><ul><li>The hook signature for <code>useMachine(...)</code> looks almost the same as <code>useReducer(...)</code></li><li>No fetching logic exists inside the component; it’s all external!</li><li>There’s a nice <code>current.matches(...)</code> function that lets us customize our button text</li><li><code>send(...)</code> instead of <code>dispatch(...)</code>... and it takes a plain string! (Or an object, up to you).</li></ul><p>A state machine/statechart defines its transitions from the state because it answers the question: “Which events should be handled <em>from this state?</em>” The reason that having <code>&lt;button disabled={isLoading}&gt;</code> is fragile is because we admit that some “FETCH” event can cause an effect no matter which state we’re in, so we have to clean up our ~mess~ faulty logic by preventing the user from clicking the button while loading.</p><p>Instead, it’s better to be proactive about your logic. Fetching should only happen when the app is not in some <code>"loading"</code> state, which is what is clearly defined in the state machine -- the <code>"FETCH"</code> event is not handled in the <code>"loading"</code> state, which means it has no effect. Perfect.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="final-points">Final points<a href="#final-points" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">​</a></h2><p>Disabling a button is not logic. Rather, it is a sign that logic is fragile and bug-prone. In my opinion, disabling a button should only be a visual cue to the user that clicking the button <em>will have no effect</em>.</p><p>So when you’re creating fetching logic (or any other kind of complex logic) in your applications, no matter the framework, ask yourself these questions:</p><ul><li>What are the concrete, finite states this app/component can be in? E.g., "loading", "success", "idle", "failure", etc.</li><li>What are all the possible events that can occur, regardless of state? This includes events that don't come from the user (such as <code>"RESOLVE"</code> or <code>"REJECT"</code> events from promises)</li><li>Which of the finite states should handle these events?</li><li>How can I organize my app logic so that these events are handled properly in those states?</li></ul><p>You do not need a state machine library (like XState) to do this. In fact, you might not even need <code>useReducer</code> when you’re first adopting these principles. Even something as simple as having a state variable representing a finite state can already clean up your logic plenty:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">DogFetcher</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// 'idle' or 'loading' or 'success' or 'error'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setStatus</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And just like that, you’ve eliminated <code>isLoading</code>, <code>isError</code>, <code>isSuccess</code>, <code>startedLoading</code>, and whatever Boolean flags you were going to create. And if you really start to miss that <code>isLoading</code> flag (for whatever reason), you can still have it, but ONLY if it’s derived from your organized, finite states. The <code>isLoading</code> variable should NEVER be a primary source of state:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">DogFetcher</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">// 'idle' or 'loading' or 'success' or 'error'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">status</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> setStatus</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">useState</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">"idle"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> isLoading </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> status </span><span class="token operator" style="color:rgb(0, 0, 0)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">"loading"</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">button disabled</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">isLoading</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token comment" style="color:rgb(0, 128, 0)">/* ... */</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And we’ve come full circle. Thanks for reading.</p>]]></content:encoded>
            <category>data fetching</category>
            <category>state machine</category>
            <category>statechart</category>
            <category>state</category>
            <category>business logic</category>
        </item>
    </channel>
</rss>